<!DOCTYPE html>





<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="ZERO-A-ONE" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="实验要求 实现GF(28)加法与乘法运算并验算正确性  算法运算采用多项式表示法 加法运算实际上就是按位异或 乘法运算实现要利用XTime运算来设计算法，取模11B 要用课本的例子验算是否正确实现   实现系数在GF(28)上的多项式的乘法  运算是4字节向量乘4字节向量（向量的分量表示多项式的系数） 输出是4字节向量 运算过程，字节对字节的加法就是异或，乘法需调用第1步实现的乘法   AES算法">
<meta property="og:type" content="article">
<meta property="og:title" content="AES-ECB">
<meta property="og:url" content="http://yoursite.com/2019/10/12/AES-ECB/index.html">
<meta property="og:site_name" content="ZERO-A-ONE">
<meta property="og:description" content="实验要求 实现GF(28)加法与乘法运算并验算正确性  算法运算采用多项式表示法 加法运算实际上就是按位异或 乘法运算实现要利用XTime运算来设计算法，取模11B 要用课本的例子验算是否正确实现   实现系数在GF(28)上的多项式的乘法  运算是4字节向量乘4字节向量（向量的分量表示多项式的系数） 输出是4字节向量 运算过程，字节对字节的加法就是异或，乘法需调用第1步实现的乘法   AES算法">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://img-blog.csdn.net/20170219082909688?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219132548906?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219134722812?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219152638324?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219161202485?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219171003857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219174015167?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219203346436?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219203742516?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219204822517?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219205601683?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219210554133?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219213747965?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170219211139752?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170220080512086?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170220082316736?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://img-blog.csdn.net/20170220094853620?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
<meta property="og:image" content="https://pic002.cnblogs.com/images/2010/169108/2010103102010146.png">
<meta property="og:image" content="https://pic002.cnblogs.com/images/2010/169108/2010103102014940.png">
<meta property="og:image" content="https://pic002.cnblogs.com/images/2010/169108/2010103102042294.png">
<meta property="og:image" content="https://pic002.cnblogs.com/images/2010/169108/2010103102044067.png">
<meta property="og:updated_time" content="2019-10-13T17:26:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AES-ECB">
<meta name="twitter:description" content="实验要求 实现GF(28)加法与乘法运算并验算正确性  算法运算采用多项式表示法 加法运算实际上就是按位异或 乘法运算实现要利用XTime运算来设计算法，取模11B 要用课本的例子验算是否正确实现   实现系数在GF(28)上的多项式的乘法  运算是4字节向量乘4字节向量（向量的分量表示多项式的系数） 输出是4字节向量 运算过程，字节对字节的加法就是异或，乘法需调用第1步实现的乘法   AES算法">
<meta name="twitter:image" content="https://img-blog.csdn.net/20170219082909688?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast">
  <link rel="canonical" href="http://yoursite.com/2019/10/12/AES-ECB/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>AES-ECB | ZERO-A-ONE</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZERO-A-ONE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
     <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/12/AES-ECB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZERO-A-ONE">
      <meta itemprop="description" content="Resit much,Obey little">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZERO-A-ONE">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">AES-ECB

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-10-12 19:24:07" itemprop="dateCreated datePublished" datetime="2019-10-12T19:24:07-07:00">2019-10-12</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-10-13 10:26:08" itemprop="dateModified" datetime="2019-10-13T10:26:08-07:00">2019-10-13</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求"></a>实验要求</h2><ul>
<li><p>实现GF(28)加法与乘法运算并验算正确性</p>
<ul>
<li>算法运算采用多项式表示法</li>
<li>加法运算实际上就是按位异或</li>
<li>乘法运算实现要利用XTime运算来设计算法，取模11B</li>
<li>要用课本的例子验算是否正确实现</li>
</ul>
</li>
<li><p>实现系数在GF(28)上的多项式的乘法</p>
<ul>
<li>运算是4字节向量乘4字节向量（向量的分量表示多项式的系数）</li>
<li>输出是4字节向量</li>
<li>运算过程，字节对字节的加法就是异或，乘法需调用第1步实现的乘法</li>
</ul>
</li>
<li><p>AES算法实现</p>
<ul>
<li><p>输入：Nb, Nk, 明文分组，种子密钥，</p>
<p>输出：密文分组 </p>
<p>明文分组以字符串形式输入，密文分组以16进制形式输出，密钥的输入形式自行设计</p>
</li>
<li><p>实现字节代换ByteSub及逆代换InvByteSub</p>
</li>
<li><p>实现行移位ShiftRow及逆行移位InvShiftRow</p>
</li>
<li><p>实现列混淆MixColum及逆列混淆InvMixcColumn，注意，（逆）列混淆实现需要调用第2步实现的多项式乘法</p>
</li>
<li><p>用密钥编排算法获取轮密钥</p>
</li>
<li><p>实现AES加密与解密，注意加密密钥与解密密钥次序与差别</p>
</li>
</ul>
</li>
<li><p>附加内容</p>
<ul>
<li>用代码自动生成字节替换所用的S盒与逆S盒</li>
</ul>
</li>
</ul>
<h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>高级加密标准(AES,Advanced Encryption Standard)为最常见的对称加密算法(微信小程序加密传输就是用这个加密算法的)。对称加密算法也就是加密和解密用相同的密钥，具体的加密流程如下图：<br><img src="https://img-blog.csdn.net/20170219082909688?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="加密流程图"><br> 下面简单介绍下各个部分的作用与意义：</p>
<ul>
<li><p>明文P</p>
<blockquote>
<p>没有经过加密的数据。</p>
</blockquote>
</li>
<li><p>密钥K</p>
<blockquote>
<p>用来加密明文的密码，在对称加密算法中，加密与解密的密钥是相同的。密钥为接收方与发送方协商产生，但不可以直接在网络上传输，否则会导致密钥泄漏，通常是通过非对称加密算法加密密钥，然后再通过网络传输给对方，或者直接面对面商量密钥。密钥是绝对不可以泄漏的，否则会被攻击者还原密文，窃取机密数据。</p>
</blockquote>
</li>
<li><p>AES加密函数</p>
<blockquote>
<p>设AES加密函数为E，则 C = E(K, P),其中P为明文，K为密钥，C为密文。也就是说，把明文P和密钥K作为加密函数的参数输入，则加密函数E会输出密文C。</p>
</blockquote>
</li>
<li><p>密文C</p>
<blockquote>
<p>经加密函数处理后的数据</p>
</blockquote>
</li>
<li><p>AES解密函数</p>
<blockquote>
<p>设AES解密函数为D，则 P = D(K, C),其中C为密文，K为密钥，P为明文。也就是说，把密文C和密钥K作为解密函数的参数输入，则解密函数会输出明文P。</p>
</blockquote>
</li>
</ul>
<p>在这里简单介绍下对称加密算法与非对称加密算法的区别。</p>
<ul>
<li><p>对称加密算法</p>
<blockquote>
<p>加密和解密用到的密钥是相同的，这种加密方式加密速度非常快，适合经常发送数据的场合。缺点是密钥的传输比较麻烦。</p>
</blockquote>
</li>
<li><p>非对称加密算法</p>
<blockquote>
<p>加密和解密用的密钥是不同的，这种加密方式是用数学上的难解问题构造的，通常加密解密的速度比较慢，适合偶尔发送数据的场合。优点是密钥传输方便。常见的非对称加密算法为RSA、ECC和EIGamal。</p>
</blockquote>
</li>
</ul>
<p>实际中，一般是通过RSA加密AES的密钥，传输到接收方，接收方解密得到AES密钥，然后发送方和接收方用AES密钥来通信。</p>
<p>本文下面AES原理的介绍参考自《现代密码学教程》，AES的实现在介绍完原理后开始。</p>
<h3 id="AES的基本结构"><a href="#AES的基本结构" class="headerlink" title="AES的基本结构"></a>AES的基本结构</h3><p>AES为分组密码，分组密码也就是把明文分成一组一组的，每组长度相等，每次加密一组数据，直到加密完整个明文。在AES标准规范中，分组长度只能是128位，也就是说，每个分组为16个字节（每个字节8位）。密钥的长度可以使用128位、192位或256位。密钥的长度不同，推荐加密轮数也不同，如下表所示：</p>
<table>
<thead>
<tr>
<th>AES</th>
<th>密钥长度（32位比特字)</th>
<th>分组长度(32位比特字)</th>
<th>加密轮数</th>
</tr>
</thead>
<tbody><tr>
<td>AES-128</td>
<td>4</td>
<td>4</td>
<td>10</td>
</tr>
<tr>
<td>AES-192</td>
<td>6</td>
<td>4</td>
<td>12</td>
</tr>
<tr>
<td>AES-256</td>
<td>8</td>
<td>4</td>
<td>14</td>
</tr>
</tbody></table>
<p>轮数在下面介绍，这里实现的是AES-128，也就是密钥的长度为128位，加密轮数为10轮。<br> 上面说到，AES的加密公式为C = E(K,P)，在加密函数E中，会执行一个轮函数，并且执行10次这个轮函数，这个轮函数的前9次执行的操作是一样的，只有第10次有所不同。也就是说，一个明文分组会被加密10轮。AES的核心就是实现一轮中的所有操作。</p>
<p>AES的处理单位是字节，128位的输入明文分组P和输入密钥K都被分成16个字节，分别记为P = P0 P1 … P15 和 K = K0  K1 … K15。如，明文分组为P =  abcdefghijklmnop,其中的字符a对应P0，p对应P15。一般地，明文分组用字节为单位的正方形矩阵描述，称为状态矩阵。在算法的每一轮中，状态矩阵的内容不断发生变化，最后的结果作为密文输出。该矩阵中字节的排列顺序为从上到下、从左至右依次排列，如下图所示：<br><img src="https://img-blog.csdn.net/20170219132548906?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="state"></p>
<p>现在假设明文分组P为”abcdefghijklmnop”，则对应上面生成的状态矩阵图如下：<br><img src="https://img-blog.csdn.net/20170219134722812?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="state2"><br> 上图中，0x61为字符a的十六进制表示。可以看到，明文经过AES加密后，已经面目全非。</p>
<p>类似地，128位密钥也是用字节为单位的矩阵表示，矩阵的每一列被称为1个32位比特字。通过密钥编排函数该密钥矩阵被扩展成一个44个字组成的序列W[0],W[1],  …  ,W[43],该序列的前4个元素W[0],W[1],W[2],W[3]是原始密钥，用于加密运算中的初始密钥加（下面介绍）;后面40个字分为10组，每组4个字（128比特）分别用于10轮加密运算中的轮密钥加，如下图所示：<br><img src="https://img-blog.csdn.net/20170219152638324?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="keystate"><br> 上图中，设K = “abcdefghijklmnop”，则K0 = a, K15 = p, W[0] = K0 K1 K2 K3 = “abcd”。</p>
<p>AES的整体结构如下图所示，其中的W[0,3]是指W[0]、W[1]、W[2]和W[3]串联组成的128位密钥。加密的第1轮到第9轮的轮函数一样，包括4个操作：字节代换、行位移、列混合和轮密钥加。最后一轮迭代不执行列混合。另外，在第一轮迭代之前，先将明文和原始密钥进行一次异或加密操作。<br><img src="https://img-blog.csdn.net/20170219161202485?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="aes_struct"><br> 上图也展示了AES解密过程，解密过程仍为10轮，每一轮的操作是加密操作的逆操作。由于AES的4个轮操作都是可逆的，因此，解密操作的一轮就是顺序执行逆行移位、逆字节代换、轮密钥加和逆列混合。同加密操作类似，最后一轮不执行逆列混合，在第1轮解密之前，要执行1次密钥加操作。</p>
<p>下面分别介绍AES中一轮的4个操作阶段，这4分操作阶段使输入位得到充分的混淆。</p>
<h3 id="一、字节代换"><a href="#一、字节代换" class="headerlink" title="一、字节代换"></a>一、字节代换</h3><h4 id="1-字节代换操作"><a href="#1-字节代换操作" class="headerlink" title="1.字节代换操作"></a>1.字节代换操作</h4><p>AES的字节代换其实就是一个简单的查表操作。AES定义了一个S盒和一个逆S盒。<br> AES的S盒：</p>
<table>
<thead>
<tr>
<th>行/列</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0x63</td>
<td>0x7c</td>
<td>0x77</td>
<td>0x7b</td>
<td>0xf2</td>
<td>0x6b</td>
<td>0x6f</td>
<td>0xc5</td>
<td>0x30</td>
<td>0x01</td>
<td>0x67</td>
<td>0x2b</td>
<td>0xfe</td>
<td>0xd7</td>
<td>0xab</td>
<td>0x76</td>
</tr>
<tr>
<td>1</td>
<td>0xca</td>
<td>0x82</td>
<td>0xc9</td>
<td>0x7d</td>
<td>0xfa</td>
<td>0x59</td>
<td>0x47</td>
<td>0xf0</td>
<td>0xad</td>
<td>0xd4</td>
<td>0xa2</td>
<td>0xaf</td>
<td>0x9c</td>
<td>0xa4</td>
<td>0x72</td>
<td>0xc0</td>
</tr>
<tr>
<td>2</td>
<td>0xb7</td>
<td>0xfd</td>
<td>0x93</td>
<td>0x26</td>
<td>0x36</td>
<td>0x3f</td>
<td>0xf7</td>
<td>0xcc</td>
<td>0x34</td>
<td>0xa5</td>
<td>0xe5</td>
<td>0xf1</td>
<td>0x71</td>
<td>0xd8</td>
<td>0x31</td>
<td>0x15</td>
</tr>
<tr>
<td>3</td>
<td>0x04</td>
<td>0xc7</td>
<td>0x23</td>
<td>0xc3</td>
<td>0x18</td>
<td>0x96</td>
<td>0x05</td>
<td>0x9a</td>
<td>0x07</td>
<td>0x12</td>
<td>0x80</td>
<td>0xe2</td>
<td>0xeb</td>
<td>0x27</td>
<td>0xb2</td>
<td>0x75</td>
</tr>
<tr>
<td>4</td>
<td>0x09</td>
<td>0x83</td>
<td>0x2c</td>
<td>0x1a</td>
<td>0x1b</td>
<td>0x6e</td>
<td>0x5a</td>
<td>0xa0</td>
<td>0x52</td>
<td>0x3b</td>
<td>0xd6</td>
<td>0xb3</td>
<td>0x29</td>
<td>0xe3</td>
<td>0x2f</td>
<td>0x84</td>
</tr>
<tr>
<td>5</td>
<td>0x53</td>
<td>0xd1</td>
<td>0x00</td>
<td>0xed</td>
<td>0x20</td>
<td>0xfc</td>
<td>0xb1</td>
<td>0x5b</td>
<td>0x6a</td>
<td>0xcb</td>
<td>0xbe</td>
<td>0x39</td>
<td>0x4a</td>
<td>0x4c</td>
<td>0x58</td>
<td>0xcf</td>
</tr>
<tr>
<td>6</td>
<td>0xd0</td>
<td>0xef</td>
<td>0xaa</td>
<td>0xfb</td>
<td>0x43</td>
<td>0x4d</td>
<td>0x33</td>
<td>0x85</td>
<td>0x45</td>
<td>0xf9</td>
<td>0x02</td>
<td>0x7f</td>
<td>0x50</td>
<td>0x3c</td>
<td>0x9f</td>
<td>0xa8</td>
</tr>
<tr>
<td>7</td>
<td>0x51</td>
<td>0xa3</td>
<td>0x40</td>
<td>0x8f</td>
<td>0x92</td>
<td>0x9d</td>
<td>0x38</td>
<td>0xf5</td>
<td>0xbc</td>
<td>0xb6</td>
<td>0xda</td>
<td>0x21</td>
<td>0x10</td>
<td>0xff</td>
<td>0xf3</td>
<td>0xd2</td>
</tr>
<tr>
<td>8</td>
<td>0xcd</td>
<td>0x0c</td>
<td>0x13</td>
<td>0xec</td>
<td>0x5f</td>
<td>0x97</td>
<td>0x44</td>
<td>0x17</td>
<td>0xc4</td>
<td>0xa7</td>
<td>0x7e</td>
<td>0x3d</td>
<td>0x64</td>
<td>0x5d</td>
<td>0x19</td>
<td>0x73</td>
</tr>
<tr>
<td>9</td>
<td>0x60</td>
<td>0x81</td>
<td>0x4f</td>
<td>0xdc</td>
<td>0x22</td>
<td>0x2a</td>
<td>0x90</td>
<td>0x88</td>
<td>0x46</td>
<td>0xee</td>
<td>0xb8</td>
<td>0x14</td>
<td>0xde</td>
<td>0x5e</td>
<td>0x0b</td>
<td>0xdb</td>
</tr>
<tr>
<td>A</td>
<td>0xe0</td>
<td>0x32</td>
<td>0x3a</td>
<td>0x0a</td>
<td>0x49</td>
<td>0x06</td>
<td>0x24</td>
<td>0x5c</td>
<td>0xc2</td>
<td>0xd3</td>
<td>0xac</td>
<td>0x62</td>
<td>0x91</td>
<td>0x95</td>
<td>0xe4</td>
<td>0x79</td>
</tr>
<tr>
<td>B</td>
<td>0xe7</td>
<td>0xc8</td>
<td>0x37</td>
<td>0x6d</td>
<td>0x8d</td>
<td>0xd5</td>
<td>0x4e</td>
<td>0xa9</td>
<td>0x6c</td>
<td>0x56</td>
<td>0xf4</td>
<td>0xea</td>
<td>0x65</td>
<td>0x7a</td>
<td>0xae</td>
<td>0x08</td>
</tr>
<tr>
<td>C</td>
<td>0xba</td>
<td>0x78</td>
<td>0x25</td>
<td>0x2e</td>
<td>0x1c</td>
<td>0xa6</td>
<td>0xb4</td>
<td>0xc6</td>
<td>0xe8</td>
<td>0xdd</td>
<td>0x74</td>
<td>0x1f</td>
<td>0x4b</td>
<td>0xbd</td>
<td>0x8b</td>
<td>0x8a</td>
</tr>
<tr>
<td>D</td>
<td>0x70</td>
<td>0x3e</td>
<td>0xb5</td>
<td>0x66</td>
<td>0x48</td>
<td>0x03</td>
<td>0xf6</td>
<td>0x0e</td>
<td>0x61</td>
<td>0x35</td>
<td>0x57</td>
<td>0xb9</td>
<td>0x86</td>
<td>0xc1</td>
<td>0x1d</td>
<td>0x9e</td>
</tr>
<tr>
<td>E</td>
<td>0xe1</td>
<td>0xf8</td>
<td>0x98</td>
<td>0x11</td>
<td>0x69</td>
<td>0xd9</td>
<td>0x8e</td>
<td>0x94</td>
<td>0x9b</td>
<td>0x1e</td>
<td>0x87</td>
<td>0xe9</td>
<td>0xce</td>
<td>0x55</td>
<td>0x28</td>
<td>0xdf</td>
</tr>
<tr>
<td>F</td>
<td>0x8c</td>
<td>0xa1</td>
<td>0x89</td>
<td>0x0d</td>
<td>0xbf</td>
<td>0xe6</td>
<td>0x42</td>
<td>0x68</td>
<td>0x41</td>
<td>0x99</td>
<td>0x2d</td>
<td>0x0f</td>
<td>0xb0</td>
<td>0x54</td>
<td>0xbb</td>
<td>0x16</td>
</tr>
</tbody></table>
<p>状态矩阵中的元素按照下面的方式映射为一个新的字节：把该字节的高4位作为行值，低4位作为列值，取出S盒或者逆S盒中对应的行的元素作为输出。例如，加密时，输出的字节S1为0x12,则查S盒的第0x01行和0x02列，得到值0xc9,然后替换S1原有的0x12为0xc9。状态矩阵经字节代换后的图如下：<br><img src="https://img-blog.csdn.net/20170219171003857?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="byte"></p>
<h4 id="2-字节代换逆操作"><a href="#2-字节代换逆操作" class="headerlink" title="2.字节代换逆操作"></a>2.字节代换逆操作</h4><p>逆字节代换也就是查逆S盒来变换，逆S盒如下：</p>
<table>
<thead>
<tr>
<th>行/列</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>E</th>
<th>F</th>
</tr>
</thead>
<tbody><tr>
<td>0</td>
<td>0x52</td>
<td>0x09</td>
<td>0x6a</td>
<td>0xd5</td>
<td>0x30</td>
<td>0x36</td>
<td>0xa5</td>
<td>0x38</td>
<td>0xbf</td>
<td>0x40</td>
<td>0xa3</td>
<td>0x9e</td>
<td>0x81</td>
<td>0xf3</td>
<td>0xd7</td>
<td>0xfb</td>
</tr>
<tr>
<td>1</td>
<td>0x7c</td>
<td>0xe3</td>
<td>0x39</td>
<td>0x82</td>
<td>0x9b</td>
<td>0x2f</td>
<td>0xff</td>
<td>0x87</td>
<td>0x34</td>
<td>0x8e</td>
<td>0x43</td>
<td>0x44</td>
<td>0xc4</td>
<td>0xde</td>
<td>0xe9</td>
<td>0xcb</td>
</tr>
<tr>
<td>2</td>
<td>0x54</td>
<td>0x7b</td>
<td>0x94</td>
<td>0x32</td>
<td>0xa6</td>
<td>0xc2</td>
<td>0x23</td>
<td>0x3d</td>
<td>0xee</td>
<td>0x4c</td>
<td>0x95</td>
<td>0x0b</td>
<td>0x42</td>
<td>0xfa</td>
<td>0xc3</td>
<td>0x4e</td>
</tr>
<tr>
<td>3</td>
<td>0x08</td>
<td>0x2e</td>
<td>0xa1</td>
<td>0x66</td>
<td>0x28</td>
<td>0xd9</td>
<td>0x24</td>
<td>0xb2</td>
<td>0x76</td>
<td>0x5b</td>
<td>0xa2</td>
<td>0x49</td>
<td>0x6d</td>
<td>0x8b</td>
<td>0xd1</td>
<td>0x25</td>
</tr>
<tr>
<td>4</td>
<td>0x72</td>
<td>0xf8</td>
<td>0xf6</td>
<td>0x64</td>
<td>0x86</td>
<td>0x68</td>
<td>0x98</td>
<td>0x16</td>
<td>0xd4</td>
<td>0xa4</td>
<td>0x5c</td>
<td>0xcc</td>
<td>0x5d</td>
<td>0x65</td>
<td>0xb6</td>
<td>0x92</td>
</tr>
<tr>
<td>5</td>
<td>0x6c</td>
<td>0x70</td>
<td>0x48</td>
<td>0x50</td>
<td>0xfd</td>
<td>0xed</td>
<td>0xb9</td>
<td>0xda</td>
<td>0x5e</td>
<td>0x15</td>
<td>0x46</td>
<td>0x57</td>
<td>0xa7</td>
<td>0x8d</td>
<td>0x9d</td>
<td>0x84</td>
</tr>
<tr>
<td>6</td>
<td>0x90</td>
<td>0xd8</td>
<td>0xab</td>
<td>0x00</td>
<td>0x8c</td>
<td>0xbc</td>
<td>0xd3</td>
<td>0x0a</td>
<td>0xf7</td>
<td>0xe4</td>
<td>0x58</td>
<td>0x05</td>
<td>0xb8</td>
<td>0xb3</td>
<td>0x45</td>
<td>0x06</td>
</tr>
<tr>
<td>7</td>
<td>0xd0</td>
<td>0x2c</td>
<td>0x1e</td>
<td>0x8f</td>
<td>0xca</td>
<td>0x3f</td>
<td>0x0f</td>
<td>0x02</td>
<td>0xc1</td>
<td>0xaf</td>
<td>0xbd</td>
<td>0x03</td>
<td>0x01</td>
<td>0x13</td>
<td>0x8a</td>
<td>0x6b</td>
</tr>
<tr>
<td>8</td>
<td>0x3a</td>
<td>0x91</td>
<td>0x11</td>
<td>0x41</td>
<td>0x4f</td>
<td>0x67</td>
<td>0xdc</td>
<td>0xea</td>
<td>0x97</td>
<td>0xf2</td>
<td>0xcf</td>
<td>0xce</td>
<td>0xf0</td>
<td>0xb4</td>
<td>0xe6</td>
<td>0x73</td>
</tr>
<tr>
<td>9</td>
<td>0x96</td>
<td>0xac</td>
<td>0x74</td>
<td>0x22</td>
<td>0xe7</td>
<td>0xad</td>
<td>0x35</td>
<td>0x85</td>
<td>0xe2</td>
<td>0xf9</td>
<td>0x37</td>
<td>0xe8</td>
<td>0x1c</td>
<td>0x75</td>
<td>0xdf</td>
<td>0x6e</td>
</tr>
<tr>
<td>A</td>
<td>0x47</td>
<td>0xf1</td>
<td>0x1a</td>
<td>0x71</td>
<td>0x1d</td>
<td>0x29</td>
<td>0xc5</td>
<td>0x89</td>
<td>0x6f</td>
<td>0xb7</td>
<td>0x62</td>
<td>0x0e</td>
<td>0xaa</td>
<td>0x18</td>
<td>0xbe</td>
<td>0x1b</td>
</tr>
<tr>
<td>B</td>
<td>0xfc</td>
<td>0x56</td>
<td>0x3e</td>
<td>0x4b</td>
<td>0xc6</td>
<td>0xd2</td>
<td>0x79</td>
<td>0x20</td>
<td>0x9a</td>
<td>0xdb</td>
<td>0xc0</td>
<td>0xfe</td>
<td>0x78</td>
<td>0xcd</td>
<td>0x5a</td>
<td>0xf4</td>
</tr>
<tr>
<td>C</td>
<td>0x1f</td>
<td>0xdd</td>
<td>0xa8</td>
<td>0x33</td>
<td>0x88</td>
<td>0x07</td>
<td>0xc7</td>
<td>0x31</td>
<td>0xb1</td>
<td>0x12</td>
<td>0x10</td>
<td>0x59</td>
<td>0x27</td>
<td>0x80</td>
<td>0xec</td>
<td>0x5f</td>
</tr>
<tr>
<td>D</td>
<td>0x60</td>
<td>0x51</td>
<td>0x7f</td>
<td>0xa9</td>
<td>0x19</td>
<td>0xb5</td>
<td>0x4a</td>
<td>0x0d</td>
<td>0x2d</td>
<td>0xe5</td>
<td>0x7a</td>
<td>0x9f</td>
<td>0x93</td>
<td>0xc9</td>
<td>0x9c</td>
<td>0xef</td>
</tr>
<tr>
<td>E</td>
<td>0xa0</td>
<td>0xe0</td>
<td>0x3b</td>
<td>0x4d</td>
<td>0xae</td>
<td>0x2a</td>
<td>0xf5</td>
<td>0xb0</td>
<td>0xc8</td>
<td>0xeb</td>
<td>0xbb</td>
<td>0x3c</td>
<td>0x83</td>
<td>0x53</td>
<td>0x99</td>
<td>0x61</td>
</tr>
<tr>
<td>F</td>
<td>0x17</td>
<td>0x2b</td>
<td>0x04</td>
<td>0x7e</td>
<td>0xba</td>
<td>0x77</td>
<td>0xd6</td>
<td>0x26</td>
<td>0xe1</td>
<td>0x69</td>
<td>0x14</td>
<td>0x63</td>
<td>0x55</td>
<td>0x21</td>
<td>0x0c</td>
<td>0x7d</td>
</tr>
</tbody></table>
<h3 id="二、行移位"><a href="#二、行移位" class="headerlink" title="二、行移位"></a>二、行移位</h3><h4 id="1-行移位操作"><a href="#1-行移位操作" class="headerlink" title="1.行移位操作"></a>1.行移位操作</h4><p>行移位是一个简单的左循环移位操作。当密钥长度为128比特时，状态矩阵的第0行左移0字节，第1行左移1字节，第2行左移2字节，第3行左移3字节，如下图所示：<br><img src="https://img-blog.csdn.net/20170219174015167?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="shiftRows"></p>
<h4 id="2-行移位的逆变换"><a href="#2-行移位的逆变换" class="headerlink" title="2.行移位的逆变换"></a>2.行移位的逆变换</h4><p>行移位的逆变换是将状态矩阵中的每一行执行相反的移位操作，例如AES-128中，状态矩阵的第0行右移0字节，第1行右移1字节，第2行右移2字节，第3行右移3字节。</p>
<h3 id="三、列混合"><a href="#三、列混合" class="headerlink" title="三、列混合"></a>三、列混合</h3><h4 id="1-列混合操作"><a href="#1-列混合操作" class="headerlink" title="1.列混合操作"></a>1.列混合操作</h4><p>列混合变换是通过矩阵相乘来实现的，经行移位后的状态矩阵与固定的矩阵相乘，得到混淆后的状态矩阵，如下图的公式所示：<br><img src="https://img-blog.csdn.net/20170219203346436?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col"></p>
<p>状态矩阵中的第j列(0 ≤j≤3)的列混合可以表示为下图所示：<br><img src="https://img-blog.csdn.net/20170219203742516?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col2"></p>
<p>其中，矩阵元素的乘法和加法都是定义在基于GF(2^8)上的二元运算,并不是通常意义上的乘法和加法。这里涉及到一些信息安全上的数学知识，不过不懂这些知识也行。其实这种二元运算的加法等价于两个字节的异或，乘法则复杂一点。对于一个8位的二进制数来说，使用域上的乘法乘以(00000010)等价于左移1位(低位补0)后，再根据情况同(00011011)进行异或运算，设S1  = (a7 a6 a5 a4 a3 a2 a1 a0)，刚0x02 * S1如下图所示：<br><img src="https://img-blog.csdn.net/20170219204822517?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col3"><br> 也就是说，如果a7为1，则进行异或运算，否则不进行。<br> 类似地，乘以(00000100)可以拆分成两次乘以(00000010)的运算：<br><img src="https://img-blog.csdn.net/20170219205601683?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col4"><br> 乘以(0000 0011)可以拆分成先分别乘以(0000 0001)和(0000 0010)，再将两个乘积异或：<br><img src="https://img-blog.csdn.net/20170219210554133?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col5"><br> 因此，我们只需要实现乘以2的函数，其他数值的乘法都可以通过组合来实现。<br> 下面举个具体的例子,输入的状态矩阵如下：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>C9</td>
<td>E5</td>
<td>FD</td>
<td>2B</td>
</tr>
<tr>
<td>7A</td>
<td>F2</td>
<td>78</td>
<td>6E</td>
</tr>
<tr>
<td>63</td>
<td>9C</td>
<td>26</td>
<td>67</td>
</tr>
<tr>
<td>B0</td>
<td>A7</td>
<td>82</td>
<td>E5</td>
</tr>
</tbody></table>
<p>下面，进行列混合运算：<br> 以第一列的运算为例：<br><img src="https://img-blog.csdn.net/20170219213747965?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col7"><br> 其它列的计算就不列举了，列混合后生成的新状态矩阵如下：</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>D4</td>
<td>E7</td>
<td>CD</td>
<td>66</td>
</tr>
<tr>
<td>28</td>
<td>02</td>
<td>E5</td>
<td>BB</td>
</tr>
<tr>
<td>BE</td>
<td>C6</td>
<td>D6</td>
<td>BF</td>
</tr>
<tr>
<td>22</td>
<td>0F</td>
<td>DF</td>
<td>A5</td>
</tr>
</tbody></table>
<h4 id="2-列混合逆运算"><a href="#2-列混合逆运算" class="headerlink" title="2.列混合逆运算"></a>2.列混合逆运算</h4><p>逆向列混合变换可由下图的矩阵乘法定义：<br><img src="https://img-blog.csdn.net/20170219211139752?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="col6"><br> 可以验证，逆变换矩阵同正变换矩阵的乘积恰好为单位矩阵。</p>
<h3 id="四、轮密钥加"><a href="#四、轮密钥加" class="headerlink" title="四、轮密钥加"></a>四、轮密钥加</h3><p>轮密钥加是将128位轮密钥Ki同状态矩阵中的数据进行逐位异或操作，如下图所示。其中，密钥Ki中每个字W[4i],W[4i+1],W[4i+2],W[4i+3]为32位比特字，包含4个字节，他们的生成算法下面在下面介绍。轮密钥加过程可以看成是字逐位异或的结果，也可以看成字节级别或者位级别的操作。也就是说，可以看成S0  S1 S2 S3 组成的32位字与W[4i]的异或运算。<br><img src="https://img-blog.csdn.net/20170220080512086?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="roundadd"><br> 轮密钥加的逆运算同正向的轮密钥加运算完全一致，这是因为异或的逆操作是其自身。轮密钥加非常简单，但却能够影响S数组中的每一位。</p>
<h3 id="五、密钥扩展"><a href="#五、密钥扩展" class="headerlink" title="五、密钥扩展"></a>五、密钥扩展</h3><p>AES首先将初始密钥输入到一个4<em>4的状态矩阵中，如下图所示。<br><img src="https://img-blog.csdn.net/20170220082316736?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="keyextends"><br> 这个4</em>4矩阵的每一列的4个字节组成一个字，矩阵4列的4个字依次命名为W[0]、W[1]、W[2]和W[3]，它们构成一个以字为单位的数组W。例如，设密钥K为”abcdefghijklmnop”,则K0  = ‘a’,K1 = ‘b’, K2 = ‘c’,K3 = ‘d’,W[0] = “abcd”。<br> 接着，对W数组扩充40个新列，构成总共44列的扩展密钥数组。新列以如下的递归方式产生：<br> 1.如果i不是4的倍数，那么第i列由如下等式确定：<br> W[i]=W[i-4]⨁W[i-1]<br> 2.如果i是4的倍数，那么第i列由如下等式确定：<br> W[i]=W[i-4]⨁T(W[i-1])<br> 其中，T是一个有点复杂的函数。<br> 函数T由3部分组成：字循环、字节代换和轮常量异或，这3部分的作用分别如下。<br> a.字循环：将1个字中的4个字节循环左移1个字节。即将输入字[b0, b1, b2, b3]变换成[b1,b2,b3,b0]。<br> b.字节代换：对字循环的结果使用S盒进行字节代换。<br> c.轮常量异或：将前两步的结果同轮常量Rcon[j]进行异或，其中j表示轮数。<br> 轮常量Rcon[j]是一个字，其值见下表。</p>
<table>
<thead>
<tr>
<th>j</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
</tr>
</thead>
<tbody><tr>
<td>Rcon[j]</td>
<td>01 00 00 00</td>
<td>02 00 00 00</td>
<td>04 00 00 00</td>
<td>08 00 00 00</td>
<td>10 00 00 00</td>
</tr>
<tr>
<td>j</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>10</td>
</tr>
<tr>
<td>Rcon[j]</td>
<td>20 00 00 00</td>
<td>40 00 00 00</td>
<td>80 00 00 00</td>
<td>1B 00 00 00</td>
<td>36 00 00 00</td>
</tr>
</tbody></table>
<p>下面举个例子：<br> 设初始的128位密钥为：<br> 3C A1 0B 21 57 F0 19 16 90 2E 13 80 AC C1 07 BD<br> 那么4个初始值为：<br> W[0] = 3C A1 0B 21<br> W[1] = 57 F0 19 16<br> W[2] = 90 2E 13 80<br> W[3] = AC C1 07 BD<br> 下面求扩展的第1轮的子密钥(W[4],W[5],W[6],W[7])。<br> 由于4是4的倍数，所以：<br> W[4] = W[0] ⨁ T(W[3])<br> T(W[3])的计算步骤如下：<br> \1. 循环地将W[3]的元素移位：AC C1 07 BD变成C1 07 BD AC;<br> \2. 将 C1 07 BD AC 作为S盒的输入，输出为78 C5 7A 91;<br> \3. 将78 C5 7A 91与第一轮轮常量Rcon[1]进行异或运算，将得到79 C5 7A 91，因此，T(W[3])=79 C5 7A 91，故<br> W[4] = 3C A1 0B 21 ⨁ 79 C5 7A 91 = 45 64 71 B0<br> 其余的3个子密钥段的计算如下：<br> W[5] = W[1] ⨁ W[4] = 57 F0 19 16 ⨁ 45 64 71 B0 = 12 94 68 A6<br> W[6] = W[2] ⨁ W[5] =90 2E 13 80 ⨁ 12 94 68 A6 = 82 BA 7B 26<br> W[7] = W[3] ⨁ W[6] = AC C1 07 BD ⨁ 82 BA 7B 26 = 2E 7B 7C 9B<br> 所以，第一轮的密钥为 45 64 71 B0 12 94 68 A6 82 BA 7B 26 2E 7B 7C 9B。</p>
<h3 id="六、AES解密"><a href="#六、AES解密" class="headerlink" title="六、AES解密"></a>六、AES解密</h3><p>在文章开始的图中，有AES解密的流程图，可以对应那个流程图来进行解密。下面介绍的是另一种等价的解密模式，流程图如下图所示。这种等价的解密模式使得解密过程各个变换的使用顺序同加密过程的顺序一致，只是用逆变换取代原来的变换。<br><img src="https://img-blog.csdn.net/20170220094853620?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvcXFfMjgyMDUxNTM=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="deaes"></p>
<h2 id="软件系统设计"><a href="#软件系统设计" class="headerlink" title="软件系统设计"></a>软件系统设计</h2><h4 id="XTime运算"><a href="#XTime运算" class="headerlink" title="XTime运算"></a>XTime运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xtime = <span class="keyword">lambda</span> a: (((a &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x1B</span>) &amp; <span class="number">0xFF</span>) <span class="keyword">if</span> (a &amp; <span class="number">0x80</span>) <span class="keyword">else</span> (a &lt;&lt; <span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h4 id="字节替代"><a href="#字节替代" class="headerlink" title="字节替代"></a>字节替代</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__sub_bytes</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">			s[i][j] = Sbox[s[i][j]]</span><br></pre></td></tr></table></figure>

<p>AES的字节代换其实就是一个简单的查表操作。AES定义了一个S盒和一个逆S盒,状态矩阵中的元素按照下面的方式映射为一个新的字节：把该字节的高4位作为行值，低4位作为列值，取出S盒或者逆S盒中对应的行的元素作为输出</p>
<h4 id="逆字节替换"><a href="#逆字节替换" class="headerlink" title="逆字节替换"></a>逆字节替换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__inv_sub_bytes</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">			s[i][j] = InvSbox[s[i][j]]</span><br></pre></td></tr></table></figure>

<h4 id="行移位变换"><a href="#行移位变换" class="headerlink" title="行移位变换"></a>行移位变换</h4><p><img src="https://pic002.cnblogs.com/images/2010/169108/2010103102010146.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__shift_rows</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">	s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">	s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h4 id="逆行移位变换"><a href="#逆行移位变换" class="headerlink" title="逆行移位变换"></a>逆行移位变换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__inv_shift_rows</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>], s[<span class="number">3</span>][<span class="number">1</span>] = s[<span class="number">3</span>][<span class="number">1</span>], s[<span class="number">0</span>][<span class="number">1</span>], s[<span class="number">1</span>][<span class="number">1</span>], s[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">	s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>], s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>] = s[<span class="number">2</span>][<span class="number">2</span>], s[<span class="number">3</span>][<span class="number">2</span>], s[<span class="number">0</span>][<span class="number">2</span>], s[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">	s[<span class="number">0</span>][<span class="number">3</span>], s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>] = s[<span class="number">1</span>][<span class="number">3</span>], s[<span class="number">2</span>][<span class="number">3</span>], s[<span class="number">3</span>][<span class="number">3</span>], s[<span class="number">0</span>][<span class="number">3</span>]</span><br></pre></td></tr></table></figure>

<h4 id="单列列混淆变换"><a href="#单列列混淆变换" class="headerlink" title="单列列混淆变换"></a>单列列混淆变换</h4><p><img src="https://pic002.cnblogs.com/images/2010/169108/2010103102014940.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mix_single_column</span><span class="params">(self, a)</span>:</span></span><br><span class="line">	t = a[<span class="number">0</span>] ^ a[<span class="number">1</span>] ^ a[<span class="number">2</span>] ^ a[<span class="number">3</span>]</span><br><span class="line">	u = a[<span class="number">0</span>]</span><br><span class="line">	a[<span class="number">0</span>] ^= t ^ xtime(a[<span class="number">0</span>] ^ a[<span class="number">1</span>])</span><br><span class="line">	a[<span class="number">1</span>] ^= t ^ xtime(a[<span class="number">1</span>] ^ a[<span class="number">2</span>])</span><br><span class="line">	a[<span class="number">2</span>] ^= t ^ xtime(a[<span class="number">2</span>] ^ a[<span class="number">3</span>])</span><br><span class="line">	a[<span class="number">3</span>] ^= t ^ xtime(a[<span class="number">3</span>] ^ u)</span><br></pre></td></tr></table></figure>

<h4 id="列混淆变换"><a href="#列混淆变换" class="headerlink" title="列混淆变换"></a>列混淆变换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__mix_columns</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">		self.__mix_single_column(s[i])</span><br></pre></td></tr></table></figure>

<h4 id="逆混淆列变换"><a href="#逆混淆列变换" class="headerlink" title="逆混淆列变换"></a>逆混淆列变换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__inv_mix_columns</span><span class="params">(self, s)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">		u = xtime(xtime(s[i][<span class="number">0</span>] ^ s[i][<span class="number">2</span>]))</span><br><span class="line">		v = xtime(xtime(s[i][<span class="number">1</span>] ^ s[i][<span class="number">3</span>]))</span><br><span class="line">		s[i][<span class="number">0</span>] ^= u</span><br><span class="line">		s[i][<span class="number">1</span>] ^= v</span><br><span class="line">		s[i][<span class="number">2</span>] ^= u</span><br><span class="line">		s[i][<span class="number">3</span>] ^= v</span><br><span class="line">	self.__mix_columns(s)</span><br></pre></td></tr></table></figure>

<h4 id="密钥处理"><a href="#密钥处理" class="headerlink" title="密钥处理"></a>密钥处理</h4><h5 id="轮密钥加变换"><a href="#轮密钥加变换" class="headerlink" title="轮密钥加变换"></a>轮密钥加变换</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__add_round_key</span><span class="params">(self, s, k)</span>:</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">			s[i][j] ^= k[i][j]</span><br></pre></td></tr></table></figure>

<h5 id="密钥扩展"><a href="#密钥扩展" class="headerlink" title="密钥扩展"></a><strong>密钥扩展</strong></h5><p>将输入的密钥扩展为11组128位密钥组，其中第0组为输入密钥本身 </p>
<p> 其后第n组第i列 为 第n-1组第i列 与 第n组第i-1列之和（模2加法，1&lt;= i &lt;=3）</p>
<p><img src="https://pic002.cnblogs.com/images/2010/169108/2010103102042294.png" alt="img"></p>
<p>对于每一组 第一列即i=0，有特殊的处理</p>
<p><img src="https://pic002.cnblogs.com/images/2010/169108/2010103102044067.png" alt="img"></p>
<blockquote>
<p>将前一列即第n-1组第3列的4个字节循环左移1个字节，</p>
<p>并对每个字节进行字节替代变换SubBytes</p>
<p>将第一行（即第一个字节）与轮常量rc[n]相加 </p>
<p>最后再与前一组该列相加 </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, master_key)</span>:</span></span><br><span class="line">	self.change_key(master_key)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_key</span><span class="params">(self, master_key)</span>:</span></span><br><span class="line">	self.round_keys = text2matrix(master_key)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>, <span class="number">4</span> * <span class="number">11</span>):</span><br><span class="line">		self.round_keys.append([])</span><br><span class="line">		<span class="keyword">if</span> i % <span class="number">4</span> == <span class="number">0</span>:</span><br><span class="line">			byte = self.round_keys[i - <span class="number">4</span>][<span class="number">0</span>]        \</span><br><span class="line">				^ Sbox[self.round_keys[i - <span class="number">1</span>][<span class="number">1</span>]]  \</span><br><span class="line">				^ Rcon[int(i/<span class="number">4</span>)]</span><br><span class="line">			self.round_keys[i].append(byte)</span><br><span class="line">			<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">4</span>):</span><br><span class="line">				byte = self.round_keys[i - <span class="number">4</span>][j]    \</span><br><span class="line">					 ^ Sbox[self.round_keys[i - <span class="number">1</span>][(j + <span class="number">1</span>) % <span class="number">4</span>]]</span><br><span class="line">				self.round_keys[i].append(byte)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">                    byte = self.round_keys[i - <span class="number">4</span>][j]    \</span><br><span class="line">                         ^ self.round_keys[i - <span class="number">1</span>][j]</span><br><span class="line">                    self.round_keys[i].append(byte)</span><br></pre></td></tr></table></figure>

<h4 id="加密函数"><a href="#加密函数" class="headerlink" title="加密函数"></a>加密函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(self, plaintext)</span>:</span></span><br><span class="line">	self.plain_state = text2matrix(plaintext)</span><br><span class="line">	self.__add_round_key(self.plain_state, self.round_keys[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">	self.__round_encrypt(self.plain_state, self.round_keys[<span class="number">4</span> * i : <span class="number">4</span> * (i + <span class="number">1</span>)])</span><br><span class="line">	self.__sub_bytes(self.plain_state)</span><br><span class="line">	self.__shift_rows(self.plain_state)</span><br><span class="line">	self.__add_round_key(self.plain_state, self.round_keys[<span class="number">40</span>:])</span><br><span class="line">	<span class="keyword">return</span> matrix2text(self.plain_state)</span><br></pre></td></tr></table></figure>

<h4 id="解密函数"><a href="#解密函数" class="headerlink" title="解密函数"></a>解密函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(self, ciphertext)</span>:</span></span><br><span class="line">	self.cipher_state = text2matrix(ciphertext)</span><br><span class="line">	self.__add_round_key(self.cipher_state, self.round_keys[<span class="number">40</span>:])</span><br><span class="line">	self.__inv_shift_rows(self.cipher_state)</span><br><span class="line">	self.__inv_sub_bytes(self.cipher_state)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">9</span>, <span class="number">0</span>, <span class="number">-1</span>):</span><br><span class="line">		self.__round_decrypt(self.cipher_state, self.round_keys[<span class="number">4</span> * i : <span class="number">4</span> * (i + <span class="number">1</span>)])</span><br><span class="line">        self.__add_round_key(self.cipher_state, self.round_keys[:<span class="number">4</span>])</span><br><span class="line">        <span class="keyword">return</span> matrix2text(self.cipher_state)</span><br></pre></td></tr></table></figure>

<h4 id="AES的S盒"><a href="#AES的S盒" class="headerlink" title="AES的S盒"></a>AES的S盒</h4><p>参考了GitHub和看雪论坛的代码实现</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;Windows.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"MatrixGF2.h"</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"PolynomialGF2.h"</span></span></span><br><span class="line">MatrixGF2&lt;BYTE&gt; g_mtxPositiveBox(<span class="number">16</span>, <span class="number">16</span>, <span class="number">0</span>);</span><br><span class="line">MatrixGF2&lt;BYTE&gt; g_mtxReverseBox(<span class="number">16</span>, <span class="number">16</span>, <span class="number">0</span>);</span><br><span class="line">MatrixGF2&lt;BYTE&gt; g_mtxBytePositiveTransformMatrix(<span class="number">8</span>, <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line">MatrixGF2&lt;BYTE&gt; g_mtxByteReverseTransformMatrix(<span class="number">8</span>, <span class="number">8</span>, <span class="number">0</span>);</span><br><span class="line">BYTE g_bytPositiveFixed = <span class="number">0</span>;</span><br><span class="line">BYTE g_bytReverseFixed = <span class="number">0</span>;</span><br><span class="line">PolynomialGF2 g_polyModle; </span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAKEBYTE(_high, _low) (((_high) &lt;&lt; 4) | (_low)) </span></span><br><span class="line"><span class="function">PolynomialGF2 <span class="title">PolynomialEuclidEx</span><span class="params">(<span class="keyword">const</span> PolynomialGF2 &amp;kref_polyA,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 <span class="keyword">const</span> PolynomialGF2 &amp;kref_polyB,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 PolynomialGF2 &amp;ref_polyX,</span></span></span><br><span class="line"><span class="function"><span class="params">                                 PolynomialGF2 &amp;ref_polyY)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (kref_polyB.EqualZero())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">std</span>::runtime_error(<span class="string">"zero!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> iHighestBitIndex = kref_polyA.GetHightestBitIndex();</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyQuotient</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyRemainder</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyLastLastX</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    polyLastLastX = <span class="number">1</span>;</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyLastLastY</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    PolynomialGF2 polyLastLastRemainder = kref_polyA;</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyLastX</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="function">PolynomialGF2 <span class="title">polyLastY</span><span class="params">(iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    polyLastY = <span class="number">1</span>;</span><br><span class="line">    PolynomialGF2 polyLastRemainder = kref_polyB;</span><br><span class="line">    ref_polyX.Clear();</span><br><span class="line">    ref_polyY.Clear();</span><br><span class="line">    ref_polyX.Insert(<span class="number">0</span>, iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    ref_polyY.Insert(<span class="number">0</span>, iHighestBitIndex + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    ref_polyY = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        polyLastLastRemainder.Division(polyLastRemainder,</span><br><span class="line">                                       polyQuotient,</span><br><span class="line">                                       polyRemainder);</span><br><span class="line">        <span class="keyword">if</span> (polyRemainder.EqualZero())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ref_polyX = polyLastLastX - polyLastX * polyQuotient;</span><br><span class="line">        ref_polyY = polyLastLastY - polyLastY * polyQuotient;</span><br><span class="line">        polyLastLastRemainder = polyLastRemainder;</span><br><span class="line">        polyLastRemainder = polyRemainder;</span><br><span class="line">        polyLastLastX = polyLastX;</span><br><span class="line">        polyLastLastY = polyLastY;</span><br><span class="line">        polyLastX = ref_polyX;</span><br><span class="line">        polyLastY = ref_polyY;</span><br><span class="line">    &#125; <span class="keyword">while</span> (TRUE);</span><br><span class="line">    <span class="keyword">return</span> polyLastRemainder;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitByteTransformMatrix</span><span class="params">(PolynomialGF2 &amp;ref_polyInit,</span></span></span><br><span class="line"><span class="function"><span class="params">                             MatrixGF2&lt;BYTE&gt; &amp;ref_mtxTarget)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">size_t</span> uiColumnNumber = ref_mtxTarget.GetColumnNumber();</span><br><span class="line">    <span class="keyword">if</span> (ref_polyInit.GetSize() != ref_mtxTarget.GetColumnNumber())</span><br><span class="line">    &#123;</span><br><span class="line">        ref_polyInit.PaddingZero(uiColumnNumber);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">size_t</span> uiRowNumber = uiColumnNumber;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntY = <span class="number">0</span>; cntY &lt; uiRowNumber; cntY++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">size_t</span> iOffset = cntY;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> cntX = <span class="number">0</span>; cntX &lt; uiColumnNumber; cntX++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">size_t</span> iActualPos = cntX + iOffset;</span><br><span class="line">            <span class="keyword">if</span> (iActualPos &gt;= uiColumnNumber)</span><br><span class="line">            &#123;</span><br><span class="line">                iActualPos -= uiColumnNumber;</span><br><span class="line">            &#125;</span><br><span class="line">            ref_mtxTarget[cntY][iActualPos] = ref_polyInit[cntX];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitPositiveBox</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MatrixGF2&lt;BYTE&gt; mtxFixed = PolynomialGF2(g_bytPositiveFixed).GetDequeFormat();</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntY = <span class="number">0</span>; cntY &lt; <span class="number">16</span>; cntY++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> cntX = <span class="number">0</span>; cntX &lt; <span class="number">16</span>; cntX++)</span><br><span class="line">        &#123;</span><br><span class="line">            BYTE bytSource = (BYTE)MAKEBYTE(cntY, cntX);</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> == bytSource)</span><br><span class="line">            &#123;</span><br><span class="line">                g_mtxPositiveBox[cntY][cntX] = g_bytPositiveFixed;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            PolynomialGF2 polyInverseElement;</span><br><span class="line">            PolynomialGF2 polyX;</span><br><span class="line">            PolynomialGF2 polySource = bytSource;</span><br><span class="line">            <span class="keyword">if</span> (!polySource.EqualZero())</span><br><span class="line">            &#123;</span><br><span class="line">                PolynomialGF2 polyResult =</span><br><span class="line">                    PolynomialEuclidEx(g_polyModle,</span><br><span class="line">                                       polySource,</span><br><span class="line">                                       polyX,</span><br><span class="line">                                       polyInverseElement);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                polyInverseElement = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">            &#125;</span><br><span class="line">            polyInverseElement.ClearInvalidZero();</span><br><span class="line">            MatrixGF2&lt;BYTE&gt; mtxValue = polyInverseElement.GetDequeFormat();</span><br><span class="line"> </span><br><span class="line">            mtxValue.PaddingRow(</span><br><span class="line">                g_mtxBytePositiveTransformMatrix.GetColumnNumber()</span><br><span class="line">            );</span><br><span class="line">            mtxFixed.PaddingRow(mtxValue.GetRowNumber());</span><br><span class="line"> </span><br><span class="line">            mtxValue = g_mtxBytePositiveTransformMatrix * mtxValue + mtxFixed;</span><br><span class="line">            g_mtxPositiveBox[cntY][cntX] =</span><br><span class="line">                (BYTE)PolynomialGF2(mtxValue.Transform2Vector()).ToNumber();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitReverseBox</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MatrixGF2&lt;BYTE&gt; mtxFixed = PolynomialGF2(g_bytReverseFixed).GetDequeFormat();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntY = <span class="number">0</span>; cntY &lt; <span class="number">16</span>; cntY++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> cntX = <span class="number">0</span>; cntX &lt; <span class="number">16</span>; cntX++)</span><br><span class="line">        &#123;</span><br><span class="line">            BYTE bytSource = (BYTE)MAKEBYTE(cntY, cntX);</span><br><span class="line">            MatrixGF2&lt;BYTE&gt; mtxValue = bytSource;</span><br><span class="line">            <span class="keyword">int</span> iValueColumnNumber =</span><br><span class="line">                g_mtxByteReverseTransformMatrix.GetColumnNumber();</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> == bytSource)</span><br><span class="line">            &#123;</span><br><span class="line">                mtxValue.InsertRow(<span class="number">0</span>, iValueColumnNumber, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            mtxValue.PaddingRow(iValueColumnNumber);</span><br><span class="line">            mtxFixed.PaddingRow(mtxValue.GetRowNumber());</span><br><span class="line">            mtxValue = g_mtxByteReverseTransformMatrix * mtxValue + mtxFixed;</span><br><span class="line">            PolynomialGF2 polyInverseElement;</span><br><span class="line">            PolynomialGF2 polyX;</span><br><span class="line">            PolynomialGF2 polyValue = mtxValue.Transform2Vector();</span><br><span class="line">            <span class="keyword">if</span> (!polyValue.EqualZero())</span><br><span class="line">            &#123;</span><br><span class="line">                PolynomialGF2 polyResult =</span><br><span class="line">                    PolynomialEuclidEx(g_polyModle,</span><br><span class="line">                                       polyValue,</span><br><span class="line">                                       polyX,</span><br><span class="line">                                       polyInverseElement);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                polyInverseElement = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">            g_mtxReverseBox[cntY][cntX] = (BYTE)polyInverseElement.ToNumber();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitStandardBox</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    g_polyModle = &#123; <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    PolynomialGF2 polyPositiveSeed = &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    InitByteTransformMatrix(polyPositiveSeed, g_mtxBytePositiveTransformMatrix);</span><br><span class="line">    PolynomialGF2 polyReverseSeed = &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span> &#125;;</span><br><span class="line">    InitByteTransformMatrix(polyReverseSeed, g_mtxByteReverseTransformMatrix);</span><br><span class="line">    g_bytPositiveFixed = <span class="number">0x63</span>;</span><br><span class="line">    g_bytReverseFixed = <span class="number">0x05</span>;</span><br><span class="line">    InitPositiveBox();</span><br><span class="line">    InitReverseBox();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Positive box: \n%s\n"</span>,</span><br><span class="line">           g_mtxPositiveBox.GetWrittenFormat().c_str());</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Reverse box: \n%s\n"</span>,</span><br><span class="line">           g_mtxReverseBox.GetWrittenFormat().c_str());</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    InitStandardBox();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="重要的实现细节"><a href="#重要的实现细节" class="headerlink" title="重要的实现细节"></a>重要的实现细节</h2><h4 id="GF2域上的计算"><a href="#GF2域上的计算" class="headerlink" title="GF2域上的计算"></a>GF2域上的计算</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line">PolynomialGF2 &amp;PolynomialGF2::<span class="keyword">operator</span>=(<span class="keyword">const</span> PolynomialGF2 &amp;kref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    m_deqPolynomial = kref_polyRight.m_deqPolynomial;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 &amp;PolynomialGF2::<span class="keyword">operator</span>=(PolynomialGF2 &amp;&amp;rvalue_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    m_deqPolynomial = <span class="built_in">std</span>::move(rvalue_polyRight.m_deqPolynomial);</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>+(<span class="keyword">const</span> PolynomialGF2 &amp;ref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    PolynomialGF2 polyResult = *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">int</span> iRightHeighestBitIndex = ref_polyRight.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">int</span> iLeftHeighestBitIext = polyResult.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">if</span> (iRightHeighestBitIndex &gt; iLeftHeighestBitIext)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> iGap = iRightHeighestBitIndex - iLeftHeighestBitIext;</span><br><span class="line">        polyResult.Insert(iLeftHeighestBitIext + <span class="number">1</span>, iGap, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntI = <span class="number">0</span>; cntI &lt; (<span class="keyword">size_t</span>)(iRightHeighestBitIndex + <span class="number">1</span>); cntI++)</span><br><span class="line">    &#123;</span><br><span class="line">        polyResult[cntI] ^= ref_polyRight[cntI];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> polyResult;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>-(<span class="keyword">const</span> PolynomialGF2 &amp;ref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    PolynomialGF2 polyResult = *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">int</span> iRightHeighestBitIndex = ref_polyRight.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">int</span> iLeftHeighestBitIext = polyResult.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">if</span> (iRightHeighestBitIndex &gt; iLeftHeighestBitIext)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> iGap = iRightHeighestBitIndex - iLeftHeighestBitIext;</span><br><span class="line">        polyResult.Insert(iLeftHeighestBitIext + <span class="number">1</span>, iGap, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntI = <span class="number">0</span>; cntI &lt; ref_polyRight.GetSize(); cntI++)</span><br><span class="line">    &#123;</span><br><span class="line">        polyResult[cntI] ^= ref_polyRight[cntI];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> polyResult;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>-(<span class="keyword">const</span> PolynomialGF2 &amp;ref_polyRight) <span class="keyword">const</span></span><br><span class="line">&#123;</span><br><span class="line">    PolynomialGF2 polyResult = *<span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">int</span> iRightHeighestBitIndex = ref_polyRight.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">int</span> iLeftHeighestBitIext = polyResult.GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">if</span> (iRightHeighestBitIndex &gt; iLeftHeighestBitIext)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> iGap = iRightHeighestBitIndex - iLeftHeighestBitIext;</span><br><span class="line">        polyResult.Insert(iLeftHeighestBitIext + <span class="number">1</span>, iGap, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntI = <span class="number">0</span>; cntI &lt; ref_polyRight.GetSize(); cntI++)</span><br><span class="line">    &#123;</span><br><span class="line">        polyResult[cntI] ^= ref_polyRight[cntI];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> polyResult;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>*(<span class="keyword">const</span> PolynomialGF2 &amp;ref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    PolynomialGF2 polyResult;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntI = <span class="number">0</span>; cntI &lt; ref_polyRight.GetSize(); cntI++)</span><br><span class="line">    &#123;</span><br><span class="line">        PolynomialGF2 polyTmp = *<span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> == ref_polyRight[cntI])</span><br><span class="line">        &#123;</span><br><span class="line">            polyTmp.Insert(<span class="number">0</span>, cntI, <span class="number">0</span>);</span><br><span class="line">            polyResult = polyResult + polyTmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> polyResult;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>/(<span class="keyword">const</span> PolynomialGF2 &amp;kref_right)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125; <span class="comment">//! Polynomial::operator/() END</span></span><br><span class="line">PolynomialGF2 PolynomialGF2::<span class="keyword">operator</span>%(<span class="keyword">const</span> PolynomialGF2 &amp;kref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    PolynomialGF2 polyResult;</span><br><span class="line">    <span class="keyword">int</span> iLeftHightestBitIndex = GetHightestBitIndex();</span><br><span class="line">    <span class="keyword">int</span> iRightHightestBitIndex = kref_polyRight.GetHightestBitIndex();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (iLeftHightestBitIndex == iRightHightestBitIndex)</span><br><span class="line">    &#123;</span><br><span class="line">        polyResult = kref_polyRight - *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (iLeftHightestBitIndex &lt; iRightHightestBitIndex)</span><br><span class="line">    &#123;</span><br><span class="line">        polyResult = *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (iLeftHightestBitIndex &gt; iRightHightestBitIndex)</span><br><span class="line">    &#123;</span><br><span class="line">        PolynomialGF2 polyQuotient;</span><br><span class="line">        Division(kref_polyRight, polyQuotient, polyResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> polyResult;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 &amp;PolynomialGF2::<span class="keyword">operator</span>&lt;&lt;=(<span class="keyword">const</span> <span class="keyword">size_t</span> &amp;kref_uiNumber)</span><br><span class="line">&#123;</span><br><span class="line">    m_deqPolynomial.insert(m_deqPolynomial.cbegin(), kref_uiNumber, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span> (m_bEnableLeftMoveLimit &amp;&amp;</span><br><span class="line">        GetHightestBitIndex() &gt;= (<span class="keyword">int</span>)m_uiLeftMoveLimitBit)</span><br><span class="line">    &#123;</span><br><span class="line">        m_deqPolynomial.erase(<span class="built_in">std</span>::next(m_deqPolynomial.cbegin(),</span><br><span class="line">                                        m_uiLeftMoveLimitBit),</span><br><span class="line">                              m_deqPolynomial.cend());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125; </span><br><span class="line">PolynomialGF2 &amp;PolynomialGF2::<span class="keyword">operator</span>^=(<span class="keyword">const</span> PolynomialGF2 &amp;kref_polyRight)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">size_t</span> uiheighBit = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">size_t</span> uiLeftSize = m_deqPolynomial.size();</span><br><span class="line">    <span class="keyword">size_t</span> uiRightSize = kref_polyRight.GetSize();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">size_t</span> uiOperationSize = uiLeftSize;</span><br><span class="line">    <span class="keyword">if</span> (uiLeftSize &gt; uiRightSize)</span><br><span class="line">    &#123;</span><br><span class="line">        uiOperationSize = uiRightSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> cntI = <span class="number">0</span>; cntI &lt; uiOperationSize; cntI++)</span><br><span class="line">    &#123;</span><br><span class="line">        m_deqPolynomial[cntI] ^= kref_polyRight[cntI];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">master_key = <span class="number">0x2b7e151628aed2a6abf7158809cf4f3c</span></span><br><span class="line">plaintext = <span class="number">0x3243f6a8885a308d313198a2e0370734</span></span><br><span class="line">ciphertext = <span class="number">0x3925841d02dc09fbdc118597196a0b32</span></span><br><span class="line">encrypt：<span class="number">0x3925841d02dc09fbdc118597196a0b32</span></span><br><span class="line">decrypt：<span class="number">0x3243f6a8885a308d313198a2e0370734</span></span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>基本实现了AES的基本加密算法的实现</p>

    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/10/07/ǳ̸Linux-Heap/" rel="next" title="浅谈Linux-Heap">
                  <i class="fa fa-chevron-left"></i> 浅谈Linux-Heap
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/10/12/DES-ECB/" rel="prev" title="DES-ECB">
                  DES-ECB <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#实验要求"><span class="nav-number">1.</span> <span class="nav-text">实验要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实验原理"><span class="nav-number">2.</span> <span class="nav-text">实验原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AES的基本结构"><span class="nav-number">2.1.</span> <span class="nav-text">AES的基本结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一、字节代换"><span class="nav-number">2.2.</span> <span class="nav-text">一、字节代换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-字节代换操作"><span class="nav-number">2.2.1.</span> <span class="nav-text">1.字节代换操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-字节代换逆操作"><span class="nav-number">2.2.2.</span> <span class="nav-text">2.字节代换逆操作</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、行移位"><span class="nav-number">2.3.</span> <span class="nav-text">二、行移位</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-行移位操作"><span class="nav-number">2.3.1.</span> <span class="nav-text">1.行移位操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-行移位的逆变换"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.行移位的逆变换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、列混合"><span class="nav-number">2.4.</span> <span class="nav-text">三、列混合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-列混合操作"><span class="nav-number">2.4.1.</span> <span class="nav-text">1.列混合操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-列混合逆运算"><span class="nav-number">2.4.2.</span> <span class="nav-text">2.列混合逆运算</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#四、轮密钥加"><span class="nav-number">2.5.</span> <span class="nav-text">四、轮密钥加</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#五、密钥扩展"><span class="nav-number">2.6.</span> <span class="nav-text">五、密钥扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#六、AES解密"><span class="nav-number">2.7.</span> <span class="nav-text">六、AES解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#软件系统设计"><span class="nav-number">3.</span> <span class="nav-text">软件系统设计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#XTime运算"><span class="nav-number">3.0.1.</span> <span class="nav-text">XTime运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#字节替代"><span class="nav-number">3.0.2.</span> <span class="nav-text">字节替代</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逆字节替换"><span class="nav-number">3.0.3.</span> <span class="nav-text">逆字节替换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#行移位变换"><span class="nav-number">3.0.4.</span> <span class="nav-text">行移位变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逆行移位变换"><span class="nav-number">3.0.5.</span> <span class="nav-text">逆行移位变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#单列列混淆变换"><span class="nav-number">3.0.6.</span> <span class="nav-text">单列列混淆变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#列混淆变换"><span class="nav-number">3.0.7.</span> <span class="nav-text">列混淆变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逆混淆列变换"><span class="nav-number">3.0.8.</span> <span class="nav-text">逆混淆列变换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#密钥处理"><span class="nav-number">3.0.9.</span> <span class="nav-text">密钥处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#轮密钥加变换"><span class="nav-number">3.0.9.1.</span> <span class="nav-text">轮密钥加变换</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#密钥扩展"><span class="nav-number">3.0.9.2.</span> <span class="nav-text">密钥扩展</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#加密函数"><span class="nav-number">3.0.10.</span> <span class="nav-text">加密函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#解密函数"><span class="nav-number">3.0.11.</span> <span class="nav-text">解密函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AES的S盒"><span class="nav-number">3.0.12.</span> <span class="nav-text">AES的S盒</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重要的实现细节"><span class="nav-number">4.</span> <span class="nav-text">重要的实现细节</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GF2域上的计算"><span class="nav-number">4.0.1.</span> <span class="nav-text">GF2域上的计算</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现效果"><span class="nav-number">5.</span> <span class="nav-text">实现效果</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">6.</span> <span class="nav-text">总结</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZERO-A-ONE</p>
  <div class="site-description" itemprop="description">Resit much,Obey little</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZERO-A-ONE</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  

</body>
</html>
