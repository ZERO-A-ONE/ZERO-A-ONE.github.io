<!DOCTYPE html>





<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="ZERO-A-ONE" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="实验要求 根据扩展欧几里得算法实现求乘法逆元模块 根据分组长度n, 生成密钥(A,B)。即可逆矩阵A和向量B。生成的密钥要有随机性，密钥以文件形式存储 生成A的逆矩阵A-1 实现多表代换加密、解密模块 实现加密解密软件基本的可视化界面，能够对输入文本框的英文字符串进行加密解密，能够对文本文件中的文本进行加密解密 附加内容 对长度不是n的倍数的明文的处理，能够对长度不是n的倍数的明文进行加密解密 对">
<meta property="og:type" content="article">
<meta property="og:title" content="现代密码学之多表加密">
<meta property="og:url" content="http://yoursite.com/2019/09/09/╧╓┤·├▄┬δ╤º╓«╢α▒φ╝╙├▄/index.html">
<meta property="og:site_name" content="ZERO-A-ONE">
<meta property="og:description" content="实验要求 根据扩展欧几里得算法实现求乘法逆元模块 根据分组长度n, 生成密钥(A,B)。即可逆矩阵A和向量B。生成的密钥要有随机性，密钥以文件形式存储 生成A的逆矩阵A-1 实现多表代换加密、解密模块 实现加密解密软件基本的可视化界面，能够对输入文本框的英文字符串进行加密解密，能够对文本文件中的文本进行加密解密 附加内容 对长度不是n的倍数的明文的处理，能够对长度不是n的倍数的明文进行加密解密 对">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%B8%BB%E7%95%8C%E9%9D%A2.png">
<meta property="og:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E7%9F%A9%E9%98%B5.png">
<meta property="og:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E9%80%86%E7%9F%A9%E9%98%B5.png">
<meta property="og:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%BE%8B%E9%A2%98%E5%8A%A0%E5%AF%86.png">
<meta property="og:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%BE%8B%E9%A2%98%E8%A7%A3%E5%AF%86.png">
<meta property="og:updated_time" content="2019-09-17T22:40:48.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="现代密码学之多表加密">
<meta name="twitter:description" content="实验要求 根据扩展欧几里得算法实现求乘法逆元模块 根据分组长度n, 生成密钥(A,B)。即可逆矩阵A和向量B。生成的密钥要有随机性，密钥以文件形式存储 生成A的逆矩阵A-1 实现多表代换加密、解密模块 实现加密解密软件基本的可视化界面，能够对输入文本框的英文字符串进行加密解密，能够对文本文件中的文本进行加密解密 附加内容 对长度不是n的倍数的明文的处理，能够对长度不是n的倍数的明文进行加密解密 对">
<meta name="twitter:image" content="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%B8%BB%E7%95%8C%E9%9D%A2.png">
  <link rel="canonical" href="http://yoursite.com/2019/09/09/╧╓┤·├▄┬δ╤º╓«╢α▒φ╝╙├▄/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>现代密码学之多表加密 | ZERO-A-ONE</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZERO-A-ONE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
     <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/09/╧╓┤·├▄┬δ╤º╓«╢α▒φ╝╙├▄/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZERO-A-ONE">
      <meta itemprop="description" content="Resit much,Obey little">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZERO-A-ONE">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">现代密码学之多表加密

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2019-09-09 06:53:48" itemprop="dateCreated datePublished" datetime="2019-09-09T06:53:48-07:00">2019-09-09</time>
            </span>
          
            

            
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-09-17 15:40:48" itemprop="dateModified" datetime="2019-09-17T15:40:48-07:00">2019-09-17</time>
              </span>
            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="实验要求"><a href="#实验要求" class="headerlink" title="实验要求"></a>实验要求</h2><ul>
<li>根据扩展欧几里得算法实现求乘法逆元模块</li>
<li>根据分组长度n, 生成密钥(A,B)。即可逆矩阵A和向量B。生成的密钥要有随机性，密钥以文件形式存储</li>
<li>生成A的逆矩阵A-1</li>
<li>实现多表代换加密、解密模块</li>
<li>实现加密解密软件基本的可视化界面，能够对输入文本框的英文字符串进行加密解密，能够对文本文件中的文本进行加密解密</li>
<li>附加内容<ul>
<li>对长度不是n的倍数的明文的处理，能够对长度不是n的倍数的明文进行加密解密</li>
<li>对空格和标点符号的处理。要求解密时能还原空格和标点符号</li>
</ul>
</li>
</ul>
<h2 id="实验原理"><a href="#实验原理" class="headerlink" title="实验原理"></a>实验原理</h2><p>多表代换密码实现加密过程主要可以分为以下几个步骤：</p>
<ul>
<li>随机生成n*n的可逆矩阵A，且满足A的行列式与所定模N互素，作为密钥A</li>
<li>随机生成n*1的矩阵B，作为密钥B</li>
<li>对所需明文就行分组</li>
<li>通过<code>Ci≡AMi+B(mod 26)</code>加密变换求出密文</li>
</ul>
<p>多表代换密码实现解密过程主要可以分为以下几个步骤：</p>
<ul>
<li>对输入的密钥A作为矩阵A，求出矩阵A的逆矩阵</li>
<li>对密文进行分组</li>
<li>通过<code>Mi≡A−1(Ci−B)(mod 26)</code>解密变换求出明文</li>
</ul>
<h2 id="软件系统设计"><a href="#软件系统设计" class="headerlink" title="软件系统设计"></a>软件系统设计</h2><h3 id="随机生成矩阵"><a href="#随机生成矩阵" class="headerlink" title="随机生成矩阵"></a>随机生成矩阵</h3><p>此部分主要介绍如何随机生成可逆矩阵A和矩阵B作为密钥A和密钥B，同时实现将密钥作为文件保存</p>
<h4 id="可逆矩阵A"><a href="#可逆矩阵A" class="headerlink" title="可逆矩阵A"></a>可逆矩阵A</h4><blockquote>
<p>生成可逆矩阵A的主要方法为：用单位矩阵进行初等变换而成</p>
</blockquote>
<h5 id="生成单位矩阵"><a href="#生成单位矩阵" class="headerlink" title="生成单位矩阵"></a>生成单位矩阵</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getIdentityMatrix</span><span class="params">(n)</span>:</span><span class="comment">#生成单位矩阵</span></span><br><span class="line">    A = np.zeros((n,n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                A[i][j] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                A[i][j] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br></pre></td></tr></table></figure>

<p>这没有什么可以讲的很简单</p>
<h5 id="生成随机可逆矩阵A"><a href="#生成随机可逆矩阵A" class="headerlink" title="生成随机可逆矩阵A"></a>生成随机可逆矩阵A</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInvertibleMatrix</span><span class="params">(n,m)</span>:</span><span class="comment">#生成可逆矩阵</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        A = getIdentityMatrix(n)</span><br><span class="line">        tempArray = np.zeros(n)</span><br><span class="line">        B = np.zeros((n,n))</span><br><span class="line">        transformTime = int(random.randint(<span class="number">0</span>,<span class="number">1000</span>))</span><br><span class="line">        maxint = sys.maxsize</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(transformTime):</span><br><span class="line">            mainRowNum = int((random.randint(<span class="number">0</span>,n) % (n - <span class="number">1</span>)))<span class="comment">#选择一个主行作初等行变换</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="comment">#元素数值是否会溢出</span></span><br><span class="line">                <span class="keyword">if</span> maxint - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &lt; <span class="number">0</span> <span class="keyword">and</span> maxint*(<span class="number">-1</span>) - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &gt; tempArray[k]:</span><br><span class="line">                    tempArray[k] = A[mainRowNum][k]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    tempArray[k] = (A[mainRowNum][k]*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))))%m</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="keyword">if</span> mainRowNum != j:</span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">                        <span class="keyword">if</span> maxint - A[j][k]&lt; tempArray[k] <span class="keyword">and</span> maxint * (<span class="number">-1</span>) - (A[j][k]) &gt; tempArray[k]:</span><br><span class="line">                            A[j][k] = (A[j][k]/<span class="number">4</span>)%m</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            A[j][k] = (A[j][k] + tempArray[k])%m</span><br><span class="line">        <span class="keyword">if</span> gcd(np.linalg.det(A),m) == <span class="number">1</span> <span class="keyword">and</span> np.linalg.det(A) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br></pre></td></tr></table></figure>

<p>其中<code>transformTime</code>为随机决定初等行变换的次数，关键是要确保<strong>矩阵A的行列式与所定模N互素</strong></p>
<p>故需要此限定的条件：<code>gcd(np.linalg.det(A),m) == 1 and np.linalg.det(A)</code></p>
<h4 id="矩阵B"><a href="#矩阵B" class="headerlink" title="矩阵B"></a>矩阵B</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">B = np.zeros((n, <span class="number">1</span>))</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">	B[row] = int(random.randint(<span class="number">0</span>, <span class="number">26</span>))</span><br></pre></td></tr></table></figure>

<p>这没有什么可以讲的很简单</p>
<h3 id="明文分组加密"><a href="#明文分组加密" class="headerlink" title="明文分组加密"></a>明文分组加密</h3><h4 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h4><h5 id="记录空格和符号"><a href="#记录空格和符号" class="headerlink" title="记录空格和符号"></a>记录空格和符号</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">klist = np.zeros(len(clear))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">' '</span>:</span><br><span class="line">                klist[index] = int(i)</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">dlist = np.zeros(len(clear))</span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">				<span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">        		dlist[index] = int(i)</span><br><span class="line">            index = index + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="字符串初始化转换为纯字母序列"><a href="#字符串初始化转换为纯字母序列" class="headerlink" title="字符串初始化转换为纯字母序列"></a>字符串初始化转换为纯字母序列</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">        <span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">            clear[i] = <span class="string">' '</span></span><br><span class="line">    <span class="keyword">while</span> <span class="string">' '</span> <span class="keyword">in</span> clear:</span><br><span class="line">        clear.remove(<span class="string">' '</span>)</span><br></pre></td></tr></table></figure>

<h4 id="补位操作"><a href="#补位操作" class="headerlink" title="补位操作"></a>补位操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (lenth % n == <span class="number">0</span>):</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        offset = n - lenth % n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):</span><br><span class="line">        CipherText.append(<span class="string">'A'</span>)</span><br><span class="line">    groups = int(len(CipherText) / n)</span><br></pre></td></tr></table></figure>

<h4 id="生成M序列"><a href="#生成M序列" class="headerlink" title="生成M序列"></a>生成M序列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">M = np.zeros((groups, n))</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(groups):</span><br><span class="line">        <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">            M[row][column] = CipherText[index]</span><br><span class="line">            index = index + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="分组加密"><a href="#分组加密" class="headerlink" title="分组加密"></a>分组加密</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(groups):<span class="comment">#实现矩阵乘法和矩阵加法，InA*(C-B)</span></span><br><span class="line">       tmp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">       tmpp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">       <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#初始化Mi</span></span><br><span class="line">           tmp[row][<span class="number">0</span>] = M[i][row]</span><br><span class="line">       <span class="keyword">for</span> row <span class="keyword">in</span> range(n):  <span class="comment"># 实现C-B</span></span><br><span class="line">           tmp[row][<span class="number">0</span>] = tmp[row][<span class="number">0</span>] - B[row][<span class="number">0</span>]</span><br><span class="line">       <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#实现InA*(C-B)mod(N)</span></span><br><span class="line">           <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">               tmpp[row][<span class="number">0</span>] = int(tmpp[row][<span class="number">0</span>] + (int(tmp[column][<span class="number">0</span>]) * int(A[row][column])))</span><br><span class="line">           tmpp[row][<span class="number">0</span>] = int((tmpp[row][<span class="number">0</span>]) % N)</span><br><span class="line">       <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">           clearlist.append(NtoA(int(tmpp[row][<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<h4 id="消除补位影响"><a href="#消除补位影响" class="headerlink" title="消除补位影响"></a>消除补位影响</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):<span class="comment">#消除补位影响</span></span><br><span class="line">            <span class="keyword">del</span> clearlist[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>

<h3 id="逆矩阵"><a href="#逆矩阵" class="headerlink" title="逆矩阵"></a>逆矩阵</h3><h5 id="逆元"><a href="#逆元" class="headerlink" title="逆元"></a>逆元</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InverseElement</span><span class="params">(b,p)</span>:</span><span class="comment">#求逆元</span></span><br><span class="line">    inv = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> (inv*b)%p == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        inv = inv +<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> inv</span><br></pre></td></tr></table></figure>

<h5 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Det</span><span class="params">(a,n)</span>:</span><span class="comment">#求行列式</span></span><br><span class="line">    b = np.zeros((n, n))<span class="comment">#临时数组用于降阶</span></span><br><span class="line">    sum = int(<span class="number">0</span>)</span><br><span class="line">    sign = int(<span class="number">0</span>)</span><br><span class="line">    p = int(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):<span class="comment">#此处大循环实现将余子式存入数组b中</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> c&lt;i:</span><br><span class="line">                    p = <span class="number">0</span><span class="comment">#当p=0时，行列式只向左移，即消去对应的第一列的数</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    p = <span class="number">1</span><span class="comment">#否则行列式左移后再上移</span></span><br><span class="line">                b[c][j]=a[c+p][j+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            sign = <span class="number">1</span><span class="comment">#i为偶数，加法</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sign = <span class="number">-1</span><span class="comment">#i为奇数，减法</span></span><br><span class="line">        sum = sum + a[i][<span class="number">0</span>]*Det(b,n<span class="number">-1</span>)*sign<span class="comment">#计算行列式的值</span></span><br><span class="line">    <span class="keyword">return</span>  sum</span><br></pre></td></tr></table></figure>

<h5 id="伴随矩阵"><a href="#伴随矩阵" class="headerlink" title="伴随矩阵"></a>伴随矩阵</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAStart</span><span class="params">(arcs,n,ans)</span>:</span><span class="comment">#计算每一行每一列的每个元素所对应的余子式，组成A*</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        ans[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    temp = np.zeros((n, n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                    temp[k][t] = arcs[(k+<span class="number">1</span> <span class="keyword">if</span> k&gt;=i <span class="keyword">else</span> k)][(t+<span class="number">1</span> <span class="keyword">if</span> t&gt;=j <span class="keyword">else</span> t)]</span><br><span class="line">                ans[j][i] = Det(temp,n<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">if</span> (i+j)%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                    ans[j][i] = -ans[j][i]</span><br></pre></td></tr></table></figure>

<h5 id="逆矩阵-1"><a href="#逆矩阵-1" class="headerlink" title="逆矩阵"></a>逆矩阵</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InverseMat</span><span class="params">(a,n,p,ans)</span>:</span></span><br><span class="line">    astar = np.zeros((n, n))</span><br><span class="line">    getAStart(a, n, astar)<span class="comment">#求A的伴随矩阵</span></span><br><span class="line">    deta = int(Det(a,n))<span class="comment">#求A的行列式</span></span><br><span class="line">    <span class="keyword">if</span> deta &lt; <span class="number">0</span>:</span><br><span class="line">        deta = deta + p</span><br><span class="line">    inv = int(InverseElement(deta,p))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            ans[i][j] = astar[i][j]*inv</span><br><span class="line">            ans[i][j] = ans[i][j]%p</span><br><span class="line">            <span class="keyword">if</span> ans[i][j] &lt;<span class="number">0</span>:</span><br><span class="line">                ans[i][j] = ans[i][j] + p</span><br></pre></td></tr></table></figure>

<h3 id="密文分组解密"><a href="#密文分组解密" class="headerlink" title="密文分组解密"></a>密文分组解密</h3><h5 id="补位操作-1"><a href="#补位操作-1" class="headerlink" title="补位操作"></a>补位操作</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (lenth % n == <span class="number">0</span>):</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        offset = n - lenth % n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):</span><br><span class="line">        CipherText.append(<span class="string">'A'</span>)</span><br><span class="line">    groups = int(len(CipherText) / n)</span><br></pre></td></tr></table></figure>

<h5 id="生成M序列-1"><a href="#生成M序列-1" class="headerlink" title="生成M序列"></a>生成M序列</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">M = np.zeros((groups, n))</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(groups):</span><br><span class="line">        <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">            M[row][column] = CipherText[index]</span><br><span class="line">            index = index + <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h5 id="分组解密"><a href="#分组解密" class="headerlink" title="分组解密"></a>分组解密</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(groups):<span class="comment">#实现矩阵乘法和矩阵加法，InA*(C-B)</span></span><br><span class="line">        tmp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        tmpp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#初始化Mi</span></span><br><span class="line">            tmp[row][<span class="number">0</span>] = M[i][row]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):  <span class="comment"># 实现C-B</span></span><br><span class="line">            tmp[row][<span class="number">0</span>] = tmp[row][<span class="number">0</span>] - B[row][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#实现InA*(C-B)mod(N)</span></span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">                tmpp[row][<span class="number">0</span>] = int(tmpp[row][<span class="number">0</span>] + (int(tmp[column][<span class="number">0</span>]) * int(A[row][column])))</span><br><span class="line">            tmpp[row][<span class="number">0</span>] = int((tmpp[row][<span class="number">0</span>]) % N)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            clearlist.append(NtoA(int(tmpp[row][<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>

<h5 id="消除补位影响-1"><a href="#消除补位影响-1" class="headerlink" title="消除补位影响"></a>消除补位影响</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):<span class="comment">#消除补位影响</span></span><br><span class="line">            <span class="keyword">del</span> clearlist[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>

<h3 id="GUI图形界面最终实现"><a href="#GUI图形界面最终实现" class="headerlink" title="GUI图形界面最终实现"></a>GUI图形界面最终实现</h3><p>GUI的实现使用的<strong>Python</strong>自带的<strong>tkinter</strong>库,实现了错误提示框的弹出和各类操作可视化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> tkinter <span class="keyword">as</span> tk</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> tkinter.simpledialog <span class="keyword">import</span> *</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a%b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    <span class="keyword">else</span> :</span><br><span class="line">        <span class="keyword">return</span> gcd(b,a%b)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">exgcd</span><span class="params">(a,b,x,y)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">0</span>:</span><br><span class="line">        x=<span class="number">1</span></span><br><span class="line">        y=<span class="number">0</span></span><br><span class="line">    d = exgcd(b,a%b,y,x)</span><br><span class="line">    y = y - (a/b)*x</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InverseElement</span><span class="params">(b,p)</span>:</span><span class="comment">#求逆元</span></span><br><span class="line">    inv = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">if</span> (inv*b)%p == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        inv = inv +<span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> inv</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Det</span><span class="params">(a,n)</span>:</span><span class="comment">#求行列式</span></span><br><span class="line">    b = np.zeros((n, n))<span class="comment">#临时数组用于降阶</span></span><br><span class="line">    sum = int(<span class="number">0</span>)</span><br><span class="line">    sign = int(<span class="number">0</span>)</span><br><span class="line">    p = int(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> a[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):<span class="comment">#此处大循环实现将余子式存入数组b中</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">if</span> c&lt;i:</span><br><span class="line">                    p = <span class="number">0</span><span class="comment">#当p=0时，行列式只向左移，即消去对应的第一列的数</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    p = <span class="number">1</span><span class="comment">#否则行列式左移后再上移</span></span><br><span class="line">                b[c][j]=a[c+p][j+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            sign = <span class="number">1</span><span class="comment">#i为偶数，加法</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sign = <span class="number">-1</span><span class="comment">#i为奇数，减法</span></span><br><span class="line">        sum = sum + a[i][<span class="number">0</span>]*Det(b,n<span class="number">-1</span>)*sign<span class="comment">#计算行列式的值</span></span><br><span class="line">    <span class="keyword">return</span>  sum</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getAStart</span><span class="params">(arcs,n,ans)</span>:</span><span class="comment">#计算每一行每一列的每个元素所对应的余子式，组成A*</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        ans[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    temp = np.zeros((n, n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                <span class="keyword">for</span> t <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">                    temp[k][t] = arcs[(k+<span class="number">1</span> <span class="keyword">if</span> k&gt;=i <span class="keyword">else</span> k)][(t+<span class="number">1</span> <span class="keyword">if</span> t&gt;=j <span class="keyword">else</span> t)]</span><br><span class="line">                ans[j][i] = Det(temp,n<span class="number">-1</span>)</span><br><span class="line">                <span class="keyword">if</span> (i+j)%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">                    ans[j][i] = -ans[j][i]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">InverseMat</span><span class="params">(a,n,p,ans)</span>:</span></span><br><span class="line">    astar = np.zeros((n, n))</span><br><span class="line">    getAStart(a, n, astar)<span class="comment">#求A的伴随矩阵</span></span><br><span class="line">    deta = int(Det(a,n))<span class="comment">#求A的行列式</span></span><br><span class="line">    <span class="keyword">if</span> deta &lt; <span class="number">0</span>:</span><br><span class="line">        deta = deta + p</span><br><span class="line">    inv = int(InverseElement(deta,p))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            ans[i][j] = astar[i][j]*inv</span><br><span class="line">            ans[i][j] = ans[i][j]%p</span><br><span class="line">            <span class="keyword">if</span> ans[i][j] &lt;<span class="number">0</span>:</span><br><span class="line">                ans[i][j] = ans[i][j] + p</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">AtoN</span><span class="params">(A)</span>:</span><span class="comment">#处理字符和数字的关系</span></span><br><span class="line">    N = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span>(ord(A)&gt;=<span class="number">65</span> <span class="keyword">and</span> ord(A)&lt;=<span class="number">90</span>):</span><br><span class="line">        N = ord(A) - ord(<span class="string">'A'</span>)</span><br><span class="line">    <span class="keyword">if</span> (ord(A) &gt;= <span class="number">97</span> <span class="keyword">and</span> ord(A) &lt;= <span class="number">122</span>):</span><br><span class="line">        N = ord(A) - ord(<span class="string">'a'</span>)</span><br><span class="line">    <span class="keyword">return</span> N</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">NtoA</span><span class="params">(N)</span>:</span></span><br><span class="line">    A = chr(N + ord(<span class="string">'A'</span>))</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Encrypt</span><span class="params">(clearlist,A,B,n,N)</span>:</span><span class="comment">#加密函数</span></span><br><span class="line">    CipherText = []</span><br><span class="line">    lenth = len(clearlist)</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    <span class="comment">#补位操作</span></span><br><span class="line">    <span class="keyword">if</span>(lenth%n == <span class="number">0</span>):</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        offset = n-lenth%n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):</span><br><span class="line">        clearlist.append(<span class="string">'A'</span>)</span><br><span class="line">    groups = int(len(clearlist)/n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clearlist)):</span><br><span class="line">        clearlist[i] = AtoN(clearlist[i])</span><br><span class="line">    <span class="comment">#生成M序列</span></span><br><span class="line">    M = np.ones((groups,n))</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(groups):</span><br><span class="line">        <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">            M[row][column] = clearlist[index]</span><br><span class="line">            index = index + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(groups):<span class="comment">#实现矩阵乘法和矩阵加法，A*M+Bmod(N)</span></span><br><span class="line">        tmp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        tmpp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#初始化Mi</span></span><br><span class="line">            tmp[row][<span class="number">0</span>] = M[i][row]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#实现A*M</span></span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">                tmpp[row][<span class="number">0</span>] = int(tmpp[row][<span class="number">0</span>] + (int(tmp[column][<span class="number">0</span>]) * int(A[row][column])))</span><br><span class="line">            tmpp[row][<span class="number">0</span>] = int((tmpp[row][<span class="number">0</span>]) % N)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#实现+</span></span><br><span class="line">            tmpp[row][<span class="number">0</span>] = (tmpp[row][<span class="number">0</span>] + B[row][<span class="number">0</span>]) % N</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            CipherText.append(NtoA(int(tmpp[row][<span class="number">0</span>])))</span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):<span class="comment">#消除补位影响</span></span><br><span class="line">            <span class="keyword">del</span> CipherText[<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> CipherText</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Decrypt</span><span class="params">(CipherText,A,B,n,N)</span>:</span><span class="comment">#解密函数</span></span><br><span class="line">    clearlist = []</span><br><span class="line">    lenth = len(CipherText)</span><br><span class="line">    flag = <span class="number">0</span></span><br><span class="line">    offset = <span class="number">0</span></span><br><span class="line">    <span class="comment"># 补位操作</span></span><br><span class="line">    <span class="keyword">if</span> (lenth % n == <span class="number">0</span>):</span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag = <span class="number">1</span></span><br><span class="line">        offset = n - lenth % n</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):</span><br><span class="line">        CipherText.append(<span class="string">'A'</span>)</span><br><span class="line">    groups = int(len(CipherText) / n)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(CipherText)):</span><br><span class="line">        CipherText[i] = AtoN(CipherText[i])</span><br><span class="line">    <span class="comment"># 生成M序列</span></span><br><span class="line">    M = np.zeros((groups, n))</span><br><span class="line">    index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(groups):</span><br><span class="line">        <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">            M[row][column] = CipherText[index]</span><br><span class="line">            index = index + <span class="number">1</span></span><br><span class="line">    <span class="comment">#求C-B</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(groups):<span class="comment">#实现矩阵乘法和矩阵加法，InA*(C-B)</span></span><br><span class="line">        tmp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        tmpp = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#初始化Mi</span></span><br><span class="line">            tmp[row][<span class="number">0</span>] = M[i][row]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):  <span class="comment"># 实现C-B</span></span><br><span class="line">            tmp[row][<span class="number">0</span>] = tmp[row][<span class="number">0</span>] - B[row][<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):<span class="comment">#实现InA*(C-B)mod(N)</span></span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">                tmpp[row][<span class="number">0</span>] = int(tmpp[row][<span class="number">0</span>] + (int(tmp[column][<span class="number">0</span>]) * int(A[row][column])))</span><br><span class="line">            tmpp[row][<span class="number">0</span>] = int((tmpp[row][<span class="number">0</span>]) % N)</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            clearlist.append(NtoA(int(tmpp[row][<span class="number">0</span>])))</span><br><span class="line">    <span class="keyword">if</span> flag == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(offset):<span class="comment">#消除补位影响</span></span><br><span class="line">            <span class="keyword">del</span> clearlist[<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">return</span> clearlist</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getIdentityMatrix</span><span class="params">(n)</span>:</span><span class="comment">#生成单位矩阵</span></span><br><span class="line">    A = np.zeros((n,n))</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">if</span> i == j:</span><br><span class="line">                A[i][j] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                A[i][j] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getInvertibleMatrix</span><span class="params">(n,m)</span>:</span><span class="comment">#生成可逆矩阵</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        A = getIdentityMatrix(n)</span><br><span class="line">        tempArray = np.zeros(n)</span><br><span class="line">        B = np.zeros((n,n))</span><br><span class="line">        transformTime = int(random.randint(<span class="number">0</span>,<span class="number">1000</span>))</span><br><span class="line">        maxint = sys.maxsize</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(transformTime):</span><br><span class="line">            mainRowNum = int((random.randint(<span class="number">0</span>,n) % (n - <span class="number">1</span>)))<span class="comment">#选择一个主行作初等行变换</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="comment">#元素数值是否会溢出</span></span><br><span class="line">                <span class="keyword">if</span> maxint - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &lt; <span class="number">0</span> <span class="keyword">and</span> maxint*(<span class="number">-1</span>) - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &gt; tempArray[k]:</span><br><span class="line">                    tempArray[k] = A[mainRowNum][k]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    tempArray[k] = (A[mainRowNum][k]*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))))%m</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(n):</span><br><span class="line">                <span class="keyword">if</span> mainRowNum != j:</span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> range(n):</span><br><span class="line">                        <span class="keyword">if</span> maxint - A[j][k]&lt; tempArray[k] <span class="keyword">and</span> maxint * (<span class="number">-1</span>) - (A[j][k]) &gt; tempArray[k]:</span><br><span class="line">                            A[j][k] = (A[j][k]/<span class="number">4</span>)%m</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            A[j][k] = (A[j][k] + tempArray[k])%m</span><br><span class="line">        <span class="keyword">if</span> gcd(np.linalg.det(A),m) == <span class="number">1</span> <span class="keyword">and</span> np.linalg.det(A) &gt; <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nnb</span><span class="params">()</span>:</span></span><br><span class="line">    messagebox.showinfo(<span class="string">"Succesfull"</span>, <span class="string">"File is in your computer!"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">newwind</span><span class="params">(n,m)</span>:</span></span><br><span class="line">    winNew = Toplevel(window)</span><br><span class="line">    winNew.geometry(<span class="string">'320x400'</span>)</span><br><span class="line">    winNew.title(<span class="string">'Random Key'</span>)</span><br><span class="line">    lb1 = tk.Label(winNew, text=<span class="string">'Random A Key'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    lb1.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    nt1 = tk.Text(winNew, height=<span class="number">8</span>, width=<span class="number">40</span>)</span><br><span class="line">    nt1.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    lb2 = tk.Label(winNew, text=<span class="string">'Random B Key'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    lb2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    nt2 = tk.Text(winNew, height=<span class="number">8</span>, width=<span class="number">40</span>)</span><br><span class="line">    nt2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    nb = tk.Button(winNew, text=<span class="string">'Save'</span>, font=(<span class="string">'Arial'</span>, <span class="number">12</span>), width=<span class="number">10</span>, height=<span class="number">1</span>, command=nnb)</span><br><span class="line">    nb.pack()</span><br><span class="line">    lb3 = tk.Label(winNew, text=<span class="string">'@FZU-IS-404 ZERO-A-ONE'</span>, font=(<span class="string">'Arial'</span>, <span class="number">10</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    lb3.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    B = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">    A = getInvertibleMatrix(n,m)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">        B[row] = int(random.randint(<span class="number">0</span>, <span class="number">26</span>))</span><br><span class="line">    At = open(<span class="string">'A_key.txt'</span>, <span class="string">'w'</span>)</span><br><span class="line">    Bt = open(<span class="string">'B_key.txt'</span>, <span class="string">'w'</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">        str1 = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> range(n):</span><br><span class="line">            str1 += str(int(A[row][line]))</span><br><span class="line">            str1 += <span class="string">' '</span></span><br><span class="line">        str1 += <span class="string">"\n"</span></span><br><span class="line">        At.write(str1)</span><br><span class="line">        nt1.insert(<span class="string">"%d.%d"</span> % (<span class="number">0</span>, int(row)),str1)</span><br><span class="line">    At.close()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">        str2 = <span class="string">""</span></span><br><span class="line">        str2 += str(int(A[row][<span class="number">0</span>]))</span><br><span class="line">        str2 += <span class="string">"\n"</span></span><br><span class="line">        Bt.write(str2)</span><br><span class="line">        nt2.insert(<span class="string">"%d.%d"</span> % (<span class="number">0</span>, int(row)), str2)</span><br><span class="line">    Bt.close()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">nb1</span><span class="params">()</span>:</span></span><br><span class="line">    fo = open(<span class="string">"text.txt"</span>, <span class="string">"r+"</span>)</span><br><span class="line">    str = fo.read()</span><br><span class="line">    tt2.insert(INSERT, str)</span><br><span class="line">    fo.close()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">buttonRK</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> e1.get() != <span class="string">""</span> <span class="keyword">and</span> e2.get() != <span class="string">""</span>:</span><br><span class="line">        n = int(e1.get())</span><br><span class="line">        m = int(e2.get())</span><br><span class="line">        newwind(n,m)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        messagebox.showinfo(<span class="string">"Error"</span>, <span class="string">"Please input n"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">n2wind</span><span class="params">(ans,n)</span>:</span></span><br><span class="line">    n2wind = Toplevel(window)</span><br><span class="line">    n2wind.geometry(<span class="string">'300x130'</span>)</span><br><span class="line">    n2wind.title(<span class="string">'Inverse Matrix'</span>)</span><br><span class="line">    n2nt2 = tk.Text(n2wind, height=<span class="number">8</span>, width=<span class="number">40</span>)</span><br><span class="line">    n2nt2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">        str1 = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> range(n):</span><br><span class="line">            str1 += str(int(ans[row][line]))</span><br><span class="line">            str1 += <span class="string">' '</span></span><br><span class="line">        str1 += <span class="string">"\n"</span></span><br><span class="line">        n2nt2.insert(<span class="string">"%d.%d"</span> % (<span class="number">0</span>, int(row)),str1)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Dewin</span><span class="params">()</span>:</span><span class="comment">#解密函数GUI</span></span><br><span class="line">    <span class="keyword">if</span> t1.get(<span class="string">"0.0"</span>,<span class="string">"end"</span>) != <span class="string">""</span> <span class="keyword">and</span> t2.get(<span class="string">"0.0"</span>,<span class="string">"end"</span>) != <span class="string">""</span> <span class="keyword">and</span> e1.get() != <span class="string">""</span> <span class="keyword">and</span> e2.get() != <span class="string">""</span>:</span><br><span class="line">        n = int(e1.get())</span><br><span class="line">        m = int(e2.get())</span><br><span class="line">        A = np.zeros((n, n))</span><br><span class="line">        B = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        InA = np.zeros((n, n))</span><br><span class="line">        Atex = t1.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        stringA = <span class="string">' '</span>.join(Atex.split())</span><br><span class="line">        listA = list(stringA.split(<span class="string">' '</span>))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">                A[row][column] = int(listA[index])</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        Btex = t2.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        stringB = <span class="string">' '</span>.join(Btex.split())</span><br><span class="line">        listB = list(stringB.split(<span class="string">' '</span>))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            B[row][<span class="number">0</span>] = int(listB[index])</span><br><span class="line">            index = index + <span class="number">1</span></span><br><span class="line">        clear = tt2.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        clear = list(clear)</span><br><span class="line">        InA = InverseMat(A, n, m, InA)</span><br><span class="line">        klist = np.zeros(len(clear))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">' '</span>:</span><br><span class="line">                klist[index] = int(i)</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        dlist = np.zeros(len(clear))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">                dlist[index] = int(i)</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">                clear[i] = <span class="string">' '</span></span><br><span class="line">        <span class="keyword">while</span> <span class="string">' '</span> <span class="keyword">in</span> clear:</span><br><span class="line">            clear.remove(<span class="string">' '</span>)</span><br><span class="line">        print(dlist)</span><br><span class="line">        print(klist)</span><br><span class="line">        clearlist = Decrypt(clear, InA, B, n, m)</span><br><span class="line">        print(clearlist)</span><br><span class="line">        clearlist = list(clearlist)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(klist)):</span><br><span class="line">            <span class="keyword">if</span> klist[i] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            ind = int(klist[i])</span><br><span class="line">            clearlist.insert(ind, <span class="string">" "</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(dlist)):</span><br><span class="line">            <span class="keyword">if</span> dlist[i] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            ind = int(dlist[i])</span><br><span class="line">            clearlist.insert(ind, <span class="string">","</span>)</span><br><span class="line">        str = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clearlist)):</span><br><span class="line">            str += clearlist[i]</span><br><span class="line">        t3.insert(INSERT, str)</span><br><span class="line">        n2wind(InA,n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        messagebox.showinfo(<span class="string">"Error"</span>, <span class="string">"Please input n,m,A key,B key"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Enwin</span><span class="params">()</span>:</span><span class="comment">#加密函数GUI</span></span><br><span class="line">    <span class="keyword">if</span> t1.get(<span class="string">"0.0"</span>,<span class="string">"end"</span>) != <span class="string">""</span> <span class="keyword">and</span> t2.get(<span class="string">"0.0"</span>,<span class="string">"end"</span>) != <span class="string">""</span> <span class="keyword">and</span> e1.get() != <span class="string">""</span> <span class="keyword">and</span> e2.get() != <span class="string">""</span>:</span><br><span class="line">        n = int(e1.get())</span><br><span class="line">        m = int(e2.get())</span><br><span class="line">        A = np.zeros((n, n))</span><br><span class="line">        B = np.zeros((n, <span class="number">1</span>))</span><br><span class="line">        Atex = t1.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        stringA = <span class="string">' '</span>.join(Atex.split())</span><br><span class="line">        listA = list(stringA.split(<span class="string">' '</span>))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            <span class="keyword">for</span> column <span class="keyword">in</span> range(n):</span><br><span class="line">                A[row][column] = int(listA[index])</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        print(A)</span><br><span class="line">        Btex = t2.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        stringB = <span class="string">' '</span>.join(Btex.split())</span><br><span class="line">        listB = list(stringB.split(<span class="string">' '</span>))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> range(n):</span><br><span class="line">            B[row][<span class="number">0</span>] = int(listB[index])</span><br><span class="line">            index = index + <span class="number">1</span></span><br><span class="line">        print(B)</span><br><span class="line">        clear = tt2.get(<span class="string">"1.0"</span>, <span class="string">"end"</span>)</span><br><span class="line">        clear = list(clear)</span><br><span class="line">        klist = np.zeros(len(clear))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">' '</span>:</span><br><span class="line">                klist[index] = int(i)</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        dlist = np.zeros(len(clear))</span><br><span class="line">        index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">                dlist[index] = int(i)</span><br><span class="line">                index = index + <span class="number">1</span></span><br><span class="line">        print(dlist)</span><br><span class="line">        print(klist)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(clear)):</span><br><span class="line">            <span class="keyword">if</span> clear[i] == <span class="string">','</span>:</span><br><span class="line">                clear[i] = <span class="string">' '</span></span><br><span class="line">        <span class="keyword">while</span> <span class="string">' '</span> <span class="keyword">in</span> clear:</span><br><span class="line">            clear.remove(<span class="string">' '</span>)</span><br><span class="line">        CipherText = Encrypt(clear,A,B,n,m)</span><br><span class="line">        print(CipherText)</span><br><span class="line">        CipherText = list(CipherText)</span><br><span class="line">        print(CipherText)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(klist)):</span><br><span class="line">            <span class="keyword">if</span> klist[i] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            ind = int(klist[i])</span><br><span class="line">            CipherText.insert(ind,<span class="string">" "</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(dlist)):</span><br><span class="line">            <span class="keyword">if</span> dlist[i] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            ind = int(dlist[i])</span><br><span class="line">            CipherText.insert(ind,<span class="string">","</span>)</span><br><span class="line">        str = <span class="string">""</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(CipherText)):</span><br><span class="line">            str += CipherText[i]</span><br><span class="line">        t3.insert(INSERT,str)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        messagebox.showinfo(<span class="string">"Error"</span>, <span class="string">"Please input n,m,A key,B key"</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#主窗口</span></span><br><span class="line">    window = tk.Tk()</span><br><span class="line">    window.title(<span class="string">'Multi-table'</span>)</span><br><span class="line">    window.geometry(<span class="string">'300x950'</span>)</span><br><span class="line">    <span class="comment">#随机密钥</span></span><br><span class="line">    b = tk.Button(window, text=<span class="string">'Random Key'</span>, font=(<span class="string">'Arial'</span>, <span class="number">12</span>), width=<span class="number">10</span>, height=<span class="number">1</span>,command=buttonRK)</span><br><span class="line">    b.pack()</span><br><span class="line">    <span class="comment"># 2标签</span></span><br><span class="line">    l2 = tk.Label(window, text=<span class="string">'Please input n'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    l2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># 输入框控件entry</span></span><br><span class="line">    e1 = tk.Entry(window, show=<span class="literal">None</span>, width=<span class="number">8</span>,justify = <span class="string">'center'</span>)  <span class="comment"># 显示成明文形式</span></span><br><span class="line">    e1.pack()</span><br><span class="line">    <span class="comment"># 3标签</span></span><br><span class="line">    l3 = tk.Label(window, text=<span class="string">'Please input M'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    l3.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># 输入框控件entry</span></span><br><span class="line">    e2 = tk.Entry(window, show=<span class="literal">None</span>, width=<span class="number">8</span>, justify=<span class="string">'center'</span>)  <span class="comment"># 显示成明文形式</span></span><br><span class="line">    e2.pack()</span><br><span class="line">    <span class="comment">#4标签</span></span><br><span class="line">    l4 = tk.Label(window, text=<span class="string">'A Key'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    l4.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment">#Text</span></span><br><span class="line">    t1 = tk.Text(window, height=<span class="number">8</span>,width = <span class="number">40</span>)</span><br><span class="line">    t1.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment">#5标签</span></span><br><span class="line">    l5 = tk.Label(window, text=<span class="string">'B Key'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    l5.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># Text</span></span><br><span class="line">    t2 = tk.Text(window, height=<span class="number">8</span>, width=<span class="number">40</span>)</span><br><span class="line">    t2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># 5标签</span></span><br><span class="line">    ll5 = tk.Label(window, text=<span class="string">'Text'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">20</span>, height=<span class="number">2</span>)</span><br><span class="line">    ll5.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># Text</span></span><br><span class="line">    tt2 = tk.Text(window, height=<span class="number">8</span>, width=<span class="number">20</span>)</span><br><span class="line">    tt2.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    b1 = tk.Button(window, text=<span class="string">'File'</span>, font=(<span class="string">'Arial'</span>, <span class="number">12</span>), width=<span class="number">10</span>, height=<span class="number">1</span>, command=nb1)</span><br><span class="line">    b1.pack()</span><br><span class="line">    <span class="comment"># 加密</span></span><br><span class="line">    De = tk.Button(window, text=<span class="string">'Decrypt'</span>, font=(<span class="string">'Arial'</span>, <span class="number">12</span>), width=<span class="number">10</span>, height=<span class="number">1</span>,command=Dewin)</span><br><span class="line">    De.pack()</span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    En = tk.Button(window, text=<span class="string">'Encrypt'</span>, font=(<span class="string">'Arial'</span>, <span class="number">12</span>), width=<span class="number">10</span>, height=<span class="number">1</span>,command=Enwin)</span><br><span class="line">    En.pack()</span><br><span class="line">    <span class="comment"># 6标签</span></span><br><span class="line">    l6 = tk.Label(window, text=<span class="string">'SOLUTION'</span>, font=(<span class="string">'Arial'</span>, <span class="number">16</span>), width=<span class="number">20</span>, height=<span class="number">2</span>)</span><br><span class="line">    l6.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># Text</span></span><br><span class="line">    t3 = tk.Text(window, height=<span class="number">8</span>, width=<span class="number">20</span>)</span><br><span class="line">    t3.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    <span class="comment"># 8标签</span></span><br><span class="line">    l8 = tk.Label(window, text=<span class="string">'@FZU-IS-404 ZERO-A-ONE'</span>, font=(<span class="string">'Arial'</span>, <span class="number">10</span>), width=<span class="number">40</span>, height=<span class="number">2</span>)</span><br><span class="line">    l8.pack(fill=<span class="string">'x'</span>)</span><br><span class="line">    window.mainloop()</span><br></pre></td></tr></table></figure>

<h2 id="重要的实现细节"><a href="#重要的实现细节" class="headerlink" title="重要的实现细节"></a>重要的实现细节</h2><h4 id="GUI界面的实现"><a href="#GUI界面的实现" class="headerlink" title="GUI界面的实现"></a>GUI界面的实现</h4><p>GUI界面的实现极大的方便了使用者的使用体验，降低了使用门槛，使得本程序的实用化程度大大提升</p>
<h4 id="三目运算符的使用"><a href="#三目运算符的使用" class="headerlink" title="三目运算符的使用"></a>三目运算符的使用</h4><p>在求A的伴随矩阵时，使用了三目运算符，简化了程序，使思路更清晰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">temp[k][t] = arcs[(k+<span class="number">1</span> <span class="keyword">if</span> k&gt;=i <span class="keyword">else</span> k)][(t+<span class="number">1</span> <span class="keyword">if</span> t&gt;=j <span class="keyword">else</span> t)]</span><br></pre></td></tr></table></figure>

<h4 id="随机生成在模下可逆矩阵"><a href="#随机生成在模下可逆矩阵" class="headerlink" title="随机生成在模下可逆矩阵"></a>随机生成在模下可逆矩阵</h4><p>通过模拟初等变换实现的可逆矩阵，更重要的是保证了矩阵A的行列式与所定模N互素。且在随机化的过程中，通过判断保证了数据不会溢出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> maxint - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &lt; <span class="number">0</span> <span class="keyword">and</span> maxint*(<span class="number">-1</span>) - (A[mainRowNum][k])*(int(random.randint(<span class="number">0</span>,<span class="number">10</span>))) &gt; tempArray[k]:</span><br></pre></td></tr></table></figure>

<p>`</p>
<h2 id="实现效果"><a href="#实现效果" class="headerlink" title="实现效果"></a>实现效果</h2><h3 id="主界面"><a href="#主界面" class="headerlink" title="主界面"></a>主界面</h3><p><img src="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%B8%BB%E7%95%8C%E9%9D%A2.png" alt></p>
<h3 id="随机矩阵生成"><a href="#随机矩阵生成" class="headerlink" title="随机矩阵生成"></a>随机矩阵生成</h3><p><img src="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E7%9F%A9%E9%98%B5.png" alt></p>
<h3 id="逆矩阵-2"><a href="#逆矩阵-2" class="headerlink" title="逆矩阵"></a>逆矩阵</h3><p><img src="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E9%80%86%E7%9F%A9%E9%98%B5.png" alt></p>
<h3 id="例题加密"><a href="#例题加密" class="headerlink" title="例题加密"></a>例题加密</h3><p><img src="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%BE%8B%E9%A2%98%E5%8A%A0%E5%AF%86.png" alt></p>
<h3 id="例题解密"><a href="#例题解密" class="headerlink" title="例题解密"></a>例题解密</h3><p><img src="https://github-1251836300.cos.ap-guangzhou.myqcloud.com/%E7%8E%B0%E4%BB%A3%E5%AF%86%E7%A0%81%E5%AD%A6%E2%80%94%E2%80%94%E5%A4%9A%E8%A1%A8%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/%E4%BE%8B%E9%A2%98%E8%A7%A3%E5%AF%86.png" alt></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>多表代换密码为古典密码学中一种较为经典的加密方式，对于多表替换加密来说，加密后的字母几乎不再保持原来的频率，对于词频和字频分析有了一定的抵抗能力</p>
<p>本人的系统有如下亮点：</p>
<ul>
<li>实现了全部的GUI可视化操作</li>
<li>实现了对长度不是n的倍数的明文的处理，能够对长度不是n的倍数的明文进行加密解密</li>
<li>实现了对空格和标点符号的处理。要求解密时能还原空格和标点符号</li>
<li>实现了对文件的读写操作</li>
<li>实现了调用系统API实现错误弹窗功能</li>
</ul>

    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2019/09/05/4th-QCTF-2018-stack2/" rel="next" title="4th-QCTF-2018-stack2">
                  <i class="fa fa-chevron-left"></i> 4th-QCTF-2018-stack2
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2019/09/09/X86║═X87╗π▒α╓╕┴ε┤≤╚½/" rel="prev" title="X86和X87汇编指令大全">
                  X86和X87汇编指令大全 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#实验要求"><span class="nav-number">1.</span> <span class="nav-text">实验要求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实验原理"><span class="nav-number">2.</span> <span class="nav-text">实验原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#软件系统设计"><span class="nav-number">3.</span> <span class="nav-text">软件系统设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#随机生成矩阵"><span class="nav-number">3.1.</span> <span class="nav-text">随机生成矩阵</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#可逆矩阵A"><span class="nav-number">3.1.1.</span> <span class="nav-text">可逆矩阵A</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#生成单位矩阵"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">生成单位矩阵</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#生成随机可逆矩阵A"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">生成随机可逆矩阵A</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#矩阵B"><span class="nav-number">3.1.2.</span> <span class="nav-text">矩阵B</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#明文分组加密"><span class="nav-number">3.2.</span> <span class="nav-text">明文分组加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#预处理"><span class="nav-number">3.2.1.</span> <span class="nav-text">预处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#记录空格和符号"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">记录空格和符号</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#字符串初始化转换为纯字母序列"><span class="nav-number">3.2.1.2.</span> <span class="nav-text">字符串初始化转换为纯字母序列</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#补位操作"><span class="nav-number">3.2.2.</span> <span class="nav-text">补位操作</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生成M序列"><span class="nav-number">3.2.3.</span> <span class="nav-text">生成M序列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分组加密"><span class="nav-number">3.2.4.</span> <span class="nav-text">分组加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#消除补位影响"><span class="nav-number">3.2.5.</span> <span class="nav-text">消除补位影响</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逆矩阵"><span class="nav-number">3.3.</span> <span class="nav-text">逆矩阵</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#逆元"><span class="nav-number">3.3.0.1.</span> <span class="nav-text">逆元</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#行列式"><span class="nav-number">3.3.0.2.</span> <span class="nav-text">行列式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#伴随矩阵"><span class="nav-number">3.3.0.3.</span> <span class="nav-text">伴随矩阵</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#逆矩阵-1"><span class="nav-number">3.3.0.4.</span> <span class="nav-text">逆矩阵</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#密文分组解密"><span class="nav-number">3.4.</span> <span class="nav-text">密文分组解密</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#补位操作-1"><span class="nav-number">3.4.0.1.</span> <span class="nav-text">补位操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#生成M序列-1"><span class="nav-number">3.4.0.2.</span> <span class="nav-text">生成M序列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#分组解密"><span class="nav-number">3.4.0.3.</span> <span class="nav-text">分组解密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#消除补位影响-1"><span class="nav-number">3.4.0.4.</span> <span class="nav-text">消除补位影响</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GUI图形界面最终实现"><span class="nav-number">3.5.</span> <span class="nav-text">GUI图形界面最终实现</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#重要的实现细节"><span class="nav-number">4.</span> <span class="nav-text">重要的实现细节</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#GUI界面的实现"><span class="nav-number">4.0.1.</span> <span class="nav-text">GUI界面的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#三目运算符的使用"><span class="nav-number">4.0.2.</span> <span class="nav-text">三目运算符的使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#随机生成在模下可逆矩阵"><span class="nav-number">4.0.3.</span> <span class="nav-text">随机生成在模下可逆矩阵</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实现效果"><span class="nav-number">5.</span> <span class="nav-text">实现效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#主界面"><span class="nav-number">5.1.</span> <span class="nav-text">主界面</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#随机矩阵生成"><span class="nav-number">5.2.</span> <span class="nav-text">随机矩阵生成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逆矩阵-2"><span class="nav-number">5.3.</span> <span class="nav-text">逆矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#例题加密"><span class="nav-number">5.4.</span> <span class="nav-text">例题加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#例题解密"><span class="nav-number">5.5.</span> <span class="nav-text">例题解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">6.</span> <span class="nav-text">总结</span></a></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZERO-A-ONE</p>
  <div class="site-description" itemprop="description">Resit much,Obey little</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZERO-A-ONE</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  

</body>
</html>
