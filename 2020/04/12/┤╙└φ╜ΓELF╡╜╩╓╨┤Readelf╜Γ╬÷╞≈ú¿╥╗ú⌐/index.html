<!DOCTYPE html>





<html lang="">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.4.0">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.4.0">
  <link rel="mask-icon" href="/images/logo.svg?v=7.4.0" color="#222">
  <link rel="alternate" href="/atom.xml" title="ZERO-A-ONE" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css?v=7.4.0">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.4.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'Copy',
      copy_success: 'Copied',
      copy_failure: 'Copy failed'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="（本文所有代码均基于Go语言，ELF文件为32位） 前言本人普通大二学生水平有限，可能错误许多的，还希望大佬们能帮指证修改 项目地址：https://github.com/suyucheng-lz/ELF32_Read 目前实现的效果readelf的解析数据：1234567891011121314151617181920212223242526272829303132333435363738394">
<meta property="og:type" content="article">
<meta property="og:title" content="从理解ELF到手写Readelf解析器（一）">
<meta property="og:url" content="http://yoursite.com/2020/04/12/┤╙└φ╜ΓELF╡╜╩╓╨┤Readelf╜Γ╬÷╞≈ú¿╥╗ú⌐/index.html">
<meta property="og:site_name" content="ZERO-A-ONE">
<meta property="og:description" content="（本文所有代码均基于Go语言，ELF文件为32位） 前言本人普通大二学生水平有限，可能错误许多的，还希望大佬们能帮指证修改 项目地址：https://github.com/suyucheng-lz/ELF32_Read 目前实现的效果readelf的解析数据：1234567891011121314151617181920212223242526272829303132333435363738394">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2020-04-13T02:38:18.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="从理解ELF到手写Readelf解析器（一）">
<meta name="twitter:description" content="（本文所有代码均基于Go语言，ELF文件为32位） 前言本人普通大二学生水平有限，可能错误许多的，还希望大佬们能帮指证修改 项目地址：https://github.com/suyucheng-lz/ELF32_Read 目前实现的效果readelf的解析数据：1234567891011121314151617181920212223242526272829303132333435363738394">
  <link rel="canonical" href="http://yoursite.com/2020/04/12/┤╙└φ╜ΓELF╡╜╩╓╨┤Readelf╜Γ╬÷╞≈ú¿╥╗ú⌐/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>从理解ELF到手写Readelf解析器（一） | ZERO-A-ONE</title>
  








  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">
  <div class="container use-motion">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZERO-A-ONE</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
      
      
      
        
        <li class="menu-item menu-item-home">
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
      
      
      
        
        <li class="menu-item menu-item-archives">
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a href="javascript:;" class="popup-trigger">
        
          <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
      </li>
    
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
            

          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
     <article itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block post">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/12/┤╙└φ╜ΓELF╡╜╩╓╨┤Readelf╜Γ╬÷╞≈ú¿╥╗ú⌐/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZERO-A-ONE">
      <meta itemprop="description" content="Resit much,Obey little">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZERO-A-ONE">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">从理解ELF到手写Readelf解析器（一）

          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              
                
              

              <time title="Created: 2020-04-12 04:36:31 / Modified: 19:38:18" itemprop="dateCreated datePublished" datetime="2020-04-12T04:36:31-07:00">2020-04-12</time>
            </span>
          
            

            
          

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>（本文所有代码均基于Go语言，ELF文件为32位）</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本人普通大二学生水平有限，可能错误许多的，还希望大佬们能帮指证修改</p>
<p>项目地址：<a href="https://github.com/suyucheng-lz/ELF32_Read" target="_blank" rel="noopener">https://github.com/suyucheng-lz/ELF32_Read</a></p>
<h2 id="目前实现的效果"><a href="#目前实现的效果" class="headerlink" title="目前实现的效果"></a>目前实现的效果</h2><h3 id="readelf的解析数据："><a href="#readelf的解析数据：" class="headerlink" title="readelf的解析数据："></a>readelf的解析数据：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">syc@ubuntu:~/Desktop/share$ readelf -h hello</span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 </span><br><span class="line">  Class:                             ELF32</span><br><span class="line">  Data:                              2&apos;s complement, little endian</span><br><span class="line">  Version:                           1 (current)</span><br><span class="line">  OS/ABI:                            UNIX - System V</span><br><span class="line">  ABI Version:                       0</span><br><span class="line">  Type:                              EXEC (Executable file)</span><br><span class="line">  Machine:                           Intel 80386</span><br><span class="line">  Version:                           0x1</span><br><span class="line">  Entry point address:               0x8048310</span><br><span class="line">  Start of program headers:          52 (bytes into file)</span><br><span class="line">  Start of section headers:          6112 (bytes into file)</span><br><span class="line">  Flags:                             0x0</span><br><span class="line">  Size of this header:               52 (bytes)</span><br><span class="line">  Size of program headers:           32 (bytes)</span><br><span class="line">  Number of program headers:         9</span><br><span class="line">  Size of section headers:           40 (bytes)</span><br><span class="line">  Number of section headers:         31</span><br><span class="line">  Section header string table index: 28</span><br><span class="line">  </span><br><span class="line">Elf file type is EXEC (Executable file)</span><br><span class="line">Entry point 0x8048310</span><br><span class="line">There are 9 program headers, starting at offset 52</span><br><span class="line"></span><br><span class="line">Program Headers:</span><br><span class="line">  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align</span><br><span class="line">  PHDR           0x000034 0x08048034 0x08048034 0x00120 0x00120 R E 0x4</span><br><span class="line">  INTERP         0x000154 0x08048154 0x08048154 0x00013 0x00013 R   0x1</span><br><span class="line">      [Requesting program interpreter: /lib/ld-linux.so.2]</span><br><span class="line">  LOAD           0x000000 0x08048000 0x08048000 0x005c8 0x005c8 R E 0x1000</span><br><span class="line">  LOAD           0x000f08 0x08049f08 0x08049f08 0x00114 0x00118 RW  0x1000</span><br><span class="line">  DYNAMIC        0x000f14 0x08049f14 0x08049f14 0x000e8 0x000e8 RW  0x4</span><br><span class="line">  NOTE           0x000168 0x08048168 0x08048168 0x00044 0x00044 R   0x4</span><br><span class="line">  GNU_EH_FRAME   0x0004d0 0x080484d0 0x080484d0 0x0002c 0x0002c R   0x4</span><br><span class="line">  GNU_STACK      0x000000 0x00000000 0x00000000 0x00000 0x00000 RW  0x10</span><br><span class="line">  GNU_RELRO      0x000f08 0x08049f08 0x08049f08 0x000f8 0x000f8 R   0x1</span><br><span class="line">  </span><br><span class="line">There are 31 section headers, starting at offset 0x17e0:</span><br><span class="line"></span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0]                   NULL            00000000 000000 000000 00      0   0  0</span><br><span class="line">  [ 1] .interp           PROGBITS        08048154 000154 000013 00   A  0   0  1</span><br><span class="line">  [ 2] .note.ABI-tag     NOTE            08048168 000168 000020 00   A  0   0  4</span><br><span class="line">  [ 3] .note.gnu.build-i NOTE            08048188 000188 000024 00   A  0   0  4</span><br><span class="line">  [ 4] .gnu.hash         GNU_HASH        080481ac 0001ac 000020 04   A  5   0  4</span><br><span class="line">  [ 5] .dynsym           DYNSYM          080481cc 0001cc 000050 10   A  6   1  4</span><br><span class="line">  [ 6] .dynstr           STRTAB          0804821c 00021c 00004c 00   A  0   0  1</span><br><span class="line">  [ 7] .gnu.version      VERSYM          08048268 000268 00000a 02   A  5   0  2</span><br><span class="line">  [ 8] .gnu.version_r    VERNEED         08048274 000274 000020 00   A  6   1  4</span><br><span class="line">  [ 9] .rel.dyn          REL             08048294 000294 000008 08   A  5   0  4</span><br><span class="line">  [10] .rel.plt          REL             0804829c 00029c 000010 08  AI  5  24  4</span><br><span class="line">  [11] .init             PROGBITS        080482ac 0002ac 000023 00  AX  0   0  4</span><br><span class="line">  [12] .plt              PROGBITS        080482d0 0002d0 000030 04  AX  0   0 16</span><br><span class="line">  [13] .plt.got          PROGBITS        08048300 000300 000008 00  AX  0   0  8</span><br><span class="line">  [14] .text             PROGBITS        08048310 000310 000192 00  AX  0   0 16</span><br><span class="line">  [15] .fini             PROGBITS        080484a4 0004a4 000014 00  AX  0   0  4</span><br><span class="line">  [16] .rodata           PROGBITS        080484b8 0004b8 000015 00   A  0   0  4</span><br><span class="line">  [17] .eh_frame_hdr     PROGBITS        080484d0 0004d0 00002c 00   A  0   0  4</span><br><span class="line">  [18] .eh_frame         PROGBITS        080484fc 0004fc 0000cc 00   A  0   0  4</span><br><span class="line">  [19] .init_array       INIT_ARRAY      08049f08 000f08 000004 00  WA  0   0  4</span><br><span class="line">  [20] .fini_array       FINI_ARRAY      08049f0c 000f0c 000004 00  WA  0   0  4</span><br><span class="line">  [21] .jcr              PROGBITS        08049f10 000f10 000004 00  WA  0   0  4</span><br><span class="line">  [22] .dynamic          DYNAMIC         08049f14 000f14 0000e8 08  WA  6   0  4</span><br><span class="line">  [23] .got              PROGBITS        08049ffc 000ffc 000004 04  WA  0   0  4</span><br><span class="line">  [24] .got.plt          PROGBITS        0804a000 001000 000014 04  WA  0   0  4</span><br><span class="line">  [25] .data             PROGBITS        0804a014 001014 000008 00  WA  0   0  4</span><br><span class="line">  [26] .bss              NOBITS          0804a01c 00101c 000004 00  WA  0   0  1</span><br><span class="line">  [27] .comment          PROGBITS        00000000 00101c 000035 01  MS  0   0  1</span><br><span class="line">  [28] .shstrtab         STRTAB          00000000 0016d3 00010a 00      0   0  1</span><br><span class="line">  [29] .symtab           SYMTAB          00000000 001054 000450 10     30  47  4</span><br><span class="line">  [30] .strtab           STRTAB          00000000 0014a4 00022f 00      0   0  1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings)</span><br><span class="line">  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)</span><br><span class="line">  O (extra OS processing required) o (OS specific), p (processor specific)</span><br></pre></td></tr></table></figure>

<p>我实现的效果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">There are 31 section headers, starting at offset 0x17e0:</span><br><span class="line"></span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0]                   NULL            00000000 000000 000000 00      0   0  0</span><br><span class="line">  [ 1] .interp           PROGBITS        08048154 000154 000013 00   A  0   0  1</span><br><span class="line">  [ 2] .note.ABI-tag     NOTE            08048168 000168 000020 00   A  0   0  4</span><br><span class="line">  [ 3] .note.gnu.build-i NOTE            08048188 000188 000024 00   A  0   0  4</span><br><span class="line">  [ 4] .gnu.hash         GNU_HASH        080481ac 0001ac 000020 04   A  5   0  4</span><br><span class="line">  [ 5] .dynsym           DYNSYM          080481cc 0001cc 000050 10   A  6   1  4</span><br><span class="line">  [ 6] .dynstr           STRTAB          0804821c 00021c 00004c 00   A  0   0  1</span><br><span class="line">  [ 7] .gnu.version      VERSYM          08048268 000268 00000a 02   A  5   0  2</span><br><span class="line">  [ 8] .gnu.version_r    VERNEED         08048274 000274 000020 00   A  6   1  4</span><br><span class="line">  [ 9] .rel.dyn          REL             08048294 000294 000008 08   A  5   0  4</span><br><span class="line">  [10] .rel.plt          REL             0804829c 00029c 000010 08  AI  5  24  4</span><br><span class="line">  [11] .init             PROGBITS        080482ac 0002ac 000023 00  AX  0   0  4</span><br><span class="line">  [12] .plt              PROGBITS        080482d0 0002d0 000030 04  AX  0   0 16</span><br><span class="line">  [13] .plt.got          PROGBITS        08048300 000300 000008 00  AX  0   0  8</span><br><span class="line">  [14] .text             PROGBITS        08048310 000310 000192 00  AX  0   0 16</span><br><span class="line">  [15] .fini             PROGBITS        080484a4 0004a4 000014 00  AX  0   0  4</span><br><span class="line">  [16] .rodata           PROGBITS        080484b8 0004b8 000015 00   A  0   0  4</span><br><span class="line">  [17] .eh_frame_hdr     PROGBITS        080484d0 0004d0 00002c 00   A  0   0  4</span><br><span class="line">  [18] .eh_frame         PROGBITS        080484fc 0004fc 0000cc 00   A  0   0  4</span><br><span class="line">  [19] .init_array       INIT_ARRAY      08049f08 000f08 000004 00  WA  0   0  4</span><br><span class="line">  [20] .fini_array       FINI_ARRAY      08049f0c 000f0c 000004 00  WA  0   0  4</span><br><span class="line">  [21] .jcr              PROGBITS        08049f10 000f10 000004 00  WA  0   0  4</span><br><span class="line">  [22] .dynamic          DYNAMIC         08049f14 000f14 0000e8 08  WA  6   0  4</span><br><span class="line">  [23] .got              PROGBITS        08049ffc 000ffc 000004 04  WA  0   0  4</span><br><span class="line">  [24] .got.plt          PROGBITS        0804a000 001000 000014 04  WA  0   0  4</span><br><span class="line">  [25] .data             PROGBITS        0804a014 001014 000008 00  WA  0   0  4</span><br><span class="line">  [26] .bss              NOBITS          0804a01c 00101c 000004 00  WA  0   0  1</span><br><span class="line">  [27] .comment          PROGBITS        00000000 00101c 000035 01  MS  0   0  1</span><br><span class="line">  [28] .shstrtab         STRTAB          00000000 0016d3 00010a 00      0   0  1</span><br><span class="line">  [29] .symtab           SYMTAB          00000000 001054 000450 10     30  47  4</span><br><span class="line">  [30] .strtab           STRTAB          00000000 0014a4 00022f 00      0   0  1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings)</span><br><span class="line">  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)</span><br><span class="line">  O (extra OS processing required) o (OS specific), p (processor specific)</span><br></pre></td></tr></table></figure>

<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>首先在解析之前， 必须对数据类型格式声明一下</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">大小（byte）</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Elf32_Addr</td>
<td align="center">4</td>
<td align="center">无符号程序地址</td>
</tr>
<tr>
<td align="center">Elf32_Half</td>
<td align="center">2</td>
<td align="center">无符号中等整数</td>
</tr>
<tr>
<td align="center">Elf32_Off</td>
<td align="center">4</td>
<td align="center">无符号文件偏移</td>
</tr>
<tr>
<td align="center">Elf32_SWord</td>
<td align="center">4</td>
<td align="center">有符号大整数</td>
</tr>
<tr>
<td align="center">Elf32_Word</td>
<td align="center">4</td>
<td align="center">无符号大整数</td>
</tr>
<tr>
<td align="center">unsigned char</td>
<td align="center">1</td>
<td align="center">无符号笑整数</td>
</tr>
</tbody></table>
<p>我在Go语言里面如此定义：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> EI_NIDENT = <span class="number">16</span></span><br><span class="line"><span class="keyword">type</span> Elf32_Addr = <span class="keyword">uint32</span>	<span class="comment">//4个字节</span></span><br><span class="line"><span class="keyword">type</span> Elf32_Half = <span class="keyword">uint16</span>	<span class="comment">//2个字节</span></span><br><span class="line"><span class="keyword">type</span> Elf32_Off = <span class="keyword">uint32</span>		<span class="comment">//4个字节</span></span><br><span class="line"><span class="keyword">type</span> Elf32_SWord = <span class="keyword">int32</span>	<span class="comment">//4个字节</span></span><br><span class="line"><span class="keyword">type</span> Elf32_Word = <span class="keyword">uint32</span>	<span class="comment">//4个字节</span></span><br><span class="line"><span class="keyword">type</span> u_char = <span class="keyword">byte</span>	<span class="comment">//1个字节（uint8)</span></span><br></pre></td></tr></table></figure>

<p>一个ELF文件可以被标记为一下几种类型：</p>
<ul>
<li>ET_NONE：未知类型。这个标记表明文件类型不确定，或者还未定义</li>
<li>ET_REL：重定位文件。ELF类型标记为relocatable意味着该文件被标记为了一段可重定位的代码，有时也称为目标文件。可重定位目标文件通常是还未被链接到可执行程序的一段位置独立的代码（position independent code）。在编译完代码之后通常可以看到一个.o格式的文件，这种文件包含了创建可执行文件所需要的代码和数据</li>
<li>ET_EXEC：可执行文件。ELF类型为executable，表明这个文件被标记为可执行文件。这种类型的文件也称为程序，是一个进程开始执行的入口</li>
<li>ET_DYN：共享目标文件。ELF类型为dynamic，意味着该文件被标记为了一个动态的可链接的目标文件，也称为共享库。这类共享库会在程序运行时被装载并链接到程序的进程镜像中</li>
<li>ET_CORE：核心文件。在程序崩溃或者进程传递了一个SIGSEGV信号（分段违规）时，会在核心文件中记录整个进程的镜像信息。可以使用GDB读取这类文件来辅助调试并查找程序崩溃的原因</li>
</ul>
<p>对于一个ELF文件主要由以下这几个部分组成：</p>
<ul>
<li><p>ELF Header：<strong>ELF头部</strong>。每个ELF文件都必须存在一个ELF_Header,这里存放了很多重要的信息用来描述整个文件的组织,如: 版本信息,入口信息,偏移信息等。程序执行也必须依靠其提供的信息</p>
</li>
<li><p>Program Header Table：<strong>程序头部表。</strong>可选的一个表，用于告诉系统如何在内存中创建映像,在图中也可以看出来,有程序头部表才有段,有段就必须有程序头部表。其中存放各个段的基本信息(包括地址指针)</p>
</li>
<li><p>Section Header Table：<strong>节区头部表</strong>。类似与Program_Header_Table,但与其相对应的是节区(Section)</p>
</li>
<li><p>Section：<strong>节区</strong>。将文件分成一个个节区，每个节区都有其对应的功能，如符号表，哈希表等</p>
</li>
<li><p>Segment：<strong>段</strong>。就是将文件分成一段一段映射到内存中。段中通常包括一个或多个节区</p>
</li>
</ul>
<blockquote>
<p>每个节区都应该是前后相连的，且不可有重叠。即在一个地址上的字节只能属于一个节区</p>
</blockquote>
<h2 id="ELF-Header"><a href="#ELF-Header" class="headerlink" title="ELF Header"></a>ELF Header</h2><h3 id="概述-1"><a href="#概述-1" class="headerlink" title="概述"></a>概述</h3><p>首先我们得先熟悉并且理解ELF Header的结构体定义开始：</p>
<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">类型</th>
</tr>
</thead>
<tbody><tr>
<td align="center">e_ident[EI_NIDENT]</td>
<td align="center">unsigned char</td>
</tr>
<tr>
<td align="center">e_type</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_machine</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_version</td>
<td align="center">Elf32_Word</td>
</tr>
<tr>
<td align="center">e_entry</td>
<td align="center">Elf32_Addr</td>
</tr>
<tr>
<td align="center">e_phoff</td>
<td align="center">Elf32_Off</td>
</tr>
<tr>
<td align="center">e_shoff</td>
<td align="center">Elf32_Off</td>
</tr>
<tr>
<td align="center">e_flags</td>
<td align="center">Elf32_Word</td>
</tr>
<tr>
<td align="center">e_ehsize</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_phentsize</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_phnum</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_shentsize</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_shnum</td>
<td align="center">Elf32_Half</td>
</tr>
<tr>
<td align="center">e_shstrndx</td>
<td align="center">Elf32_Half</td>
</tr>
</tbody></table>
<p>最后程序中的样子，对于e_ident我做一了点修改为了方便后续程序编写：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Elf32_Ehdr <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//e_ident [EI_NIDENT]u_char</span></span><br><span class="line">	Ehdr_Magic <span class="keyword">string</span></span><br><span class="line">	Ehdr_Class <span class="keyword">int</span></span><br><span class="line">	Ehdr_Data <span class="keyword">int</span></span><br><span class="line">	Ehdr_Version <span class="keyword">int</span></span><br><span class="line">	Ehdr_OS <span class="keyword">int</span></span><br><span class="line">	Ehdr_ABIV <span class="keyword">int</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	e_ident 这是一个数组,其每个字节又都有所代表的含义</span></span><br><span class="line"><span class="comment">	EI_MAG0 - EI_MAG3 文件标识就是平时所说的ELF头</span></span><br><span class="line"><span class="comment">	EI_CLASS 文件类,其实代表的是32位/64位程序</span></span><br><span class="line"><span class="comment">	EI_DATA 数据编码,一般都是01[td]</span></span><br><span class="line"><span class="comment">	EI_VERSION 文件版本,固定值01 EV_CURRENT</span></span><br><span class="line"><span class="comment">	EI_PAD 呃…就是一堆全是00的用来补全大小的数组</span></span><br><span class="line"><span class="comment">	EI_NIDENT 说是e_ident数组的大小,但我看了好几个so都是00</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	e_type Elf32_Half</span><br><span class="line">	<span class="comment">//标识文件类型</span></span><br><span class="line">	e_machine Elf32_Half</span><br><span class="line">	<span class="comment">//声明ABI</span></span><br><span class="line">	e_version Elf32_Word</span><br><span class="line">	<span class="comment">//跟ident[]里的EI_VERSION一样,为01</span></span><br><span class="line">	e_entry Elf32_Addr</span><br><span class="line">	<span class="comment">//可执行程序入口点地址</span></span><br><span class="line">	e_phoff Elf32_Off</span><br><span class="line">	<span class="comment">//Program Header Offset,程序头部表索引地址,没有则为0</span></span><br><span class="line">	e_shoff Elf32_Off</span><br><span class="line">	<span class="comment">//Section Header Offset,节区表索引地址,没有则为0</span></span><br><span class="line">	e_flags Elf32_Word</span><br><span class="line">	<span class="comment">//保存与文件相关的，特定于处理器的标志。</span></span><br><span class="line">	e_ehsize Elf32_Half</span><br><span class="line">	<span class="comment">//ELF_Header Size,ELF头部的大小</span></span><br><span class="line">	e_phentsize Elf32_Half</span><br><span class="line">	<span class="comment">//程序头部表的单个表项的大小</span></span><br><span class="line">	e_phnum Elf32_Half</span><br><span class="line">	<span class="comment">//程序头部表的表项数</span></span><br><span class="line">	e_shentsize Elf32_Half</span><br><span class="line">	<span class="comment">//节区表的单个表项的大小</span></span><br><span class="line">	e_shnum Elf32_Half</span><br><span class="line">	<span class="comment">//节区表的表项数</span></span><br><span class="line">	e_shstrndx Elf32_Half</span><br><span class="line">	<span class="comment">//String Table Index,在节区表中有一个存储各节区名称的节区,这里表示名称表在第几个节区。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面开始逐步解释各个字段</p>
<h4 id="e-ident"><a href="#e-ident" class="headerlink" title="e_ident"></a>e_ident</h4><p><strong>目标文件标识</strong>。详细描述该二进制文件对应的体系结构，其每个字节又都有所代表的含义，包括对应的字长，CPU架构，大小端</p>
<h5 id="EI-MAG0-EI-MAG3（文件标识）"><a href="#EI-MAG0-EI-MAG3（文件标识）" class="headerlink" title="EI_MAG0 - EI_MAG3（文件标识）"></a>EI_MAG0 - EI_MAG3（文件标识）</h5><p>默认值就是：7F 45 4C 46，即ELF</p>
<h5 id="EI-CLASS（文件类）"><a href="#EI-CLASS（文件类）" class="headerlink" title="EI_CLASS（文件类）"></a>EI_CLASS（文件类）</h5><table>
<thead>
<tr>
<th align="center">取值</th>
<th align="center">代表</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">01</td>
<td align="center">ELFCLASS32</td>
<td align="center">32位程序</td>
</tr>
<tr>
<td align="center">02</td>
<td align="center">ELFCLASS64</td>
<td align="center">64位程序</td>
</tr>
</tbody></table>
<p>Go代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EhdrClass := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">1</span>: <span class="string">"ELF32"</span>,</span><br><span class="line">		<span class="number">2</span>: <span class="string">"ELF64"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="EI-DATA（数据编码）"><a href="#EI-DATA（数据编码）" class="headerlink" title="EI_DATA（数据编码）"></a>EI_DATA（数据编码）</h5><table>
<thead>
<tr>
<th align="center">取值</th>
<th align="center">代表</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">01</td>
<td align="center">ELFDATA2LSB</td>
<td align="center">小端序</td>
</tr>
<tr>
<td align="center">02</td>
<td align="center">ELFDATA2MSB</td>
<td align="center">大端序</td>
</tr>
</tbody></table>
<p>Go代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EhdrData := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">1</span>:<span class="string">"2's complement, little endian"</span>,</span><br><span class="line">		<span class="number">2</span>:<span class="string">"2's complement, big endian"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="EI-VERSION-文件版本"><a href="#EI-VERSION-文件版本" class="headerlink" title="EI_VERSION(文件版本)"></a>EI_VERSION(文件版本)</h5><p>固定值01 <strong>EV_CURRENT</strong></p>
<p>Go代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EhdrVersion := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">1</span>:<span class="string">"1 (current)"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="EI-OSABI-OS类型"><a href="#EI-OSABI-OS类型" class="headerlink" title="EI_OSABI(OS类型)"></a>EI_OSABI(OS类型)</h5><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">EhdrOSABI := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span> : <span class="string">"UNIX - System V"</span>,</span><br><span class="line">		<span class="number">0x1</span> : <span class="string">"Hewlett-Packard HP-UX"</span>,</span><br><span class="line">		<span class="number">0x2</span> : <span class="string">"NetBSD"</span>,</span><br><span class="line">		<span class="number">0x3</span> : <span class="string">"Linux"</span>,</span><br><span class="line">		<span class="number">0x6</span> : <span class="string">"Sun Solaris"</span>,</span><br><span class="line">		<span class="number">0x7</span> : <span class="string">"AIX"</span>,</span><br><span class="line">		<span class="number">0x8</span> : <span class="string">"IRIX"</span>,</span><br><span class="line">		<span class="number">0x9</span> : <span class="string">"FreeBSD"</span>,</span><br><span class="line">		<span class="number">0xA</span> : <span class="string">"Compaq TRU64 UNIX"</span>,</span><br><span class="line">		<span class="number">0xB</span> : <span class="string">"Novell Modesto"</span>,</span><br><span class="line">		<span class="number">0xC</span> : <span class="string">"Open BSD"</span>,</span><br><span class="line">		<span class="number">0xD</span> : <span class="string">"Open VMS"</span>,</span><br><span class="line">		<span class="number">0xE</span> : <span class="string">"Hewlett-Packard Non-Stop Kernel"</span>,</span><br><span class="line">		<span class="number">0xF</span> : <span class="string">"Amiga Research OS"</span>,</span><br><span class="line">		<span class="number">0x40</span>: <span class="string">"ARM EABI"</span>,</span><br><span class="line">		<span class="number">0x61</span>: <span class="string">"ARM"</span>,</span><br><span class="line">		<span class="number">0xFF</span>: <span class="string">"Standalone (embedded applications)"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h5 id="EI-ABIVERSION"><a href="#EI-ABIVERSION" class="headerlink" title="EI_ABIVERSION"></a>EI_ABIVERSION</h5><p>ABI版本</p>
<h5 id="EI-PAD"><a href="#EI-PAD" class="headerlink" title="EI_PAD"></a>EI_PAD</h5><p>为保留字节的开始，默认为0</p>
<h5 id="EI-NIDENT"><a href="#EI-NIDENT" class="headerlink" title="EI_NIDENT"></a>EI_NIDENT</h5><p>e_ident数组的大小，但一般默认值为0</p>
<p>最后可以得到解析e_ident的代码：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Ehdr Elf32_Ehdr)</span> <span class="title">ReadMagic</span><span class="params">(data []<span class="keyword">byte</span>)</span><span class="title">Elf32_Ehdr</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> MagicNum = data[:<span class="number">16</span>]</span><br><span class="line">	<span class="comment">//Ehdr.e_ident = u_char(MagicNum)</span></span><br><span class="line">	<span class="keyword">for</span> _,value := <span class="keyword">range</span> MagicNum&#123;</span><br><span class="line">		Ehdr.Ehdr_Magic += Change.DecHex(<span class="keyword">int64</span>(value))</span><br><span class="line">		Ehdr.Ehdr_Magic += <span class="string">" "</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Ehdr_Class</span></span><br><span class="line">	Ehdr.Ehdr_Class = <span class="keyword">int</span>(MagicNum[<span class="number">4</span>])</span><br><span class="line">	<span class="comment">//Ehdr_Data</span></span><br><span class="line">	Ehdr.Ehdr_Data = <span class="keyword">int</span>(MagicNum[<span class="number">5</span>])</span><br><span class="line">	<span class="comment">//Ehdr_Version</span></span><br><span class="line">	Ehdr.Ehdr_Version = <span class="keyword">int</span>(MagicNum[<span class="number">6</span>])</span><br><span class="line">	<span class="comment">//Ehdr_OS</span></span><br><span class="line">	Ehdr.Ehdr_OS = <span class="keyword">int</span>(MagicNum[<span class="number">7</span>])</span><br><span class="line">	<span class="comment">//Ehdr_ABIV</span></span><br><span class="line">	Ehdr.Ehdr_ABIV = <span class="keyword">int</span>(MagicNum[<span class="number">8</span>])</span><br><span class="line">	<span class="keyword">return</span> Ehdr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="e-type"><a href="#e-type" class="headerlink" title="e_type"></a>e_type</h4><p>目标文件类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">EhdrType := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span> : <span class="string">"NONE"</span>,<span class="comment">//No file type</span></span><br><span class="line">		<span class="number">0x1</span> : <span class="string">"REL"</span>,<span class="comment">//Relocatable</span></span><br><span class="line">		<span class="number">0x2</span> : <span class="string">"EXEC"</span>,<span class="comment">//Executable</span></span><br><span class="line">		<span class="number">0x3</span> : <span class="string">"DYN"</span>,<span class="comment">//Shared object</span></span><br><span class="line">		<span class="number">0x4</span> : <span class="string">"CORE"</span>,<span class="comment">//Core</span></span><br><span class="line">		<span class="number">0xfe00</span> : <span class="string">"LOOS"</span>,<span class="comment">//OS specific</span></span><br><span class="line">		<span class="number">0xfeff</span> : <span class="string">"HIOS"</span>,<span class="comment">//OS specific</span></span><br><span class="line">		<span class="number">0xff00</span> : <span class="string">"LOPROC"</span>,<span class="comment">//Processor specific</span></span><br><span class="line">		<span class="number">0xffff</span> : <span class="string">"HIPROC"</span>,<span class="comment">//Processor specific</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="e-machine"><a href="#e-machine" class="headerlink" title="e_machine"></a>e_machine</h4><p>文件的目标体系结构类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line">EhdrMachine := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0</span> : <span class="string">"No machine"</span>,</span><br><span class="line">		<span class="number">1</span> : <span class="string">"AT&amp;T WE 32100"</span>,</span><br><span class="line">		<span class="number">2</span> : <span class="string">"SPARC"</span>,</span><br><span class="line">		<span class="number">3</span> : <span class="string">"Intel 80386"</span>,</span><br><span class="line">		<span class="number">4</span> : <span class="string">"Motorola 68000"</span>,</span><br><span class="line">		<span class="number">5</span> : <span class="string">"Motorola 88000"</span>,</span><br><span class="line">		<span class="number">6</span> : <span class="string">"Reserved for future use (was EM_486)"</span>,</span><br><span class="line">		<span class="number">7</span> : <span class="string">"Intel 80860"</span>,</span><br><span class="line">		<span class="number">8</span> : <span class="string">"MIPS I Architecture"</span>,</span><br><span class="line">		<span class="number">9</span> : <span class="string">"IBM System/370 Processor"</span>,</span><br><span class="line">		<span class="number">10</span> : <span class="string">"MIPS RS3000 Little-endian"</span>,</span><br><span class="line">		<span class="number">11</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">12</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">13</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">14</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">15</span> : <span class="string">"Hewlett-Packard PA-RISC"</span>,</span><br><span class="line">		<span class="number">16</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">17</span> : <span class="string">"Fujitsu VPP500"</span>,</span><br><span class="line">		<span class="number">18</span> : <span class="string">"Enhanced instruction set SPARC"</span>,</span><br><span class="line">		<span class="number">19</span> : <span class="string">"Intel 80960"</span>,</span><br><span class="line">		<span class="number">20</span> : <span class="string">"PowerPC"</span>,</span><br><span class="line">		<span class="number">21</span> : <span class="string">"64-bit PowerPC"</span>,</span><br><span class="line">		<span class="number">22</span> : <span class="string">"IBM System/390 Processor"</span>,</span><br><span class="line">		<span class="number">23</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">24</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">25</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">26</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">27</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">28</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">29</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">30</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">31</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">32</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">33</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">34</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">35</span> : <span class="string">"Reserved for future use"</span>,</span><br><span class="line">		<span class="number">36</span> : <span class="string">"NEC V800"</span>,</span><br><span class="line">		<span class="number">37</span> : <span class="string">"Fujitsu FR20"</span>,</span><br><span class="line">		<span class="number">38</span> : <span class="string">"TRW RH-32"</span>,</span><br><span class="line">		<span class="number">39</span> : <span class="string">"Motorola RCE"</span>,</span><br><span class="line">		<span class="number">40</span> : <span class="string">"Advanced RISC Machines ARM"</span>,</span><br><span class="line">		<span class="number">41</span> : <span class="string">"Digital Alpha"</span>,</span><br><span class="line">		<span class="number">42</span> : <span class="string">"Hitachi SH"</span>,</span><br><span class="line">		<span class="number">43</span> : <span class="string">"SPARC Version 9"</span>,</span><br><span class="line">		<span class="number">44</span> : <span class="string">"Siemens TriCore embedded processor"</span>,</span><br><span class="line">		<span class="number">45</span> : <span class="string">"Argonaut RISC Core, Argonaut Technologies Inc."</span>,</span><br><span class="line">		<span class="number">46</span> : <span class="string">"Hitachi H8/300"</span>,</span><br><span class="line">		<span class="number">47</span> : <span class="string">"Hitachi H8/300H"</span>,</span><br><span class="line">		<span class="number">48</span> : <span class="string">"Hitachi H8S"</span>,</span><br><span class="line">		<span class="number">49</span> : <span class="string">"Hitachi H8/500"</span>,</span><br><span class="line">		<span class="number">50</span> : <span class="string">"Intel IA-64 processor architecture"</span>,</span><br><span class="line">		<span class="number">51</span> : <span class="string">"Stanford MIPS-X"</span>,</span><br><span class="line">		<span class="number">52</span> : <span class="string">"Motorola ColdFire"</span>,</span><br><span class="line">		<span class="number">53</span> : <span class="string">"Motorola M68HC12"</span>,</span><br><span class="line">		<span class="number">54</span> : <span class="string">"Fujitsu MMA Multimedia Accelerator"</span>,</span><br><span class="line">		<span class="number">55</span> : <span class="string">"Siemens PCP"</span>,</span><br><span class="line">		<span class="number">56</span> : <span class="string">"Sony nCPU embedded RISC processor"</span>,</span><br><span class="line">		<span class="number">57</span> : <span class="string">"Denso NDR1 microprocessor"</span>,</span><br><span class="line">		<span class="number">58</span> : <span class="string">"Motorola Star*Core processor"</span>,</span><br><span class="line">		<span class="number">59</span> : <span class="string">"Toyota ME16 processor"</span>,</span><br><span class="line">		<span class="number">60</span> : <span class="string">"STMicroelectronics ST100 processor"</span>,</span><br><span class="line">		<span class="number">61</span> : <span class="string">"Advanced Logic Corp. TinyJ embedded processor family"</span>,</span><br><span class="line">		<span class="number">62</span> : <span class="string">"AMD x86-64 architecture"</span>,</span><br><span class="line">		<span class="number">63</span> : <span class="string">"Sony DSP Processor"</span>,</span><br><span class="line">		<span class="number">64</span> : <span class="string">"Digital Equipment Corp. PDP-10"</span>,</span><br><span class="line">		<span class="number">65</span> : <span class="string">"Digital Equipment Corp. PDP-11"</span>,</span><br><span class="line">		<span class="number">66</span> : <span class="string">"Siemens FX66 microcontroller"</span>,</span><br><span class="line">		<span class="number">67</span> : <span class="string">"STMicroelectronics ST9+ 8/16 bit microcontroller"</span>,</span><br><span class="line">		<span class="number">68</span> : <span class="string">"STMicroelectronics ST7 8-bit microcontroller"</span>,</span><br><span class="line">		<span class="number">69</span> : <span class="string">"Motorola MC68HC16 Microcontroller"</span>,</span><br><span class="line">		<span class="number">70</span> : <span class="string">"Motorola MC68HC11 Microcontroller"</span>,</span><br><span class="line">		<span class="number">71</span> : <span class="string">"Motorola MC68HC08 Microcontroller"</span>,</span><br><span class="line">		<span class="number">72</span> : <span class="string">"Motorola MC68HC05 Microcontroller"</span>,</span><br><span class="line">		<span class="number">73</span> : <span class="string">"Silicon Graphics SVx"</span>,</span><br><span class="line">		<span class="number">75</span> : <span class="string">"Digital VAX"</span>,</span><br><span class="line">		<span class="number">76</span> : <span class="string">"Axis Communications 32-bit embedded processor"</span>,</span><br><span class="line">		<span class="number">77</span> : <span class="string">"Infineon Technologies 32-bit embedded processor"</span>,</span><br><span class="line">		<span class="number">78</span> : <span class="string">"Element 14 64-bit DSP Processor"</span>,</span><br><span class="line">		<span class="number">79</span> : <span class="string">"LSI Logic 16-bit DSP Processor"</span>,</span><br><span class="line">		<span class="number">80</span> : <span class="string">"Donald Knuth's educational 64-bit processor"</span>,</span><br><span class="line">		<span class="number">81</span> : <span class="string">"Harvard University machine-independent object files"</span>,</span><br><span class="line">		<span class="number">82</span> : <span class="string">"SiTera Prism"</span>,</span><br><span class="line">		<span class="number">83</span> : <span class="string">"Atmel AVR 8-bit microcontroller"</span>,</span><br><span class="line">		<span class="number">84</span> : <span class="string">"Fujitsu FR30"</span>,</span><br><span class="line">		<span class="number">85</span> : <span class="string">"Mitsubishi D10V"</span>,</span><br><span class="line">		<span class="number">86</span> : <span class="string">"Mitsubishi D30V"</span>,</span><br><span class="line">		<span class="number">87</span> : <span class="string">"NEC v850"</span>,</span><br><span class="line">		<span class="number">88</span> : <span class="string">"Mitsubishi M32R"</span>,</span><br><span class="line">		<span class="number">89</span> : <span class="string">"Matsushita MN10300"</span>,</span><br><span class="line">		<span class="number">90</span> : <span class="string">"Matsushita MN10200"</span>,</span><br><span class="line">		<span class="number">91</span> : <span class="string">"picoJava"</span>,</span><br><span class="line">		<span class="number">92</span> : <span class="string">"OpenRISC 32-bit embedded processor"</span>,</span><br><span class="line">		<span class="number">93</span> : <span class="string">"ARC Cores Tangent-A5"</span>,</span><br><span class="line">		<span class="number">94</span> : <span class="string">"Tensilica Xtensa Architecture"</span>,</span><br><span class="line">		<span class="number">95</span> : <span class="string">"Alphamosaic VideoCore processor"</span>,</span><br><span class="line">		<span class="number">96</span> : <span class="string">"Thompson Multimedia General Purpose Processor"</span>,</span><br><span class="line">		<span class="number">97</span> : <span class="string">"National Semiconductor 32000 series"</span>,</span><br><span class="line">		<span class="number">98</span> : <span class="string">"Tenor Network TPC processor"</span>,</span><br><span class="line">		<span class="number">99</span> : <span class="string">"Trebia SNP 1000 processor"</span>,</span><br><span class="line">		<span class="number">100</span> : <span class="string">"STMicroelectronics (www.st.com) ST200 microcontroller"</span>,</span><br><span class="line">		<span class="number">101</span> : <span class="string">"Ubicom IP2xxx microcontroller family"</span>,</span><br><span class="line">		<span class="number">102</span> : <span class="string">"MAX Processor"</span>,</span><br><span class="line">		<span class="number">103</span> : <span class="string">"National Semiconductor CompactRISC microprocessor"</span>,</span><br><span class="line">		<span class="number">104</span> : <span class="string">"Fujitsu F2MC16"</span>,</span><br><span class="line">		<span class="number">105</span> : <span class="string">"Texas Instruments embedded microcontroller msp430"</span>,</span><br><span class="line">		<span class="number">106</span> : <span class="string">"Analog Devices Blackfin (DSP) processor"</span>,</span><br><span class="line">		<span class="number">107</span> : <span class="string">"S1C33 Family of Seiko Epson processors"</span>,</span><br><span class="line">		<span class="number">108</span> : <span class="string">"Sharp embedded microprocessor"</span>,</span><br><span class="line">		<span class="number">109</span> : <span class="string">"Arca RISC Microprocessor"</span>,</span><br><span class="line">		<span class="number">110</span> : <span class="string">"Microprocessor series from PKU-Unity Ltd. and MPRC of Peking University"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="e-version"><a href="#e-version" class="headerlink" title="e_version"></a>e_version</h4><p>目标文件版本。固定值01 <strong>EV_CURRENT</strong></p>
<h4 id="e-entry"><a href="#e-entry" class="headerlink" title="e_entry"></a>e_entry</h4><p>程序入口的虚拟地址</p>
<h4 id="e-phoff"><a href="#e-phoff" class="headerlink" title="e_phoff"></a>e_phoff</h4><p>Program Header Table的偏移地址，即程序头部表索引地址</p>
<h4 id="e-shoff"><a href="#e-shoff" class="headerlink" title="e_shoff"></a>e_shoff</h4><p>Section Header Table的偏移地址，即节区表索引地址</p>
<h4 id="e-flags"><a href="#e-flags" class="headerlink" title="e_flags"></a>e_flags</h4><p>处理器相关标识</p>
<h4 id="e-ehsize"><a href="#e-ehsize" class="headerlink" title="e_ehsize"></a>e_ehsize</h4><p>ELF Header的大小</p>
<h4 id="e-phentsize"><a href="#e-phentsize" class="headerlink" title="e_phentsize"></a>e_phentsize</h4><p>Program Header Entry的大小，即程序头部表的单个表项的大小</p>
<h4 id="e-phnum"><a href="#e-phnum" class="headerlink" title="e_phnum"></a>e_phnum</h4><p>Program Header Entry的数目，即程序头部表的表项数</p>
<h4 id="e-shentsize"><a href="#e-shentsize" class="headerlink" title="e_shentsize"></a>e_shentsize</h4><p>Section Header Entry的大小，即节区表的单个表项的大小</p>
<h4 id="e-shnum"><a href="#e-shnum" class="headerlink" title="e_shnum"></a>e_shnum</h4><p>Section Header Entry的数目，即节区表的表项数</p>
<h4 id="e-shstrndx"><a href="#e-shstrndx" class="headerlink" title="e_shstrndx"></a>e_shstrndx</h4><p>即节区名称表(.shstrtab)位于节区表的位置，用于索引节区的名字</p>
<h3 id="读取ELF-Header"><a href="#读取ELF-Header" class="headerlink" title="读取ELF Header"></a>读取ELF Header</h3><h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><p>例如有一个ELF Header的二进制数据为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">7E 45 4C 46 01 01 01 00 00 00 00 00 00 00 00 00</span><br><span class="line">02 00 03 00 01 00 00 00 10 83 04 08 34 00 00 00</span><br><span class="line">E0 17 00 00 00 00 00 00 34 00 20 00 09 00 28 00</span><br><span class="line">1F 00 1C 00</span><br></pre></td></tr></table></figure>

<p>那么e_ident即为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">7E 45 4C 46 01 01 01 00 00 00 00 00 00 00 00 00</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="center">名称</th>
<th align="center">值</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">Ehdr_Class</td>
<td align="center">01</td>
<td align="center">ELF32</td>
</tr>
<tr>
<td align="center">Ehdr_Data</td>
<td align="center">01</td>
<td align="center">2’s complement, little endian</td>
</tr>
<tr>
<td align="center">Ehdr_Version</td>
<td align="center">01</td>
<td align="center">1 (current)</td>
</tr>
<tr>
<td align="center">Ehdr_OS</td>
<td align="center">00</td>
<td align="center">UNIX - System V</td>
</tr>
<tr>
<td align="center">Ehdr_ABIV</td>
<td align="center">00</td>
<td align="center">0x0</td>
</tr>
</tbody></table>
<p>e_type的二进制数据即为<code>02 00</code>因为是小端存储应该变为0002也就是2，所以也就是<code>Executable</code></p>
<p>以此类推即可</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p>这里需要注意因为如果是小端序存储的话，需要转变为大端序才是一般常用的显示格式，所以我引入了<strong>LSBtoMSB</strong>函数，一些更具体的代码可以查看项目</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Ehdr Elf32_Ehdr)</span> <span class="title">ReadHeader</span><span class="params">(data []<span class="keyword">byte</span>)</span> <span class="title">Elf32_Ehdr</span></span>&#123;</span><br><span class="line">	Ehdr = Ehdr.ReadMagic(data)</span><br><span class="line">	<span class="comment">//e_type</span></span><br><span class="line">	tmp := data[<span class="number">16</span>:<span class="number">18</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_type = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_machine</span></span><br><span class="line">	tmp = data[<span class="number">18</span>:<span class="number">20</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_machine = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_version</span></span><br><span class="line">	tmp = data[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_version = Elf32_Word(<span class="number">1</span>)</span><br><span class="line">	<span class="comment">//e_entry</span></span><br><span class="line">	tmp = data[<span class="number">24</span>:<span class="number">28</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_entry = Elf32_Addr(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//e_phoff</span></span><br><span class="line">	tmp = data[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_phoff = Elf32_Off(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//e_shoff</span></span><br><span class="line">	tmp = data[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_shoff = Elf32_Off(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//e_flags</span></span><br><span class="line">	tmp = data[<span class="number">36</span>:<span class="number">40</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_flags = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//e_ehsize</span></span><br><span class="line">	tmp = data[<span class="number">40</span>:<span class="number">42</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_ehsize = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_phentsize</span></span><br><span class="line">	tmp = data[<span class="number">42</span>:<span class="number">44</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_phentsize = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_phnum</span></span><br><span class="line">	tmp = data[<span class="number">44</span>:<span class="number">46</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_phnum = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_shentsize</span></span><br><span class="line">	tmp = data[<span class="number">46</span>:<span class="number">48</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_shentsize = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_shnum</span></span><br><span class="line">	tmp = data[<span class="number">48</span>:<span class="number">50</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_shnum = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="comment">//e_shstrndx</span></span><br><span class="line">	tmp = data[<span class="number">50</span>:<span class="number">52</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	Ehdr.e_shstrndx = Elf32_Half(Change.BytesToInt16(tmp))</span><br><span class="line">	<span class="keyword">return</span> Ehdr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="输出ELF-Header"><a href="#输出ELF-Header" class="headerlink" title="输出ELF Header"></a>输出ELF Header</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Ehdr Elf32_Ehdr)</span> <span class="title">PHeader</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">"ELF Header:"</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"%-9s"</span>,<span class="string">"Magic: "</span>)</span><br><span class="line">	fmt.Println(Ehdr.Ehdr_Magic)</span><br><span class="line">	<span class="comment">//Class</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Class: "</span>)</span><br><span class="line">	tmpstr := EhdrClass[Ehdr.Ehdr_Class]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Invalid class"</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Println(tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Data</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Data: "</span>)</span><br><span class="line">	tmpstr = EhdrData[Ehdr.Ehdr_Data]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Invaild data encoding"</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Version</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Version: "</span>)</span><br><span class="line">	tmpstr = EhdrVersion[Ehdr.Ehdr_Version]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Invaild version"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Println(tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//OS/ABI</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"OS/ABI: "</span>)</span><br><span class="line">	tmpstr = EhdrOSABI[Ehdr.Ehdr_OS]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Unknown"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Println(tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//ABI Version</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"ABI Version:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.Ehdr_ABIV))</span><br><span class="line">	<span class="comment">//Type</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Type: "</span>)</span><br><span class="line">	tmpstr = EhdrType[<span class="keyword">int</span>(<span class="keyword">int32</span>(Ehdr.e_type))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Unknown"</span> )</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(tmpstr )</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Machine</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Machine: "</span>)</span><br><span class="line">	tmpstr = EhdrMachine[<span class="keyword">int</span>(<span class="keyword">int32</span>(Ehdr.e_machine))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		fmt.Println(<span class="string">"Unknown"</span> )</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Version</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Version:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(Ehdr.e_version)))</span><br><span class="line">	<span class="comment">//Entry point address</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Entry point address:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(Ehdr.e_entry)))</span><br><span class="line">	<span class="comment">//Start of program headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Start of program headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_phoff),<span class="string">"(bytes into file)"</span>)</span><br><span class="line">	<span class="comment">//Start of section headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Start of section headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_shoff),<span class="string">"(bytes into file)"</span>)</span><br><span class="line">	<span class="comment">//Flags</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"FLags:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(Ehdr.e_flags)))</span><br><span class="line">	<span class="comment">//Size of this header</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Size of this header:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_ehsize),<span class="string">"(bytes)"</span>)</span><br><span class="line">	<span class="comment">//Size of program headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Size of program headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_phentsize),<span class="string">"(bytes)"</span>)</span><br><span class="line">	<span class="comment">//Number of program headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Number of program headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_phnum))</span><br><span class="line">	<span class="comment">//Size of section headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Size of section headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_shentsize),<span class="string">"(bytes)"</span>)</span><br><span class="line">	<span class="comment">//Number of section headers</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Number of section headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_shnum))</span><br><span class="line">	<span class="comment">//Section header string table index</span></span><br><span class="line">	fmt.Printf(<span class="string">"%-35s"</span>,<span class="string">"Section header string table index:"</span>)</span><br><span class="line">	fmt.Println(<span class="keyword">int64</span>(Ehdr.e_shstrndx))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Program-Header-Table"><a href="#Program-Header-Table" class="headerlink" title="Program Header Table"></a>Program Header Table</h2><h3 id="概述-2"><a href="#概述-2" class="headerlink" title="概述"></a>概述</h3><p>首先我们得先熟悉并且理解Program Header Table的结构体定义开始：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Elf32_phdr <span class="keyword">struct</span> &#123;</span><br><span class="line">	p_type Elf32_Word</span><br><span class="line">	<span class="comment">//此数组元素描述的段的类型，或者如何解释此数组元素的信息</span></span><br><span class="line">	p_offset Elf32_Off</span><br><span class="line">	<span class="comment">//此成员给出从文件头到该段第一个字节的偏移</span></span><br><span class="line">	p_vaddr Elf32_Addr</span><br><span class="line">	<span class="comment">//此成员给出段的第一个字节将被放到内存中的虚拟地址</span></span><br><span class="line">	p_paddr Elf32_Addr</span><br><span class="line">	<span class="comment">//此成员仅用于与物理地址相关的系统中。System V忽略所有应用程序的物理地址信息</span></span><br><span class="line">	p_filesz Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出段在文件映像中所占的字节数。可以为0</span></span><br><span class="line">	p_memsz Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出段在内存映像中占用的字节数。可以为0</span></span><br><span class="line">	p_flage Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出与段相关的标志(read、write、exec)</span></span><br><span class="line">	p_align Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出段在文件中和内存中如何对齐</span></span><br><span class="line">	<span class="comment">//字节对其,p_vaddr 和 p_offset 对 p_align 取模后应该等于0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面开始逐步解释各个字段</p>
<h4 id="p-type"><a href="#p-type" class="headerlink" title="p_type"></a>p_type</h4><p>声明此段的作用类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">PType := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span>:<span class="string">"NULL"</span>,</span><br><span class="line">		<span class="number">0x1</span>:<span class="string">"LOAD"</span>,</span><br><span class="line">		<span class="number">0x2</span>:<span class="string">"DYNAMIC"</span>,</span><br><span class="line">		<span class="number">0x3</span>:<span class="string">"INERP"</span>,</span><br><span class="line">		<span class="number">0x4</span>:<span class="string">"NOTE"</span>,</span><br><span class="line">		<span class="number">0x5</span>:<span class="string">"SHLIB"</span>,</span><br><span class="line">		<span class="number">0x6</span>:<span class="string">"PHDR"</span>,</span><br><span class="line">		<span class="number">0x7</span>:<span class="string">"TLS"</span>,</span><br><span class="line">		<span class="number">0x8</span>:<span class="string">"NUM"</span>,</span><br><span class="line">		<span class="number">0x60000000</span>:<span class="string">"LOOS"</span>,</span><br><span class="line">		<span class="number">0x6474e550</span>:<span class="string">"GNU_EH_FRAME"</span>,</span><br><span class="line">		<span class="number">0x6474e551</span>:<span class="string">"GNU_STACK"</span>,</span><br><span class="line">		<span class="number">0x6474e552</span>:<span class="string">"GNU_RELRO"</span>,</span><br><span class="line">		<span class="number">0x6ffffffa</span>:<span class="string">"LOSUNW"</span>,</span><br><span class="line">		<span class="number">0x6ffffffc</span>:<span class="string">"SUNWBSS"</span>,</span><br><span class="line">		<span class="number">0x6ffffffb</span>:<span class="string">"SUNWSTACK"</span>,</span><br><span class="line">		<span class="number">0x6fffffff</span>:<span class="string">"HISUNW "</span>,</span><br><span class="line">		<span class="number">0x6ffffffe</span>:<span class="string">"HIOS"</span>,</span><br><span class="line">		<span class="number">0x70000000</span>:<span class="string">"LOPROC"</span>,</span><br><span class="line">		<span class="number">0x7fffffff</span>:<span class="string">"HIPROC"</span>,</span><br><span class="line">		<span class="comment">// ARM Sections</span></span><br><span class="line">		<span class="number">0x70000001</span>:<span class="string">"ARM_EXIDX"</span>,</span><br><span class="line">		<span class="number">0x70000002</span>:<span class="string">"ARM_PREEMPTMAP"</span>,</span><br><span class="line">		<span class="number">0x70000003</span>:<span class="string">"ARM_ATTRIBUTES"</span>,</span><br><span class="line">		<span class="number">0x70000004</span>:<span class="string">"ARM_DEBUGOVERLAY"</span>,</span><br><span class="line">		<span class="number">0x70000005</span>:<span class="string">"ARM_OVERLAYSECTION"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="p-offset"><a href="#p-offset" class="headerlink" title="p_offset"></a>p_offset</h4><p>段相对于文件的索引地址</p>
<h4 id="p-vaddr"><a href="#p-vaddr" class="headerlink" title="p_vaddr"></a>p_vaddr</h4><p>段在内存中的虚拟地址</p>
<h4 id="p-paddr"><a href="#p-paddr" class="headerlink" title="p_paddr"></a>p_paddr</h4><p>段的物理地址</p>
<h4 id="p-filesz"><a href="#p-filesz" class="headerlink" title="p_filesz"></a>p_filesz</h4><p>段在文件中所占的长度</p>
<h4 id="p-memsz"><a href="#p-memsz" class="headerlink" title="p_memsz"></a>p_memsz</h4><p>段在内存中所占的长度</p>
<h4 id="p-flage"><a href="#p-flage" class="headerlink" title="p_flage"></a>p_flage</h4><p>段相关标志(read、write、exec)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">PFlag := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0</span>:<span class="string">"N"</span>,</span><br><span class="line">		<span class="number">1</span>:<span class="string">"__E"</span>,</span><br><span class="line">		<span class="number">2</span>:<span class="string">"_W_"</span>,</span><br><span class="line">		<span class="number">3</span>:<span class="string">"_WE"</span>,</span><br><span class="line">		<span class="number">4</span>:<span class="string">"R__"</span>,</span><br><span class="line">		<span class="number">5</span>:<span class="string">"R_E"</span>,</span><br><span class="line">		<span class="number">6</span>:<span class="string">"RW_"</span>,</span><br><span class="line">		<span class="number">7</span>:<span class="string">"RWE"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="p-align"><a href="#p-align" class="headerlink" title="p_align"></a>p_align</h4><p>给出段在文件中和内存中如何对齐</p>
<h3 id="读取Program-Header-Table"><a href="#读取Program-Header-Table" class="headerlink" title="读取Program Header Table"></a>读取Program Header Table</h3><p>这里的一个关键是如果从文件中读取出Program Header Table的数据，在ELF_Header中,我们可以得到Program Header的<strong>索引地址(e_phoff)</strong>、<strong>段数量(e_phnum)</strong>、<strong>表项大小(e_phentsize)</strong></p>
<p>那我们可以知道Program Header Table的数据起始地址Star_Addr，结束地址End_Addr：</p>
<ul>
<li>Star_Addr = e_phoff</li>
<li>End_Addr = e_phoff + e_phnum*e_phentsize</li>
</ul>
<p>获取到数据后，就需要一个个去读取每一个Program Header</p>
<p>转变为代码即为：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(phdr Elf32_phdr)</span> <span class="title">MainRead</span><span class="params">(Ehdr Elf32_Ehdr,data []<span class="keyword">byte</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> Phnum <span class="keyword">int64</span> = <span class="keyword">int64</span>(Ehdr.e_phnum) <span class="comment">//获取Program Header数量</span></span><br><span class="line">	<span class="keyword">var</span> StartIndex <span class="keyword">int64</span>= <span class="keyword">int64</span>(Ehdr.e_phoff)</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="keyword">int</span>(Phnum);i++ &#123;</span><br><span class="line">		phdr.SonRead(StartIndex,data,<span class="keyword">int64</span>(Ehdr.e_phentsize))</span><br><span class="line">		StartIndex = StartIndex + <span class="keyword">int64</span>(Ehdr.e_phentsize)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">""</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(phdr Elf32_phdr)</span> <span class="title">SonRead</span><span class="params">(StartIndex <span class="keyword">int64</span>,data []<span class="keyword">byte</span>,size <span class="keyword">int64</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> t_phdr Elf32_phdr</span><br><span class="line">	<span class="keyword">var</span> t_data []<span class="keyword">byte</span> = data[StartIndex:StartIndex+size]</span><br><span class="line">	<span class="comment">//p_type Elf32_Word</span></span><br><span class="line">	tmp := t_data[:<span class="number">4</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_type = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_offset Elf32_Off</span></span><br><span class="line">	tmp = t_data[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_offset = Elf32_Off(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_vaddr Elf32_Addr</span></span><br><span class="line">	tmp = t_data[<span class="number">8</span>:<span class="number">12</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_vaddr = Elf32_Addr(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_paddr Elf32_Addr</span></span><br><span class="line">	tmp = t_data[<span class="number">12</span>:<span class="number">16</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_paddr = Elf32_Addr(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_filesz Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">16</span>:<span class="number">20</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_filesz = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_memsz Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_memsz = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_flage Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">24</span>:<span class="number">28</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_flage = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_align Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_phdr.p_align = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//p_type</span></span><br><span class="line">	tmpstr := PType[<span class="keyword">int</span>(<span class="keyword">int32</span>(t_phdr.p_type))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr ==<span class="string">""</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-13s"</span>,<span class="string">"Unknown"</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-13s"</span>,tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//p_offset</span></span><br><span class="line">	fmt.Print(<span class="string">"  "</span>)</span><br><span class="line">	tstr := <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_offset))</span><br><span class="line">	fmt.Printf(<span class="string">"%-9s"</span>,tstr)</span><br><span class="line">	<span class="comment">//p_vaddr</span></span><br><span class="line">	tstr = <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_vaddr))</span><br><span class="line">	fmt.Printf(<span class="string">"%-11s"</span>,tstr)</span><br><span class="line">	<span class="comment">//p_paddr</span></span><br><span class="line">	tstr = <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_paddr))</span><br><span class="line">	fmt.Printf(<span class="string">"%-11s"</span>,tstr)</span><br><span class="line">	<span class="comment">//p_filesz</span></span><br><span class="line">	tstr = <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_filesz))</span><br><span class="line">	fmt.Printf(<span class="string">"%-8s"</span>,tstr)</span><br><span class="line">	<span class="comment">//p_memsz</span></span><br><span class="line">	tstr = <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_memsz))</span><br><span class="line">	fmt.Printf(<span class="string">"%-8s"</span>,tstr)</span><br><span class="line">	<span class="comment">//p_flage</span></span><br><span class="line">	<span class="comment">//R:Read W:Write E:Exec N:None</span></span><br><span class="line">	tmpstr = PFlag[<span class="keyword">int</span>(<span class="keyword">int32</span>(t_phdr.p_flage))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr ==<span class="string">""</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-13s"</span>,<span class="string">"Unknown"</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-4s"</span>,tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//p_align</span></span><br><span class="line">	tstr = <span class="string">"0x"</span>+Change.DecHex(<span class="keyword">int64</span>(t_phdr.p_align))</span><br><span class="line">	fmt.Printf(<span class="string">"%-8s\n"</span>,tstr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>负责打印一开始的部分</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(phdr Elf32_phdr)</span> <span class="title">PHeader</span><span class="params">(Ehdr Elf32_Ehdr)</span></span>&#123;</span><br><span class="line">	EhdrType := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span> : <span class="string">"NONE"</span>,<span class="comment">//No file type</span></span><br><span class="line">		<span class="number">0x1</span> : <span class="string">"REL"</span>,<span class="comment">//Relocatable</span></span><br><span class="line">		<span class="number">0x2</span> : <span class="string">"EXEC"</span>,<span class="comment">//Executable</span></span><br><span class="line">		<span class="number">0x3</span> : <span class="string">"DYN"</span>,<span class="comment">//Shared object</span></span><br><span class="line">		<span class="number">0x4</span> : <span class="string">"CORE"</span>,<span class="comment">//Core</span></span><br><span class="line">		<span class="number">0xfe00</span> : <span class="string">"LOOS"</span>,<span class="comment">//OS specific</span></span><br><span class="line">		<span class="number">0xfeff</span> : <span class="string">"HIOS"</span>,<span class="comment">//OS specific</span></span><br><span class="line">		<span class="number">0xff00</span> : <span class="string">"LOPROC"</span>,<span class="comment">//Processor specific</span></span><br><span class="line">		<span class="number">0xffff</span> : <span class="string">"HIPROC"</span>,<span class="comment">//Processor specific</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> T_type <span class="keyword">string</span></span><br><span class="line">	tmpstr := EhdrType[<span class="keyword">int</span>(<span class="keyword">int32</span>(Ehdr.e_type))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr == <span class="string">""</span>&#123;</span><br><span class="line">		T_type = <span class="string">"Unknown"</span></span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		T_type =tmpstr</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"Elf file type is "</span>+T_type)</span><br><span class="line">	fmt.Println(<span class="string">"Entry point 0x"</span>+Change.DecHex(<span class="keyword">int64</span>(Ehdr.e_entry)))</span><br><span class="line">	fmt.Print(<span class="string">"There are "</span>,Ehdr.e_phnum,<span class="string">" program headers, "</span>)</span><br><span class="line">	fmt.Println(<span class="string">"starting at offset"</span>,Ehdr.e_phoff)</span><br><span class="line">	fmt.Println(<span class="string">"Program Headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Section-Header-Table"><a href="#Section-Header-Table" class="headerlink" title="Section Header Table"></a>Section Header Table</h2><h3 id="概述-3"><a href="#概述-3" class="headerlink" title="概述"></a>概述</h3><p>首先我们得先熟悉并且理解Section Header Table的结构体定义开始：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Elf32_Shdr <span class="keyword">struct</span> &#123;</span><br><span class="line">	sh_name Elf32_Word</span><br><span class="line">	<span class="comment">//节区名称,此处是一个在名称节区的索引</span></span><br><span class="line">	sh_type Elf32_Word</span><br><span class="line">	<span class="comment">//节区类型</span></span><br><span class="line">	sh_flags Elf32_Word</span><br><span class="line">	<span class="comment">//同Program Header的p_flags</span></span><br><span class="line">	sh_addr Elf32_Addr</span><br><span class="line">	<span class="comment">//节区索引地址</span></span><br><span class="line">	sh_offset Elf32_Off</span><br><span class="line">	<span class="comment">//节区相对于文件的偏移地址</span></span><br><span class="line">	sh_size Elf32_Word</span><br><span class="line">	<span class="comment">//节区的大小</span></span><br><span class="line">	sh_link Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出节区头部表索引链接</span></span><br><span class="line">	sh_info Elf32_Word</span><br><span class="line">	<span class="comment">//此成员给出附加信息</span></span><br><span class="line">	sh_addralign Elf32_Word</span><br><span class="line">	<span class="comment">//某些节区带有地址对齐约束</span></span><br><span class="line">	sh_entsize Elf32_Word</span><br><span class="line">	<span class="comment">//某些节区中包含固定大小的项目,如符号表</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下面开始逐步解释各个字段</p>
<h4 id="sh-name"><a href="#sh-name" class="headerlink" title="sh_name"></a>sh_name</h4><p>节区名称,此处是一个在名称节区的索引</p>
<h4 id="sh-type"><a href="#sh-type" class="headerlink" title="sh_type"></a>sh_type</h4><p>节区类型</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ShType := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span>:<span class="string">"NULL"</span>,<span class="comment">/* Inactive section header */</span></span><br><span class="line">		<span class="number">0x1</span>:<span class="string">"PROGBITS"</span>,<span class="comment">/* Information defined by the program */</span></span><br><span class="line">		<span class="number">0x2</span>:<span class="string">"SYMTAB"</span>,<span class="comment">/* Symbol table - not DLL */</span></span><br><span class="line">		<span class="number">0x3</span>:<span class="string">"STRTAB"</span>,<span class="comment">/* String table */</span></span><br><span class="line">		<span class="number">0x4</span>:<span class="string">"RELA"</span>,<span class="comment">/* Explicit addend relocations, Elf64_Rela */</span></span><br><span class="line">		<span class="number">0x5</span>:<span class="string">"HASH"</span>,<span class="comment">/* Symbol hash table */</span></span><br><span class="line">		<span class="number">0x6</span>:<span class="string">"DYNAMIC"</span>,<span class="comment">/* Information for dynamic linking */</span></span><br><span class="line">		<span class="number">0x7</span>:<span class="string">"NOTE"</span>,<span class="comment">/* A Note section */</span></span><br><span class="line">		<span class="number">0x8</span>:<span class="string">"NOBITS"</span>,<span class="comment">/* Like SHT_PROGBITS with no data */</span></span><br><span class="line">		<span class="number">0x9</span>:<span class="string">"REL"</span>,<span class="comment">/* Implicit addend relocations, Elf64_Rel */</span></span><br><span class="line">		<span class="number">0xA</span>:<span class="string">"SHLIB"</span>,<span class="comment">/* Currently unspecified semantics */</span></span><br><span class="line">		<span class="number">0xD</span>:<span class="string">"DYNSYM"</span>,<span class="comment">/* Symbol table for a DLL */</span></span><br><span class="line">		<span class="number">0xE</span>:<span class="string">"INIT_ARRAY"</span>,<span class="comment">/* Array of constructors */</span></span><br><span class="line">		<span class="number">0xF</span>:<span class="string">"FINI_ARRAY"</span>,<span class="comment">/* Array of deconstructors */</span></span><br><span class="line">		<span class="number">0x10</span>:<span class="string">"PREINIT_ARRAY"</span>,<span class="comment">/* Array of pre-constructors */</span></span><br><span class="line">		<span class="number">0x11</span>:<span class="string">"GROUP"</span>,<span class="comment">/* Section group */</span></span><br><span class="line">		<span class="number">0x12</span>:<span class="string">"SYMTAB_SHNDX"</span>,<span class="comment">/* Extended section indeces */</span></span><br><span class="line">		<span class="number">0x13</span>:<span class="string">"NUM"</span>,<span class="comment">/* Number of defined types */</span></span><br><span class="line">		<span class="number">0x60000000</span>:<span class="string">"LOOS"</span>,<span class="comment">/* Lowest OS-specific section type */</span></span><br><span class="line">		<span class="number">0x6ffffff5</span>:<span class="string">"GNU_ATTRIBUTES"</span>,<span class="comment">/* Object attribuytes */</span></span><br><span class="line">		<span class="number">0x6ffffff6</span>:<span class="string">"GNU_HASH"</span>,<span class="comment">/* GNU-style hash table */</span></span><br><span class="line">		<span class="number">0x6ffffff7</span>:<span class="string">"GNU_LIBLIST"</span>,<span class="comment">/* Prelink library list */</span></span><br><span class="line">		<span class="number">0x6ffffff8</span>:<span class="string">"CHECKSUM"</span>,<span class="comment">/* Checksum for DSO content */</span></span><br><span class="line">		<span class="number">0x6ffffffa</span>:<span class="string">"LOSUNW"</span>,<span class="comment">/* Sun-specific low bound */</span></span><br><span class="line">		<span class="number">0x6ffffffb</span>:<span class="string">"SUNW_COMDAT"</span>,</span><br><span class="line">		<span class="number">0x6ffffffc</span>:<span class="string">"SUNW_syminfo"</span>,</span><br><span class="line">		<span class="number">0x6ffffffd</span>:<span class="string">"GNU_verdef"</span>,<span class="comment">/* Version definition section */</span></span><br><span class="line">		<span class="number">0x6ffffffe</span>:<span class="string">"GNU_verdneed"</span>,<span class="comment">/* Version needs section */</span></span><br><span class="line">		<span class="number">0x6fffffff</span>:<span class="string">"GNY_versym"</span>,<span class="comment">/* Version symbol table */</span></span><br><span class="line">		<span class="number">0x70000000</span>:<span class="string">"LOPROC"</span>,<span class="comment">/* Start of processor-specific section type */</span></span><br><span class="line">		<span class="number">0x7fffffff</span>:<span class="string">"HIPROC"</span>,<span class="comment">/* End of processor-specific section type */</span></span><br><span class="line">		<span class="number">0x80000000</span>:<span class="string">"LOUSER"</span>,<span class="comment">/* Start of application-specific */</span></span><br><span class="line">		<span class="number">0x8fffffff</span>:<span class="string">"HIUSER"</span>,<span class="comment">/* Ennd of application-specific */</span></span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="sh-flags"><a href="#sh-flags" class="headerlink" title="sh_flags"></a>sh_flags</h4><p>同Program Header的p_flags</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ShFlag := <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="number">0x0</span>:<span class="string">""</span>,</span><br><span class="line">		<span class="number">0x1</span>:<span class="string">"W"</span>,</span><br><span class="line">		<span class="number">0x2</span>:<span class="string">"A"</span>,</span><br><span class="line">		<span class="number">0x3</span>:<span class="string">"WA"</span>,</span><br><span class="line">		<span class="number">0x4</span>:<span class="string">""</span>,</span><br><span class="line">		<span class="number">0x5</span>:<span class="string">""</span>,</span><br><span class="line">		<span class="number">0x6</span>:<span class="string">"AX"</span>,</span><br><span class="line">		<span class="number">0x30</span>:<span class="string">"MS"</span>,</span><br><span class="line">		<span class="number">0x42</span>:<span class="string">"AI"</span>,</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="sh-addr"><a href="#sh-addr" class="headerlink" title="sh_addr"></a>sh_addr</h4><p>节区索引地址</p>
<h4 id="sh-offset"><a href="#sh-offset" class="headerlink" title="sh_offset"></a>sh_offset</h4><p>节区相对于文件的偏移地址</p>
<h4 id="sh-size"><a href="#sh-size" class="headerlink" title="sh_size"></a>sh_size</h4><p>节区的大小</p>
<h4 id="sh-link"><a href="#sh-link" class="headerlink" title="sh_link"></a>sh_link</h4><p>此成员给出节区头部表索引链接</p>
<h4 id="sh-info"><a href="#sh-info" class="headerlink" title="sh_info"></a>sh_info</h4><p>此成员给出附加信息</p>
<h4 id="sh-addralign"><a href="#sh-addralign" class="headerlink" title="sh_addralign"></a>sh_addralign</h4><p>某些节区带有地址对齐约束</p>
<h4 id="sh-entsize"><a href="#sh-entsize" class="headerlink" title="sh_entsize"></a>sh_entsize</h4><p>某些节区中包含固定大小的项目,如符号表</p>
<h3 id="读取Section-Header-Table"><a href="#读取Section-Header-Table" class="headerlink" title="读取Section Header Table"></a>读取Section Header Table</h3><p>这里有一个关键点，就是sh_name不是直接的保存的字符数据，而是相对于节区名称表(.shstrtab)的起始地址偏差，所以说得先提取出节区名称表(.shstrtab)的数据才能得到每个节区的名称，来源就是直接ELF Header里的e_shstrndx成员</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Shdr Elf32_Shdr)</span> <span class="title">Findshstrtab</span><span class="params">(Ehdr Elf32_Ehdr,data []<span class="keyword">byte</span>)</span>[]<span class="title">byte</span></span>&#123;</span><br><span class="line">	<span class="comment">//var num int64 = int64(Ehdr.e_shnum)//获取到名称表总数</span></span><br><span class="line">	<span class="comment">//先找到.shstrtab段的数据拿到节区名称表</span></span><br><span class="line">	<span class="keyword">var</span> strtab = <span class="keyword">int64</span>(Ehdr.e_shstrndx)</span><br><span class="line">	shsize := <span class="keyword">int64</span>(Ehdr.e_shentsize)</span><br><span class="line">	<span class="keyword">var</span> t_Index <span class="keyword">int64</span>= <span class="keyword">int64</span>(Ehdr.e_shoff)</span><br><span class="line">	TabStIndex := t_Index + strtab*shsize</span><br><span class="line">	t_data := data[<span class="keyword">int</span>(TabStIndex):<span class="keyword">int</span>(TabStIndex+shsize)]</span><br><span class="line">	<span class="comment">//fmt.Println(t_data)</span></span><br><span class="line">	<span class="comment">//获取节区大小</span></span><br><span class="line">	t_size := t_data[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">	t_size = Change.LSBtoMSB(t_size)</span><br><span class="line">	size := Change.BytesToInt32(t_size)</span><br><span class="line">	<span class="comment">//fmt.Println(int64(size))</span></span><br><span class="line">	<span class="comment">//获取数据偏移地址</span></span><br><span class="line">	t_offset := t_data[<span class="number">16</span>:<span class="number">20</span>]</span><br><span class="line">	t_offset = Change.LSBtoMSB(t_offset)</span><br><span class="line">	offset := Change.BytesToInt32(t_offset)</span><br><span class="line">	<span class="comment">//fmt.Println(Change.DecHex(int64(offset)))</span></span><br><span class="line">	t_data = data[<span class="keyword">int</span>(offset):<span class="keyword">int</span>(offset+size)]</span><br><span class="line">	<span class="keyword">return</span> t_data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Shdr Elf32_Shdr)</span> <span class="title">FindName</span><span class="params">(index <span class="keyword">int32</span>,data []<span class="keyword">byte</span>)</span><span class="title">string</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> t_str <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">for</span>&#123;</span><br><span class="line">		t_str += <span class="keyword">string</span>(data[index])</span><br><span class="line">		index++</span><br><span class="line">		<span class="keyword">if</span>(data[index] == <span class="number">0</span>)&#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t_str</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>解决之后只要接下来按部就班读取就好了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Shdr Elf32_Shdr)</span> <span class="title">Mainread</span><span class="params">(Ehdr Elf32_Ehdr,data []<span class="keyword">byte</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> Shnum <span class="keyword">int64</span> = <span class="keyword">int64</span>(Ehdr.e_shnum) <span class="comment">//获取Section Header Table数量</span></span><br><span class="line">	<span class="keyword">var</span> StartIndex <span class="keyword">int64</span>= <span class="keyword">int64</span>(Ehdr.e_shoff)</span><br><span class="line">	<span class="keyword">for</span> i:=<span class="number">0</span>;i&lt;<span class="keyword">int</span>(Shnum);i++ &#123;</span><br><span class="line">		Shdr.SonRead(i,StartIndex,data,<span class="keyword">int64</span>(Ehdr.e_shentsize),Ehdr)</span><br><span class="line">		fmt.Println()</span><br><span class="line">		StartIndex = StartIndex + <span class="keyword">int64</span>(Ehdr.e_shentsize)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"Key to Flags:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"  W (write), A (alloc), X (execute), M (merge), S (strings)"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"  O (extra OS processing required) o (OS specific), p (processor specific)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Shdr Elf32_Shdr)</span> <span class="title">SonRead</span><span class="params">(i <span class="keyword">int</span>,StartIndex <span class="keyword">int64</span>,data []<span class="keyword">byte</span>,size <span class="keyword">int64</span>,Ehdr Elf32_Ehdr)</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> t_data []<span class="keyword">byte</span> = data[StartIndex:StartIndex+size]</span><br><span class="line">	<span class="keyword">var</span> t_shdr Elf32_Shdr</span><br><span class="line">	<span class="comment">//sh_name Elf32_Word</span></span><br><span class="line">	tmp := t_data[:<span class="number">4</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_name = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_type Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">4</span>:<span class="number">8</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_type = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_flags Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">8</span>:<span class="number">12</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_flags = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_addr Elf32_Addr</span></span><br><span class="line">	tmp = t_data[<span class="number">12</span>:<span class="number">16</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_addr = Elf32_Addr(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_offset Elf32_Off</span></span><br><span class="line">	tmp = t_data[<span class="number">16</span>:<span class="number">20</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_offset = Elf32_Off(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_size Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">20</span>:<span class="number">24</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_size = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_link Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">24</span>:<span class="number">28</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_link = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_info Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">28</span>:<span class="number">32</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_info = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_addralign Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">32</span>:<span class="number">36</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_addralign = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//sh_entsize Elf32_Word</span></span><br><span class="line">	tmp = t_data[<span class="number">36</span>:<span class="number">40</span>]</span><br><span class="line">	tmp = Change.LSBtoMSB(tmp)</span><br><span class="line">	t_shdr.sh_entsize = Elf32_Word(Change.BytesToInt32(tmp))</span><br><span class="line">	<span class="comment">//fmt.Println(t_shdr)</span></span><br><span class="line">	<span class="comment">//[Nr]</span></span><br><span class="line">	fmt.Print(<span class="string">"["</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"%2v"</span>,i)</span><br><span class="line">	fmt.Print(<span class="string">"] "</span>)</span><br><span class="line">	<span class="comment">//Name</span></span><br><span class="line">	<span class="keyword">if</span> t_shdr.sh_name == <span class="number">0</span>&#123;</span><br><span class="line">		t_Str := <span class="string">"0"</span></span><br><span class="line">		fmt.Printf(<span class="string">"%-18s"</span>,t_Str)</span><br><span class="line">	&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">		ShName := Shdr.Findshstrtab(Ehdr,data)</span><br><span class="line">		t_Str := Shdr.FindName(<span class="keyword">int32</span>(t_shdr.sh_name),ShName)</span><br><span class="line">		fmt.Printf(<span class="string">"%-18s"</span>,t_Str)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Type</span></span><br><span class="line">	tmpstr := ShType[<span class="keyword">int</span>(<span class="keyword">int32</span>(t_shdr.sh_type))]</span><br><span class="line">	<span class="keyword">if</span> tmpstr ==<span class="string">""</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-16s"</span>,<span class="string">"Unknown"</span>)</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%-16s"</span>,tmpstr)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//Addr</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_addr))</span><br><span class="line">	fmt.Printf(<span class="string">"%-9s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Off</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_offset))</span><br><span class="line">	fmt.Printf(<span class="string">"%-7s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Size</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_size))</span><br><span class="line">	fmt.Printf(<span class="string">"%-7s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//ES</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_entsize))</span><br><span class="line">	fmt.Printf(<span class="string">"%-3s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Flg</span></span><br><span class="line">	tmpstr = ShFlag[<span class="keyword">int</span>(<span class="keyword">int32</span>(t_shdr.sh_flags))]</span><br><span class="line">	fmt.Printf(<span class="string">"%3s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Lk</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_link))</span><br><span class="line">	fmt.Printf(<span class="string">"%3s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Inf</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_info))</span><br><span class="line">	fmt.Print(<span class="string">" "</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"%3s"</span>,tmpstr)</span><br><span class="line">	<span class="comment">//Al</span></span><br><span class="line">	tmpstr = Change.DecHex(<span class="keyword">int64</span>(t_shdr.sh_addralign))</span><br><span class="line">	fmt.Print(<span class="string">" "</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"%2s"</span>,tmpstr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>负责打印一开始的部分</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Shdr Elf32_Shdr)</span> <span class="title">PHeader</span><span class="params">(Ehdr Elf32_Ehdr)</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">"There are"</span>,Ehdr.e_shnum,</span><br><span class="line">		<span class="string">"section headers, starting at offset"</span>,</span><br><span class="line">		<span class="string">"0x"</span>+</span><br><span class="line">		Change.DecHex(<span class="keyword">int64</span>(Ehdr.e_shoff))+<span class="string">":"</span>,</span><br><span class="line">		)</span><br><span class="line">	fmt.Println()</span><br><span class="line">	fmt.Println(<span class="string">"Section Headers:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"[Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    
        
      

      <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-next post-nav-item">
              
                <a href="/2020/03/17/IDAíóGDBíóDBG│ú╙├▓┘╫≈/" rel="next" title="IDA、GDB、DBG常用操作">
                  <i class="fa fa-chevron-left"></i> IDA、GDB、DBG常用操作
                </a>
              
            </div>

            <span class="post-nav-divider"></span>

            <div class="post-nav-prev post-nav-item">
              
                <a href="/2020/04/18/PWNTOOLS╕÷╚╦╩╓▓ß/" rel="prev" title="PWNTOOLS个人手册">
                  PWNTOOLS个人手册 <i class="fa fa-chevron-right"></i>
                </a>
              
            </div>
          </div>
        
      </footer>
    
  </div>
  
  
  
  </article>

  </div>


          </div>
          

        </div>
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">
        
        
        
        
      

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#目前实现的效果"><span class="nav-number">2.</span> <span class="nav-text">目前实现的效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#readelf的解析数据："><span class="nav-number">2.1.</span> <span class="nav-text">readelf的解析数据：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#概述"><span class="nav-number">3.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ELF-Header"><span class="nav-number">4.</span> <span class="nav-text">ELF Header</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述-1"><span class="nav-number">4.1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#e-ident"><span class="nav-number">4.1.1.</span> <span class="nav-text">e_ident</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-MAG0-EI-MAG3（文件标识）"><span class="nav-number">4.1.1.1.</span> <span class="nav-text">EI_MAG0 - EI_MAG3（文件标识）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-CLASS（文件类）"><span class="nav-number">4.1.1.2.</span> <span class="nav-text">EI_CLASS（文件类）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-DATA（数据编码）"><span class="nav-number">4.1.1.3.</span> <span class="nav-text">EI_DATA（数据编码）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-VERSION-文件版本"><span class="nav-number">4.1.1.4.</span> <span class="nav-text">EI_VERSION(文件版本)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-OSABI-OS类型"><span class="nav-number">4.1.1.5.</span> <span class="nav-text">EI_OSABI(OS类型)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-ABIVERSION"><span class="nav-number">4.1.1.6.</span> <span class="nav-text">EI_ABIVERSION</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-PAD"><span class="nav-number">4.1.1.7.</span> <span class="nav-text">EI_PAD</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#EI-NIDENT"><span class="nav-number">4.1.1.8.</span> <span class="nav-text">EI_NIDENT</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-type"><span class="nav-number">4.1.2.</span> <span class="nav-text">e_type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-machine"><span class="nav-number">4.1.3.</span> <span class="nav-text">e_machine</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-version"><span class="nav-number">4.1.4.</span> <span class="nav-text">e_version</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-entry"><span class="nav-number">4.1.5.</span> <span class="nav-text">e_entry</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-phoff"><span class="nav-number">4.1.6.</span> <span class="nav-text">e_phoff</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-shoff"><span class="nav-number">4.1.7.</span> <span class="nav-text">e_shoff</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-flags"><span class="nav-number">4.1.8.</span> <span class="nav-text">e_flags</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-ehsize"><span class="nav-number">4.1.9.</span> <span class="nav-text">e_ehsize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-phentsize"><span class="nav-number">4.1.10.</span> <span class="nav-text">e_phentsize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-phnum"><span class="nav-number">4.1.11.</span> <span class="nav-text">e_phnum</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-shentsize"><span class="nav-number">4.1.12.</span> <span class="nav-text">e_shentsize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-shnum"><span class="nav-number">4.1.13.</span> <span class="nav-text">e_shnum</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#e-shstrndx"><span class="nav-number">4.1.14.</span> <span class="nav-text">e_shstrndx</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取ELF-Header"><span class="nav-number">4.2.</span> <span class="nav-text">读取ELF Header</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#例子"><span class="nav-number">4.2.1.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码"><span class="nav-number">4.2.2.</span> <span class="nav-text">代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#输出ELF-Header"><span class="nav-number">4.3.</span> <span class="nav-text">输出ELF Header</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Program-Header-Table"><span class="nav-number">5.</span> <span class="nav-text">Program Header Table</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述-2"><span class="nav-number">5.1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#p-type"><span class="nav-number">5.1.1.</span> <span class="nav-text">p_type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-offset"><span class="nav-number">5.1.2.</span> <span class="nav-text">p_offset</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-vaddr"><span class="nav-number">5.1.3.</span> <span class="nav-text">p_vaddr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-paddr"><span class="nav-number">5.1.4.</span> <span class="nav-text">p_paddr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-filesz"><span class="nav-number">5.1.5.</span> <span class="nav-text">p_filesz</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-memsz"><span class="nav-number">5.1.6.</span> <span class="nav-text">p_memsz</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-flage"><span class="nav-number">5.1.7.</span> <span class="nav-text">p_flage</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#p-align"><span class="nav-number">5.1.8.</span> <span class="nav-text">p_align</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取Program-Header-Table"><span class="nav-number">5.2.</span> <span class="nav-text">读取Program Header Table</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Section-Header-Table"><span class="nav-number">6.</span> <span class="nav-text">Section Header Table</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述-3"><span class="nav-number">6.1.</span> <span class="nav-text">概述</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-name"><span class="nav-number">6.1.1.</span> <span class="nav-text">sh_name</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-type"><span class="nav-number">6.1.2.</span> <span class="nav-text">sh_type</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-flags"><span class="nav-number">6.1.3.</span> <span class="nav-text">sh_flags</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-addr"><span class="nav-number">6.1.4.</span> <span class="nav-text">sh_addr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-offset"><span class="nav-number">6.1.5.</span> <span class="nav-text">sh_offset</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-size"><span class="nav-number">6.1.6.</span> <span class="nav-text">sh_size</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-link"><span class="nav-number">6.1.7.</span> <span class="nav-text">sh_link</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-info"><span class="nav-number">6.1.8.</span> <span class="nav-text">sh_info</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-addralign"><span class="nav-number">6.1.9.</span> <span class="nav-text">sh_addralign</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sh-entsize"><span class="nav-number">6.1.10.</span> <span class="nav-text">sh_entsize</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读取Section-Header-Table"><span class="nav-number">6.2.</span> <span class="nav-text">读取Section Header Table</span></a></li></ol></li></ol></div>
        
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ZERO-A-ONE</p>
  <div class="site-description" itemprop="description">Resit much,Obey little</div>
</div>
  <nav class="site-state motion-element">
      <div class="site-state-item site-state-posts">
        
          <a href="/archives/">
        
          <span class="site-state-item-count">71</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
    
      
      
      <div class="site-state-item site-state-categories">
        
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span>
        
      </div>
    
  </nav>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZERO-A-ONE</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.4.0</div>

<div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>

        












        
      </div>
    </footer>
  </div>

  


  <script src="/lib/anime.min.js?v=3.1.0"></script>
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
<script src="/js/utils.js?v=7.4.0"></script><script src="/js/motion.js?v=7.4.0"></script>
<script src="/js/schemes/pisces.js?v=7.4.0"></script>

<script src="/js/next-boot.js?v=7.4.0"></script>



  








  <script src="/js/local-search.js?v=7.4.0"></script>














  

  

  

</body>
</html>
